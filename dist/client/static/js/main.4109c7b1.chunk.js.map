{"version":3,"sources":["basePath.ts","api.ts","auth/UserContext.tsx","common/PopoverMenu.tsx","common/ImageCircle.tsx","utils/helper.ts","ModelPathsContext.tsx","Header/Profile.tsx","common/styles.ts","common/Autocomplete.tsx","common/ResultItem.tsx","utils/orderSearchResults.ts","Header/Search.tsx","Header/index.tsx","common/SplitPane.tsx","common/page.tsx","Empty.tsx","common/Icon.tsx","common/Button.tsx","common/icons.tsx","auth/acl.ts","common/Overlay.tsx","common/ModalDialog.tsx","common/ConflictDialog.tsx","Edit/ActionBar.tsx","Edit/elements/validation.ts","Edit/elements/TextOutput.tsx","Edit/elements/SlugInput.tsx","Edit/elements/TextInput.tsx","Edit/elements/TextAreaInput.tsx","Edit/elements/NumberInput.tsx","common/Quill.tsx","Edit/RichTextLinkModal.tsx","Edit/elements/RichTextInput.tsx","Edit/elements/RichTextOutput.tsx","Edit/elements/inputs.ts","common/ListButton.tsx","Edit/elements/serverSideProps.ts","common/MoreButton.tsx","common/ToggleSwitch.tsx","common/DatePicker.tsx","common/TimeInput.tsx","common/Schedule.tsx","Edit/formHelpers.ts","Edit/elements/lists/block/SortableItem.tsx","Edit/elements/lists/block/SortableList.tsx","Edit/elements/lists/block/Input.tsx","Edit/elements/lists/inline/SortableItem.tsx","Edit/elements/lists/inline/SortableList.tsx","Edit/elements/outputs.ts","Edit/elements/lists/inline/Input.tsx","Edit/elements/lists/Input.tsx","Edit/elements/lists/inline/Output.tsx","Edit/elements/lists/block/Output.tsx","Edit/elements/lists/Output.tsx","common/Fields.tsx","Edit/elements/ObjectOutput.tsx","Edit/elements/ObjectInput.tsx","Edit/elements/UnionInput.tsx","Edit/elements/UnionOutput.tsx","Edit/elements/OptionsInput.tsx","Edit/elements/OptionsOutput.tsx","common/ActionButton.tsx","Edit/elements/MapInput.tsx","Media/createValidator.ts","Media/UploadZone.tsx","Media/useValidation.ts","Media/Image.tsx","Media/Gallery.tsx","Media/Details/FocusPoint.tsx","common/ChipList.tsx","Media/Details/index.tsx","Media/UploadField.tsx","Media/Topbar.tsx","Media/index.tsx","common/ProgressCircle.tsx","utils/formatters.ts","Edit/elements/MediaInput.tsx","Edit/elements/MediaOutput.tsx","Edit/elements/BooleanInput.tsx","Edit/elements/BooleanOutput.tsx","Edit/elements/ReferenceInput.tsx","Edit/elements/ReferenceOutput.tsx","Edit/elements/SingleReferenceInput.tsx","Edit/elements/SingleReferenceOutput.tsx","Edit/elements/DateInput.tsx","Edit/elements/DateOutput.tsx","Edit/elements/ImmutableInput.tsx","utils/middleString.ts","common/ScrollList.tsx","List/Item.tsx","Edit/PositionModal.tsx","Edit/elements/PositionInput.tsx","Edit/elements/index.tsx","Edit/elements/ImmutableOutput.tsx","Edit/History/History.tsx","common/StatusLight.tsx","Edit/VersionList.tsx","Edit/History/HistoryChooser.tsx","Edit/History/index.tsx","Edit/Form.tsx","Edit/History/ReadOnly.tsx","Edit/index.tsx","List/EmptyList.tsx","List/FilterModal.tsx","utils/visit.ts","utils/getAlwaysUniqueFields.ts","utils/extractFilter.ts","List/List.tsx","ErrorBoundary.tsx","List/IFrameView.tsx","List/index.tsx","common/Sidebar.tsx","common/SidebarGroup.tsx","common/SidebarLink.tsx","ModelsSidebar.tsx","ModelsContext.tsx","Models.tsx","auth/Login.tsx","IconGallery.tsx","Dashboard/Header.tsx","Dashboard/Item.tsx","Dashboard/NothingFound.tsx","Dashboard/ItemList.tsx","Dashboard/UnpublishedContent.tsx","Dashboard/UpdatedContent.tsx","Dashboard/index.tsx","common/EditURLRedirect.tsx","App.tsx","index.tsx"],"names":["match","exec","window","location","pathname","Error","basePath","mediaBasePath","replace","ApiError","res","body","statusText","status","prepareMediaId","s","api","baseURI","this","Promise","resolve","contentType","headers","get","test","json","path","opts","query","fetchOpts","qs","stringify","addQueryPrefix","encodeValuesOnly","fetch","credentials","then","getBody","ok","reload","method","JSON","submit","model","listOpts","criteria","type","name","id","rev","data","put","post","del","publish","schedule","meta","UserContext","React","createContext","withUser","Component","props","Consumer","user","Menu","styled","Item","p","active","PopoverMenu","state","isPopoverOpen","close","setState","renderPopover","position","targetRect","popoverRect","arrowColor","arrowSize","renderMenu","align","children","isOpen","content","containerStyle","overflow","zIndex","onClickOutside","transitionDuration","style","display","onClick","colorHash","ColorHash","saturation","lightness","Circle","ImageCircle","src","alt","size","rest","validImageSrc","backgroundColor","hex","String","backgroundImage","fontSize","toString","slice","formatBytes","bytes","decimals","dm","i","Math","floor","log","parseFloat","pow","toFixed","slugify","text","specialChars","à","ä","á","â","æ","å","ë","è","é","ê","î","ï","ì","í","ò","ó","ö","ô","ø","ù","ú","ü","û","ñ","ç","ß","ÿ","œ","ŕ","ś","ń","ṕ","ẃ","ǵ","ǹ","ḿ","ǘ","ẍ","ź","ḧ","_","toLowerCase","trim","target","index","str","noTestID","testable","process","REACT_APP_TEST_ENV","getPreviewUrl","values","modelUrl","split","baseUrl","slug","slugUrl","reduce","obj","key","undefined","matchMime","rule","RegExp","join","ModelPathsContext","withModelPaths","modelPaths","baseUrls","logout","href","cms","picture","email","css","fieldClass","labelClass","errorClass","inputClass","outputClass","buttonClass","Input","input","Field","label","Label","div","Button","button","isActive","isSelected","Root","ListWrapper","ScrollList","ArrowIcon","viewBox","preserveAspectRatio","width","fill","stroke","strokeWidth","transform","d","XIcon","Autocomplete","wasOpen","setInput","node","focus","toggleButton","placeholder","itemToString","renderItem","items","inputElementCss","itemCount","length","getInputProps","getToggleButtonProps","getItemProps","toggleMenu","clearSelection","selectedItem","highlightedIndex","getRootProps","ref","map","item","ImageItem","Container","Link","Wrapper","DescriptionWrapper","TitleWrapper","Description","Title","Kind","ChangedBy","LastChangedBy","author","date","Date","ResultTitle","title","term","firstMatch","search","titleWithHighlight","_escape","substring","dangerouslySetInnerHTML","__html","BasicResultItem","image","kind","includes","background","description","author_name","to","parts","filter","Boolean","link","orderSearchResults","searchTerm","sort","a","b","first","second","Infinity","Search","handleInput","fetchItems","handleChange","stateAndHelpers","q","inputValue","onInputValueChange","onChange","Bar","itemClass","StyledNavLink","NavLink","Items","ItemLink","navigation","settings","permissions","Pane","minWidth","flex","userSelect","pointerEvents","Splitter","SplitPane","primaryLeft","primary","splitterProps","onMouseDown","ev","start","clientX","onTouchStart","touches","rootProps","onMouseMove","move","onTouchMove","onMouseUp","stop","startPos","startWidth","pos","delta","childArray","Children","toArray","flexDirection","memo","push","flexBasis","Background","Page","Center","Cols","Content","Outset","Empty","Icon","xmlns","height","cssStyle","light","StyledButton","StyledLink","icon","asLink","renderMutualContent","paths","OpenInTab","Sort","ArrowRight","ArrowLeft","Filter","FilterRemove","Calendar","CalendarClock","ChevronRight","Clear","ClearCircle","Document","Down","Edit","Plus","BigPlus","Trash","More","DragHandle","Details","Fold","Unfold","Save","Publish","Duplicate","History","Focus","Descending","Settings","Reload","Eye","CrossedEye","SortAlphabetical","icons","Object","entries","forEach","Permission","isAllowed","action","writable","rules","Backdrop","Modal","Close","Overlay","onClose","stopPropagation","overlay","renderOverlay","el","document","getElementById","ReactDOM","createPortal","Body","ActionBar","StyledIcon","ModalDialog","actionButtons","bodyStyle","color","maxWidth","defaultValues","unpublish","delete","media","List","ConflictDialog","edit","baseButtonClass","deactivatedModelAction","deactivatedContentAction","unpublishButtonClass","publishButtonClass","previewButtonClass","modelActionButtons","conflictingRefs","conflictType","onPublish","onPublishChange","activeVersion","catch","err","renderErrors","renderModelActions","isNew","onDuplicate","onDelete","onHistory","versions","canEdit","inSettings","isSingleton","collection","actions","hasVersions","disabled","renderContentActions","isDirty","isSubmitting","hasSchedule","submitForm","onSchedule","onUnpublish","onPreview","canPublish","isPublished","published","alwaysShowSave","external","showSave","showPublish","showSchedule","showPreview","urlPath","find","v","version","withRouter","required","value","TextOutput","dataName","data-name","SlugInput","e","field","form","setFieldValue","alwaysEditable","initialValues","isRequired","TextInput","maxLength","readOnly","minLength","validateRequired","validationRegex","check","regexError","StyledTextarea","Textarea","minRows","maxRows","StyledNumericInput","NumericInput","Number","min","max","step","precision","nonInteractive","interactiveStyles","ReactQuill","Loadable","loader","loading","render","loaded","innerRef","default","Quill","import","header","interactive","editorClass","theme","padding","margin","types","fields","models","allowAbsoluteRefs","mail","subject","tel","phoneNumber","modalDialogStyle","RichTextLinkModal","onSubmit","setSubmitting","setFieldError","onSave","_type","linkFormats","_pick","initial","internalLinkMatch","mediaMatch","mailMatch","more","params","parse","telMatch","validateOnChange","validateOnBlur","enableReinitialize","handleSubmit","RichTextInput","quillRef","open","subStr","setQuillToolTips","that","tooltip","show","getText","linkRange","getFormat","source","editor","ops","getContents","getIn","_set","linkHandler","selection","deleteText","insertText","openLinkModal","val","getSelection","substr","closeLinkModal","formats","modules","defaultValue","getEditor","bounds","toolbar","container","handlers","getDefaultValue","insert","RichTextOutput","compareTo","oldContent","newContent","oldDelta","Delta","newDelta","diff","op","attributes","retain","strike","compose","createDiff","inputs","Symbol","elements","assign","t","PlusIcon","IconWrapper","serverSideProps","ItemAction","MoreButton","onToggle","cursor","buttonStyle","Track","Knob","ToggleSwitch","on","DatePicker","selectedDay","modifiers","dayPickerInput","toISOString","getInput","setMidNight","setUTCHours","MomentLocaleUtils","formatDate","parseDate","classNames","overlayWrapper","onDayChange","format","dayPickerProps","locale","localeUtils","timeInputClass","regexp","TimeInput","lastVal","m","h","hh","mm","hours","minutes","isInteger","isNaN","isValid","modalStyle","maxHeight","Row","Half","toIsoDate","toTime","moment","ScheduleModal","visibleFrom","visibleUntil","visibleFromDate","visibleFromTime","visibleUntilDate","visibleUntilTime","time","toDate","hasActuallyErrors","DragHandleIcon","hasErrorClass","isSorting","now","future","past","hasError","ItemField","ItemActions","SortableHandle","SortableItem","SortableElement","sortIndex","sortable","ItemComponent","itemType","arrayHelpers","renderItemOptions","fieldName","ITEM_VALUE_KEY","error","errors","validate","className","BasicSortableList","SortableContainer","findIndex","SortableList","dragClass","ListInput","lastIndex","remove","mustNotAddItems","createItem","unshift","closeSchedule","comp","fieldProps","_omit","itemFactory","Factory","addLabel","lockToContainerEdges","lockAxis","useDragHandle","helperClass","onSortStart","onSortEnd","oldIndex","newIndex","ClearCircleIcon","removeItem","layout","hasOwnProperty","outputs","NewItemActions","Cancel","ChipListInput","newItemValue","maxId","createFactory","InputComponent","n","isNotAllowedToAddMoreItems","axis","shouldCancelStart","tagName","indexOf","listValues","listNeedsToHaveMoreItems","listNeedsToHaveLessItems","idx","component","borderColor","Output","getSummary","summary","FieldBlock","FieldListBlock","labelColor","LabelBlock","InlineLabel","Cell","LabelCell","Fields","errorHandler","f","element","ObjectOutput","keys","titleCase","FieldComponent","output","Summary","ObjectInput","showModal","toggleModal","prevState","nextState","initalErrros","initalValues","initalErrors","getSummaryImage","getSummaryText","marginRight","setValues","validateField","setTimeout","modalView","alignItems","renderSummary","renderModal","fieldKeys","prefix","l","getHint","TypeLabel","WrapFlexCenter","UnionInput","cb","flexWrap","typeKey","UnionOutput","OptionsInput","options","setOptions","nullLabel","o","prevProps","selected","OptionsOutput","ButtonFace","styles","ActionButton","Action","MapInput","fetched","existingKeys","k","getValue","remainingKeys","getLabel","add","every","thing","Array","prototype","call","noop","UploadZone","onUpload","activeClass","multiple","mediaType","mediaFilter","validator","useState","fileState","setValidatedFiles","useMemo","files","alert","useValidation","allowed","file","mimeType","maxSize","minHeight","all","reader","FileReader","readAsDataURL","onload","Image","result","naturalHeight","naturalWidth","checkedImageSizes","acc","createValidator","onFiles","reset","useDropzone","noKeyboard","noClick","onDrop","isDragActive","useUpload","withCredentials","done","response","progress","useEffect","complete","Tile","Caption","Doc","onSelect","originalname","editable","renderImage","renderIcon","objectFit","ext","Gallery","cache","CellMeasurerCache","defaultHeight","defaultWidth","fixedWidth","masonry","columnCount","cellPositioner","createCellPositioner","cellMeasurerCache","columnWidth","spacer","cellRenderer","parent","disabledMedia","mimetype","CellMeasurer","setMasonryRef","onResize","calculateColumnCount","resetCellPositioner","recomputeCellPositions","renderMasonry","count","onRowsRendered","Masonry","cellCount","autoHeight","outline","overscanByPixels","onCellsRendered","AutoSizer","EditBackground","inEdit","ActionsBar","bottom","EditRoot","TargetWrapper","FocusTarget","MoreIcon","Img","ImageFocus","focusTarget","getDimensions","initialX","initialY","displayWidth","current","clientWidth","displayHeight","clientHeight","ratio","positionX","positionY","onDragStop","x","y","onPosistionChange","onCancel","createRef","addEventListener","removeEventListener","onStop","Form","ChipList","newValue","onAdd","preventDefault","MetaInput","MetaData","Grid","FlexRow","Meta","MetaItemLabel","MetaItemValue","MetaItem","noMargin","marginBottom","onFocusChange","tags","credit","pop","updateMedia","focusX","focusY","fetchMediaItem","onAddTag","tag","onDeleteTag","splice","nameWithoutExt","imagetype","created_at","hasPreview","overflowY","marginLeft","origin","marginTop","FileInput","UploadField","Filters","IconBox","SearchInput","Add","ButtonImport","UploadButton","OrderButton","ascending","Topbar","filters","setFilter","unUsed","setUnUsed","used","setUsed","orderBy","setOrderBy","descending","setDescending","uploadFieldKey","setUploadFieldKey","setFiles","onUploadProgress","onFilterChange","onSearch","orderBys","onOrderByChange","onOrderChange","onUnUsedChange","onUsedChange","DuplicateDialog","Main","StyledUploadZone","FilterTypes","OrderByTypes","Media","total","lastRequestedIndex","details","conflictingItems","duplicates","order","topbarProgress","fetchNextData","fetchData","offset","limit","fileType","listMedia","concat","stopIndex","loadMedia","deleteMedia","curItems","isArray","closeDetails","closeConflict","nextProps","some","renderDuplicatesDialog","isProgress","classes","trail","root","ProgressCircle","percentage","Chooser","Buttons","EmptyTile","MediaImage","withComponent","MediaInput","openGallery","closeGallery","chooseMedia","externalRefDialog","externalRefOpen","closeExternalRefDialog","externalRefVal","closeAndSaveExternalRefDialog","setExternalRef","event","fetchMedia","withExternal","openFromInput","sizeFormat","MediaOutput","BooleanInput","checked","BooleanOutput","borderlessCss","Select","Option","ReferenceInput","internalRef","prevValue","autocomplete","queryString","linkable","isExternal","fetchItem","refObj","onInputTypeChange","currentTarget","prev","paddingLeft","ReferenceOutput","SingleReferenceInput","downshift","SingleReferenceOutput","DateInput","dateJS","DateOutput","ImmutableInput","child","lastDigit","mudder","base62","stringToNumber","prevString","nextString","digits","stringToDigits","increased","newDigits","digit","digitsToString","rowHeight","list","keyMapper","setList","rowRenderer","columnIndex","rowIndex","renderRow","info","visibleRows","rowCount","deferredMeasurementCache","overscanRowCount","extraPadding","renderList","rows","disableHeight","size2","small","StyledItem","ButtonBar","StyledList","PositionModal","startIndex","overscanStopIndex","setPosition","middleString","orderValue","PositionInput","hideModal","postitionString","boolean","object","richtext","select","string","union","number","NumberInput","textarea","TextAreaInput","immutable","virtual","ListOutput","onReceiveData","loadVersion","load","colors","grey","yellow","green","red","StatusLight","Author","Status","Version","dateClass","onSelectVersion","paddingTop","HistoryChooser","latest_rev","historyStyle","HistoryModal","onRestore","NewTag","modal","initForm","clone","history","contentId","initialData","restore","modelPreviewUrl","previewUrl","preview","validateForm","fieldCount","fieldNames","separator","errorElement","querySelector","scrollIntoView","behavior","inline","save","savedId","isUpdate","uniqueErrors","message","singular","dirty","hasErrors","when","historyOpen","formData","renderHistory","itemNotFoundError","record","fetchVersions","onConflict","refs","versioned","getVersions","Text","Heading","EmptyList","FilterModal","operation","onDeleteFilter","filterModel","charAt","toUpperCase","vals","visit","visitor","walk","stringPath","fieldKey","ret","set","getAlwaysUniqueFields","uniqueFields","scalars","extractFilter","setField","forceIndex","FilterBar","InvisibleInput","hasValue","ListWithItems","filterOpen","showFunc","filterValues","searchRef","scope","createFilterCriterita","closeFilter","refresh","openFilter","parseFilterValue","fieldData","toLocaleDateString","namedItem","url","autoComplete","ErrorBoundary","console","Collection","IFrame","iframe","IFrameView","session","setSession","cookie","nameEQ","ca","c","getCookie","frameBorder","listView","singletonData","fetchSingleton","duplicate","getEditProps","routeProps","renderEdit","renderSingletonEdit","Singleton","None","iframeOptions","exact","Sidebar","GroupHeader","level","ChevronRightIcon","expanded","GroupChildren","SidebarGroup","toggleOpen","initialOpen","group","SidebarLink","ModelsSidebar","openGroup","toggleGroup","containsModel","sidebar","renderSidebar","ModelsContext","Models","Provider","Lock","innerWidth","innerHeight","Login","onSuccess","password","touched","handleBlur","onBlur","Figure","IconGallery","aliases","onKeyUp","Header","NothingFound","ItemList","noResultText","setOffset","setItems","canceled","fetchedItems","UnpublishedContent","UpdatedContent","byUser","setByUser","Flex","Column","Dashboard","totalCount","setTotalCount","totalByUser","toLocaleString","createRoute","pathMatch","sensitive","strict","end","findPathInNavigation","found","navigationItem","EditURLRedirect","contentModels","redirect","setRedirect","useAsyncEffect","parsed","foundModels","matcher","deepnesA","deepnesB","fetchQuery","eq","fetchedId","App","fetchInfo","settingsChanged","client","createXhrClient","plural","JavascriptTimeAgo","en"],"mappings":"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","file":"static/js/main.4109c7b1.chunk.js","sourcesContent":["const match = /^.*\\/admin/.exec(window.location.pathname);\nif (!match) throw new Error(\"Path for the admin UI must include /admin\");\n\nconst [basePath] = match;\nexport default basePath;\nexport const mediaBasePath = basePath.replace(\"/admin\", \"\");\n","/* tslint:disable:max-classes-per-file */\n\nimport * as Cotype from \"../../typings\";\nimport basePath from \"./basePath\";\nimport { stringify } from \"qs\";\n\ntype Opts = RequestInit & { query?: object };\n\nclass ApiError extends Error {\n  status: number;\n  body: any;\n  constructor(res: Response, body: any) {\n    super(res.statusText);\n    this.status = res.status;\n    this.body = body;\n  }\n}\n\nfunction prepareMediaId(s: string) {\n  // NOTE: We add a trailing slash to the URL as some caching proxies otherwise\n  // think we are requesting a static image resource and drop the Cookie header.\n  return s + \"/\";\n}\n\nclass Api {\n  baseURI: string;\n\n  constructor(baseURI: string) {\n    this.baseURI = baseURI;\n  }\n\n  getBody(res: Response) {\n    if (res.status === 204) {\n      return Promise.resolve();\n    }\n    const contentType = res.headers.get(\"content-type\");\n    if (contentType && /application\\/json/.test(contentType)) return res.json();\n    return Promise.resolve();\n  }\n\n  fetch(path: string, opts: Opts): Promise<any> {\n    const { query, ...fetchOpts } = opts;\n    const qs = query\n      ? stringify(query, {\n          addQueryPrefix: true,\n          encodeValuesOnly: true\n        })\n      : \"\";\n    return fetch(`${this.baseURI}${path}${qs}`, {\n      credentials: \"include\",\n      ...fetchOpts\n    }).then(res =>\n      this.getBody(res).then(body => {\n        if (res.ok) return body;\n        if (res.status === 403) {\n          if (path !== \"/info\") window.location.reload();\n        }\n        throw new ApiError(res, body);\n      })\n    );\n  }\n\n  get(path: string, query?: object) {\n    return this.fetch(path, { query });\n  }\n\n  del(path: string, opts?: Opts) {\n    return this.fetch(path, { method: \"delete\", ...opts });\n  }\n\n  submit(\n    method: string,\n    path: string,\n    body: object | null = null,\n    opts?: Opts\n  ) {\n    return this.fetch(path, {\n      method,\n      headers: {\n        \"content-type\": \"application/json\"\n      },\n      body: JSON.stringify(body),\n      ...opts\n    });\n  }\n\n  post(path: string, body?: object, opts?: Opts) {\n    return this.submit(\"post\", path, body, opts);\n  }\n\n  put(path: string, body?: object, opts?: Opts) {\n    return this.submit(\"put\", path, body, opts);\n  }\n\n  list(\n    model: Cotype.Model,\n    listOpts: Cotype.ListOpts,\n    criteria: Cotype.Criteria = {}\n  ): Promise<Cotype.ListChunk<Cotype.Item>> {\n    const { type, name } = model;\n    return this.get(`/${type}/${name}`, { ...listOpts, ...criteria });\n  }\n\n  load(model: Cotype.Model, id: string): Promise<Cotype.DataRecord> {\n    const { type, name } = model;\n    return this.get(`/${type}/${name}/${id}`);\n  }\n\n  // TODO rename to loadRevison\n  loadVersion(\n    model: Cotype.Model,\n    id: string,\n    rev: string | number\n  ): Promise<Cotype.Revision> {\n    const { type, name } = model;\n    return this.get(`/${type}/${name}/${id}/versions/${rev}`);\n  }\n\n  getVersions(\n    model: Cotype.Model,\n    id: string\n  ): Promise<(Cotype.VersionItem & { published: boolean })[]> {\n    const { type, name } = model;\n    return this.get(`/${type}/${name}/${id}/versions`);\n  }\n\n  save(\n    model: Cotype.Model,\n    id: string | undefined,\n    data: Cotype.Data\n  ): Promise<Cotype.DataRecord> {\n    const { type, name } = model;\n    if (id) {\n      return this.put(`/${type}/${name}/${id}`, data);\n    }\n    const body: any = { data };\n    return this.post(`/${type}/${name}`, body);\n  }\n\n  delete(model: Cotype.Model, id: string): Promise<void> {\n    const { type, name } = model;\n    return this.del(`/${type}/${name}/${id}`);\n  }\n\n  publish(model: Cotype.Model, id: string, rev: number | null) {\n    return this.post(`/${model.type}/${model.name}/${id}/publish`, {\n      rev\n    });\n  }\n\n  unpublish(model: Cotype.Model, id: string) {\n    return this.publish(model, id, null);\n  }\n\n  schedule(model: Cotype.Model, id: string, schedule: Cotype.Schedule) {\n    return this.post(`/${model.type}/${model.name}/${id}/schedule`, schedule);\n  }\n\n  listMedia(\n    listOpts: Cotype.MediaListOpts\n  ): Promise<Cotype.ListChunk<Cotype.Media>> {\n    return this.get(`/media`, listOpts);\n  }\n\n  loadMedia(id: string): Promise<Cotype.Media> {\n    return this.get(`/media/${prepareMediaId(id)}`);\n  }\n\n  updateMedia(id: string, meta: Cotype.ImageMeta): Promise<void> {\n    return this.post(`/media/${prepareMediaId(id)}`, meta);\n  }\n\n  deleteMedia(id: string): Promise<void> {\n    return this.del(`/media/${prepareMediaId(id)}`);\n  }\n}\n\nconst api = new Api(`${basePath}/rest`);\n\nexport default api;\n","import * as Cotype from \"../../../typings\";\nimport React from \"react\";\nconst UserContext = React.createContext<Cotype.User & Cotype.Principal | null>(\n  null\n);\nexport default UserContext;\n\n/**\n * Typescript:\n * https://stackoverflow.com/questions/50612299/react-typescript-consuming-context-via-hoc\n * https://medium.com/@jrwebdev/react-higher-order-component-patterns-in-typescript-42278f7590fb\n */\ninterface WithUser {\n  user: Cotype.Principal & Cotype.User | null;\n}\n\nexport function withUser<P extends WithUser>(\n  Component: React.ComponentType<P>\n) {\n  // TODO remove `as any` once this issue is resolved:\n  // https://github.com/Microsoft/TypeScript/issues/28938\n  return function ComponentWithUser(\n    props: Pick<P, Exclude<keyof P, keyof WithUser>>\n  ) {\n    return (\n      <UserContext.Consumer>\n        {user => <Component {...props as any} user={user} />}\n      </UserContext.Consumer>\n    );\n  };\n}\n","import React, { Component } from \"react\";\nimport Popover, { Position, Align, ArrowContainer } from \"react-tiny-popover\";\nimport styled from \"styled-components/macro\";\n\nexport const Menu = styled(\"div\")`\n  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.2);\n  background: #fff;\n  border-radius: 3px;\n  padding: 5px 0;\n  max-height: 500px;\n  overflow: scroll;\n`;\n\nexport const Item = styled(\"div\")<{active?:boolean}>`\n  padding: 15px;\n  border-bottom: 1px solid #f0f0f0;\n  :last-child {\n    border-bottom: none;\n  }\n  :hover {\n    background: var(--light-color);\n  }\n  ${p=>p.active&&'background: var(--light-color);'}\n`;\n\ntype PopoverProps = {\n  position: Position;\n  targetRect: ClientRect;\n  popoverRect: ClientRect;\n};\n\ntype Props = {\n  position?: Position;\n  align?: Align;\n  renderMenu: (close: () => void) => any;\n  children: any;\n};\nexport default class PopoverMenu extends Component<Props> {\n  state = {\n    isPopoverOpen: false\n  };\n\n  close = () => {\n    this.setState({ isPopoverOpen: false });\n  };\n\n  renderPopover = ({ position, targetRect, popoverRect }: PopoverProps) => {\n    return (\n      <ArrowContainer\n        position={position}\n        targetRect={targetRect}\n        popoverRect={popoverRect}\n        arrowColor={\"#fff\"}\n        arrowSize={5}\n      >\n        {this.props.renderMenu(this.close)}\n      </ArrowContainer>\n    );\n  };\n\n  render() {\n    const { position = \"bottom\", align = \"start\", children } = this.props;\n    const { isPopoverOpen } = this.state;\n    return (\n      <Popover\n        isOpen={isPopoverOpen}\n        position={position}\n        align={align}\n        content={this.renderPopover}\n        containerStyle={{ overflow: \"visible\", zIndex: \"4\" }}\n        onClickOutside={this.close}\n        transitionDuration={0}\n      >\n        <div\n          style={{ display: \"inline-flex\" }}\n          onClick={() => this.setState({ isPopoverOpen: !isPopoverOpen })}\n        >\n          {children}\n        </div>\n      </Popover>\n    );\n  }\n}\n","import React from \"react\";\nimport styled from \"styled-components/macro\";\n\nimport ColorHash from \"color-hash\";\nconst colorHash = new ColorHash({ saturation: 0.7, lightness: 0.6 });\n\nconst Circle = styled(\"div\")`\n  flex-shrink: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background-color: #f5f5f5;\n  width: 3em;\n  height: 3em;\n  overflow: hidden;\n  border-radius: 100%;\n  background-position: 50%;\n  background-size: cover;\n  margin-right: 0.6em;\n  text-transform: uppercase;\n  font-weight: 700;\n  color: rgba(255, 255, 255, 0.5);\n`;\n\ntype Props = {\n  src: string | null;\n  alt: string | number;\n  size?: number;\n};\nexport default function ImageCircle({\n  src,\n  alt = \"\",\n  size = 24,\n  ...rest\n}: Props) {\n  const validImageSrc = src && /\\.(jpg|jpeg|svg|png)$/i.test(src);\n  return (\n    <Circle\n      {...rest}\n      style={{\n        backgroundColor: validImageSrc\n          ? \"transparent\"\n          : colorHash.hex(String(alt)),\n        backgroundImage: validImageSrc ? `url(${src})` : \"none\",\n        fontSize: size\n      }}\n    >\n      {!validImageSrc && alt.toString().slice(0, 2)}\n    </Circle>\n  );\n}\n","// TODO use existing modules\nexport function formatBytes(bytes: number, decimals?: number) {\n  if (bytes === 0) return \"0 Bytes\";\n  const k = 1024;\n  const dm = decimals || 2;\n  const sizes = [\"Bytes\", \"KB\", \"MB\", \"GB\", \"TB\", \"PB\", \"EB\", \"ZB\", \"YB\"];\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + \" \" + sizes[i];\n}\n\nexport function slugify(text: string) {\n  const specialChars: any = {\n    à: \"a\",\n    ä: \"ae\",\n    á: \"a\",\n    â: \"a\",\n    æ: \"a\",\n    å: \"a\",\n    ë: \"e\",\n    è: \"e\",\n    é: \"e\",\n    ê: \"e\",\n    î: \"i\",\n    ï: \"i\",\n    ì: \"i\",\n    í: \"i\",\n    ò: \"o\",\n    ó: \"o\",\n    ö: \"oe\",\n    ô: \"o\",\n    ø: \"o\",\n    ù: \"o\",\n    ú: \"u\",\n    ü: \"ue\",\n    û: \"u\",\n    ñ: \"n\",\n    ç: \"c\",\n    ß: \"s\",\n    ÿ: \"y\",\n    œ: \"o\",\n    ŕ: \"r\",\n    ś: \"s\",\n    ń: \"n\",\n    ṕ: \"p\",\n    ẃ: \"w\",\n    ǵ: \"g\",\n    ǹ: \"n\",\n    ḿ: \"m\",\n    ǘ: \"u\",\n    ẍ: \"x\",\n    ź: \"z\",\n    ḧ: \"h\",\n    \"·\": \"-\",\n    \"/\": \"-\",\n    _: \"-\",\n    \",\": \"-\",\n    \":\": \"-\",\n    \";\": \"-\"\n  };\n\n  return text\n    .toString()\n    .toLowerCase()\n    .trim()\n    .replace(/\\s+/g, \"-\") // Replace spaces with -\n    .replace(/./g, (target, index, str) => specialChars[target] || target) // Replace special characters using the hash map\n    .replace(/&/g, \"-and-\") // Replace & with 'and'\n    .replace(/[^\\w-]+/g, \"\") // Remove all non-word chars\n    .replace(/--+/g, \"-\"); // Replace multiple - with single -\n}\n\nconst noTestID = {};\n\nexport function testable(id) {\n  if (process.env.NODE_ENV === \"production\" && !process.env.REACT_APP_TEST_ENV) {\n    return noTestID;\n  }\n\n  return {\n    \"data-testid\": id\n  };\n}\n\nexport function getPreviewUrl(values: object, modelUrl: string) {\n  if (!modelUrl) return;\n\n  const [baseUrl, slug] = modelUrl.split(\"/:\");\n  if (!slug) {\n    return baseUrl;\n  }\n\n  const slugPath = slug.split(\".\");\n  // find value from path\n  const slugUrl = slugPath.reduce(\n    (obj, key) => (obj && obj[key] !== \"undefined\" ? obj[key] : undefined),\n    values\n  );\n\n  return `${baseUrl}/${slugUrl}`;\n}\n\nexport const matchMime = (str, rule) =>\n  new RegExp((\"^\" + rule.split(\"*\").join(\".*\") + \"$\").replace(\"+\", \"\\\\+\")).test(\n    str\n  );\n","import * as Cotype from \"../../typings\";\nimport React from \"react\";\nconst ModelPathsContext = React.createContext<{\n  modelPaths: Cotype.ModelPaths | null;\n  baseUrls: Cotype.BaseUrls | null;\n} | null>(null);\nexport default ModelPathsContext;\n\n/**\n * Typescript:\n * https://stackoverflow.com/questions/50612299/react-typescript-consuming-context-via-hoc\n * https://medium.com/@jrwebdev/react-higher-order-component-patterns-in-typescript-42278f7590fb\n */\ninterface WithModelPaths {\n  modelPaths: Cotype.ModelPaths | null;\n  baseUrls: Cotype.BaseUrls | null;\n}\n\nexport function withModelPaths<P extends WithModelPaths>(\n  Component: React.ComponentType<P>\n) {\n  return function ComponentWithModelPaths(\n    props: Pick<P, Exclude<keyof P, keyof WithModelPaths>>\n  ) {\n    // TODO remove `as any` once this issue is resolved:\n    // https://github.com/Microsoft/TypeScript/issues/28938\n    return (\n      <ModelPathsContext.Consumer>\n        {p => (\n          <Component\n            {...props as any}\n            modelPaths={p && p.modelPaths}\n            baseUrls={p && p.baseUrls}\n          />\n        )}\n      </ModelPathsContext.Consumer>\n    );\n  };\n}\n","import { Principal, User, BaseUrls, ModelPaths } from \"../../../typings\";\nimport React, { Component } from \"react\";\nimport PopoverMenu, { Menu, Item } from \"../common/PopoverMenu\";\n\nimport ImageCircle from \"../common/ImageCircle\";\nimport api from \"../api\";\nimport { withUser } from \"../auth/UserContext\";\nimport { testable } from \"../utils/helper\";\nimport { withModelPaths } from \"../ModelPathsContext\";\n\ntype Props = {\n  user: Principal & User | null;\n  modelPaths: ModelPaths;\n  baseUrls: BaseUrls;\n};\nclass Profile extends Component<Props> {\n  logout = () => {\n    api.post(\"/logout\", {}).then(() => {\n      window.location.href = this.props.baseUrls.cms || \"/\";\n    });\n  };\n\n  renderMenu = () => (\n    <Menu>\n      <Item onClick={this.logout}>Logout</Item>\n    </Menu>\n  );\n\n  render() {\n    const { user } = this.props;\n    if (!user) return null;\n    const src = user.picture && `/thumbs/square/${user.picture}`;\n    const alt = user.name || user.email;\n    return (\n      <PopoverMenu renderMenu={this.renderMenu}>\n        <ImageCircle\n          {...testable(\"profile-image\")}\n          src={src}\n          alt={alt}\n          size={14}\n        />\n      </PopoverMenu>\n    );\n  }\n}\n\nexport default withModelPaths(withUser(Profile));\n","import styled, { css, CSSProp } from \"styled-components/macro\";\n\nexport const fieldGroupClass = css`\n  box-sizing: border-box;\n  padding-top: 24px;\n  padding-bottom: 24px;\n  padding-left: 24px;\n`;\n\nexport const fieldClass = css`\n  display: block;\n  margin-bottom: 24px;\n`;\n\nexport const labelClass = css`\n  display: block;\n  color: #848484;\n  margin-bottom: 6px;\n`;\n\nexport const errorClass = css`\n  color: var(--error-color);\n  margin-top: 6px;\n`;\n\nexport const inputClass = css`\n  background: #fff;\n  border-radius: 4px;\n  width: 100%;\n  box-sizing: border-box;\n  font-size: inherit;\n  border: 1px solid rgba(0, 0, 0, 0.16);\n  padding: 10px;\n  outline: none;\n  transition: box-shadow 0.1s ease, width 0.1s ease;\n  min-height: var(--input-min-height);\n  :focus,\n  :active {\n    border-color: var(--accent-color);\n    box-shadow: 0 0 0 3px var(--semi-transparent-accent-color);\n  }\n`;\n\nexport const outputClass = css`\n  width: 100%;\n  box-sizing: border-box;\n  font-size: inherit;\n  outline: none;\n  min-height: var(--input-min-height);\n  background: #fff;\n  padding: 10px;\n  border-radius: 4px;\n`;\n\nexport const buttonClass = css`\n  background: var(--primary-color);\n  font-size: 1.5em;\n  color: #fff;\n  border: none;\n  border-radius: 3px;\n  padding: 0.5em 2em;\n`;\n\ntype Props = {\n  css?: CSSProp;\n};\nexport const Input = styled.input<Props>`\n  ${inputClass}\n`;\nexport const Field = styled.label`\n  ${fieldClass}\n`;\nexport const Label = styled.div`\n  ${labelClass}\n`;\nexport const Error = styled.div`\n  ${errorClass}\n`;\nexport const Button = styled.button`\n  ${buttonClass}\n`;\n","import React, { Component } from \"react\";\nimport styled, { css, CSSProp } from \"styled-components/macro\";\nimport Downshift, { DownshiftProps } from \"downshift\";\nimport { inputClass, Input } from \"./styles\";\n\ntype P = {\n  isActive: boolean;\n  isSelected: boolean;\n};\nconst Item = styled(\"div\")`\n  display: flex;\n  align-items: center;\n  width: 100%;\n  box-sizing: border-box;\n  padding: 10px;\n  ${(p: P) =>\n    p.isActive &&\n    css`\n      color: rgba(0, 0, 0, 0.95);\n      background: var(--light-color);\n    `};\n  ${(p: P) =>\n    p.isSelected &&\n    css`\n      font-weight: 700;\n    `};\n  &:hover {\n    cursor: pointer;\n  }\n`;\n\nconst Root = styled(\"div\")`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0;\n  position: relative;\n  min-height: 42px;\n`;\n\nconst ListWrapper = styled(\"div\")`\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 100%;\n  height: 1px;\n  z-index: 1;\n`;\n\nconst ScrollList = styled(\"div\")`\n  background: #fff;\n  transition: opacity 0.1s ease;\n  border: 1px solid #f0f0f0;\n  border-top-width: 0;\n  box-shadow: 0 12px 12px -12px rgba(0, 0, 0, 0.2);\n  border-radius: 4px;\n  max-height: 250px;\n  overflow: hidden;\n  overflow-y: scroll;\n`;\n\nconst Button = styled(\"button\")`\n  background-color: transparent;\n  border: none;\n  width: 47px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  outline: none;\n`;\n\nfunction ArrowIcon({ isOpen }: { isOpen?: boolean }) {\n  return (\n    <svg\n      viewBox=\"0 0 20 20\"\n      preserveAspectRatio=\"none\"\n      width={16}\n      fill=\"transparent\"\n      stroke=\"#666\"\n      strokeWidth=\"1.1px\"\n      transform={isOpen ? \"rotate(180)\" : undefined}\n    >\n      <path d=\"M1,6 L10,15 L19,6\" />\n    </svg>\n  );\n}\n\nfunction XIcon() {\n  return (\n    <svg\n      viewBox=\"0 0 20 20\"\n      preserveAspectRatio=\"none\"\n      width={12}\n      fill=\"transparent\"\n      stroke=\"#666\"\n      strokeWidth=\"1.1px\"\n    >\n      <path d=\"M1,1 L19,19\" />\n      <path d=\"M19,1 L1,19\" />\n    </svg>\n  );\n}\n\ntype Props = Partial<DownshiftProps<any>> & {\n  toggleButton?: boolean;\n  placeholder?: string;\n  itemToString: (item: any) => string;\n  renderItem: (item: any) => React.ReactNode;\n  items: any[];\n  inputElementCss?: CSSProp;\n  style?: any;\n  name?: string;\n};\nexport default class Autocomplete extends Component<Props> {\n  wasOpen: boolean = false;\n  setInput = (node: any) => {\n    if (node && this.wasOpen) node.focus();\n  };\n\n  render() {\n    const {\n      toggleButton,\n      placeholder,\n      itemToString,\n      renderItem = this.props.itemToString,\n      items = [],\n      inputElementCss = inputClass,\n      style,\n      name,\n      ...rest\n    } = this.props;\n    return (\n      <Downshift itemToString={itemToString} itemCount={items.length} {...rest}>\n        {({\n          getInputProps,\n          getToggleButtonProps,\n          getItemProps,\n          isOpen,\n          toggleMenu,\n          clearSelection,\n          selectedItem,\n          highlightedIndex,\n          getRootProps\n        }) => (\n          <Root style={style} {...getRootProps()}>\n            {selectedItem ? (\n              renderItem(selectedItem)\n            ) : (\n              <Input\n                {...getInputProps()}\n                ref={this.setInput}\n                css={inputElementCss}\n                placeholder={placeholder}\n                name={name}\n                onClick={() => {\n                  if (!isOpen && !selectedItem) toggleMenu();\n                }}\n              />\n            )}\n            {toggleButton &&\n              (selectedItem ? (\n                <Button\n                  type=\"button\"\n                  onClick={() => {\n                    this.wasOpen = true;\n                    clearSelection();\n                  }}\n                >\n                  <XIcon />\n                </Button>\n              ) : (\n                <Button {...getToggleButtonProps()}>\n                  <ArrowIcon isOpen={isOpen} />\n                </Button>\n              ))}\n            {!isOpen || !items.length ? null : (\n              <ListWrapper>\n                <ScrollList>\n                  {items.map((item, index) => (\n                    <Item\n                      key={itemToString(item) + index}\n                      {...getItemProps({\n                        item,\n                        index,\n                        isSelected: selectedItem === items[index]\n                      })}\n                      isActive={highlightedIndex === index}\n                    >\n                      {renderItem(item)}\n                    </Item>\n                  ))}\n                </ScrollList>\n              </ListWrapper>\n            )}\n          </Root>\n        )}\n      </Downshift>\n    );\n  }\n}\n","import * as Cotype from \"../../../typings\";\nimport React from \"react\";\nimport styled from \"styled-components/macro\";\nimport { Link } from \"react-router-dom\";\nimport _escape from \"lodash/escape\";\nimport basePath from \"../basePath\";\nimport ImageCircle from \"../common/ImageCircle\";\nimport TimeAgo from \"react-time-ago\";\nimport ColorHash from \"color-hash\";\nimport { withModelPaths } from \"../ModelPathsContext\";\nconst colorHash = new ColorHash({ saturation: 0.7, lightness: 0.6 });\n\nconst ImageItem = styled(\"div\")`\n  width: 100%;\n  display: flex;\n  align-items: center;\n  color: var(--dark-color);\n  min-width: 0;\n`;\n\nconst Container = styled(Link)`\n  width: 100%;\n  text-decoration: none;\n  color: var(--dark-color);\n  min-width: 0;\n`;\n\nconst Wrapper = styled(\"div\")`\n  min-width: 0;\n  width: 100%;\n`;\nconst DescriptionWrapper = styled(\"div\")`\n  display: flex;\n`;\nconst TitleWrapper = styled(\"div\")`\n  display: flex;\n  justify-content: space-between;\n`;\nconst Description = styled(\"div\")`\n  color: var(--dark-grey);\n  padding-top: 4px;\n  font-size: 0.8rem;\n  min-width: 0;\n`;\nconst Title = styled(\"div\")`\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n`;\n\nconst Kind = styled(\"div\")`\n  border-radius: 3px;\n  color: #fff;\n  font-size: 0.8em;\n  padding: 2px 5px;\n  flex-shrink: 0;\n`;\n\nconst ChangedBy = styled(\"span\")`\n  color: var(--dark-grey);\n  font-size: 0.8em;\n`;\n\nconst LastChangedBy = ({ author, date }: { author: string; date: string }) => (\n  <ChangedBy>\n    Updated by {author} <TimeAgo date={new Date(date)} />\n  </ChangedBy>\n);\n\nexport const ResultTitle = ({\n  title,\n  term\n}: {\n  title: string;\n  term?: string;\n}) => {\n  if (!term) return <Title>{title}</Title>;\n\n  const firstMatch = title.search(new RegExp(term, \"i\"));\n\n  if (firstMatch === -1) return <Title>{title}</Title>;\n\n  let titleWithHighlight = _escape(title).replace(\n    new RegExp(\"(^|)(\" + term + \")(|$)\", \"gi\"),\n    \"$1<b>$2</b>$3\"\n  );\n\n  // cut beginning of string, if match is too far in the end\n  if (firstMatch > 20 && title.length > 50) {\n    titleWithHighlight =\n      \"...\" +\n      titleWithHighlight.substring(\n        firstMatch - (title.length - firstMatch > 25 ? 5 : 25)\n      );\n  }\n\n  return (\n    <Title\n      dangerouslySetInnerHTML={{\n        __html: titleWithHighlight\n      }}\n    />\n  );\n};\n\ntype BasicProps = {\n  item: Cotype.SearchResultItem | Cotype.VersionItem;\n  term?: string;\n};\nexport const BasicResultItem = ({ item, term }: BasicProps) => {\n  const { title, image, kind } = item;\n  const src = image\n    ? image.includes(\"://\")\n      ? image\n      : `/thumbs/square/${image}`\n    : null;\n  return (\n    <ImageItem>\n      <ImageCircle src={src} alt={title} size={12} />\n      <Wrapper>\n        <TitleWrapper>\n          <ResultTitle title={title} term={term}></ResultTitle>\n\n          <Kind style={{ background: colorHash.hex(String(kind)) }}>\n            {kind}\n          </Kind>\n        </TitleWrapper>\n        <DescriptionWrapper>\n          {\"description\" in item && item.description && (\n            <Description>\n              <ResultTitle term={term} title={item.description}></ResultTitle>\n            </Description>\n          )}\n        </DescriptionWrapper>\n        {\"author_name\" in item && \"date\" in item && (\n          <LastChangedBy date={item.date} author={item.author_name} />\n        )}\n      </Wrapper>\n    </ImageItem>\n  );\n};\n\ntype Props = {\n  item: Cotype.SearchResultItem | Cotype.VersionItem;\n  term?: string;\n  modelPaths: Cotype.ModelPaths;\n  baseUrls: Cotype.BaseUrls;\n};\n\nconst link = (...parts: string[]) => basePath + parts.filter(Boolean).join(\"/\");\n\nconst ResultItem = ({ item, modelPaths, term }: Props) => {\n  const { type, model, id } = item;\n  if (!type) return null;\n\n  const path =\n    type === \"settings\"\n      ? `/${type}/${model}`\n      : modelPaths[type] && modelPaths[type][model];\n\n  const to = link(path, \"edit\", id);\n\n  return (\n    <Container to={to}>\n      <BasicResultItem item={item} term={term}></BasicResultItem>\n    </Container>\n  );\n};\n\nexport default withModelPaths(ResultItem);\n","import { SearchResultItem } from \"./../../../typings\";\n\nexport default function orderSearchResults(\n  items: SearchResultItem[],\n  searchTerm: string\n) {\n  return items.sort((a, b) => {\n    const first = a.title.search(new RegExp(searchTerm, \"i\"));\n    const second = b.title.search(new RegExp(searchTerm, \"i\"));\n\n    return (\n      (first === -1 ? Infinity : first) - (second === -1 ? Infinity : second)\n    );\n  });\n}\n","import { SearchResultItem } from \"../../../typings\";\nimport React, { Component } from \"react\";\nimport { css } from \"styled-components/macro\";\nimport api from \"../api\";\nimport Autocomplete from \"../common/Autocomplete\";\nimport ResultItem from \"../common/ResultItem\";\nimport orderSearchResults from \"../utils/orderSearchResults\";\n\nexport const inputClass = css`\n  background: rgba(255, 255, 255, 0.05);\n  border: none;\n  outline: none;\n  margin-left: auto;\n  width: 300px;\n  padding: 0.5em;\n  font-size: 14px;\n  border-radius: 3px;\n  color: #fff;\n  ::placeholder {\n    color: #fff;\n  }\n  :focus {\n    background: rgba(255, 255, 255, 0.1);\n  }\n`;\n\nexport default class Search extends Component {\n  state = {\n    term: \"\",\n    items: []\n  };\n\n  handleInput = (term: string | undefined) => {\n    this.setState({ term });\n    if (term && term.length) {\n      this.fetchItems(term).then(({ items }) =>\n        this.setState({ items: orderSearchResults(items, this.state.term) })\n      );\n    } else {\n      this.setState({ items: [] });\n    }\n  };\n\n  handleChange = (\n    selectedItem: any,\n    stateAndHelpers: { clearSelection: () => void }\n  ) => {\n    this.setState({ term: \"\", items: [] });\n    stateAndHelpers.clearSelection();\n  };\n\n  fetchItems = (q: string) => {\n    return q ? api.get(\"/content\", { q }) : Promise.resolve([]);\n  };\n\n  renderItem = (item: SearchResultItem, term: string) => {\n    return <ResultItem item={item} term={term} />;\n  };\n\n  itemToString = (i: SearchResultItem) => (i ? i.title : \"\");\n\n  render() {\n    const { term, items } = this.state;\n\n    return (\n      <Autocomplete\n        inputElementCss={inputClass}\n        inputValue={term}\n        onInputValueChange={this.handleInput}\n        onChange={this.handleChange}\n        items={items}\n        itemToString={this.itemToString}\n        renderItem={item => this.renderItem(item, this.state.term)}\n        style={{ display: \"flex\", width: 400, zIndex: 3 }}\n        placeholder=\"Search …\"\n      />\n    );\n  }\n}\n","import { Principal, User, NavigationOpts } from \"../../../typings\";\nimport React, { Component } from \"react\";\nimport styled, { css } from \"styled-components/macro\";\nimport { NavLink, NavLinkProps } from \"react-router-dom\";\nimport basePath from \"../basePath\";\nimport { withUser } from \"../auth/UserContext\";\nimport Profile from \"./Profile\";\nimport Search from \"./Search\";\nimport { testable } from \"../utils/helper\";\n\nexport const HEIGHT = \"55px\";\n\nconst Bar = styled(\"div\")`\n  display: flex;\n  background-color: #28292e;\n  color: #fff;\n  height: ${HEIGHT};\n  justify-content: space-between;\n`;\n\nconst itemClass = css`\n  padding: 0 20px;\n  display: flex;\n  height: 100%;\n  white-space: nowrap;\n  align-items: center;\n`;\n\nconst StyledNavLink = styled(NavLink)<NavLinkProps>`\n  ${itemClass} color: inherit;\n  text-decoration: none;\n  opacity: 0.7;\n  transition: opacity 0.2s;\n  :hover {\n    opacity: 1;\n  }\n  &.active {\n    font-weight: bold;\n    opacity: 1;\n  }\n`;\n\nconst Item = styled.div`\n  ${itemClass}\n`;\n\nconst Items = styled(\"div\")`\n  display: flex;\n  align-items: center;\n`;\n\nconst ItemLink = (props: NavLinkProps) => <StyledNavLink {...props} />;\n\ntype Props = {\n  user: Principal & User;\n  navigation: NavigationOpts[];\n};\n\nclass Header extends Component<Props> {\n  render() {\n    const { user, navigation } = this.props;\n    if (!user) return null;\n    const { settings } = user.permissions;\n    return (\n      <Bar>\n        <Items>\n          <ItemLink\n            {...testable(\"main-navigation-item\")}\n            to={`${basePath}/dashboard`}\n          >\n            Dashboard\n          </ItemLink>\n          {navigation.map(({ path, name }) => (\n            <ItemLink\n              {...testable(\"main-navigation-item\")}\n              key={path}\n              to={`${basePath}${path}`}\n            >\n              {name}\n            </ItemLink>\n          ))}\n          <ItemLink\n            {...testable(\"main-navigation-item\")}\n            to={`${basePath}/media`}\n          >\n            Media\n          </ItemLink>\n          {settings && (\n            <ItemLink\n              {...testable(\"main-navigation-item\")}\n              to={`${basePath}/settings`}\n            >\n              Settings\n            </ItemLink>\n          )}\n        </Items>\n        <Items>\n          <Item>\n            <Search />\n          </Item>\n          <Item>\n            <Profile />\n          </Item>\n        </Items>\n      </Bar>\n    );\n  }\n}\n\nexport default withUser(Header);\n","import React, { Component, Children, ReactElement } from \"react\";\nimport styled from \"styled-components/macro\";\n\nconst Root = styled(\"div\")`\n  display: flex;\n  height: 100%;\n  width: 100%;\n  flex: 1;\n`;\n\ntype P = {\n  flex?: boolean;\n  active?: boolean;\n};\n\nconst Pane = styled(\"div\")(\n  { overflow: \"auto\", minWidth: 100 },\n  (p: P) => ({ flex: p.flex ? 1 : 0 }),\n  (p: P) => p.active && { userSelect: \"none\", pointerEvents: \"none\" }\n);\n\nconst Splitter = styled(\"div\")`\n  background: #f0f0f0;\n  opacity: 0.2;\n  box-sizing: border-box;\n  background-clip: padding-box;\n  width: 11px;\n  margin: 0 -5px;\n  cursor: col-resize;\n  transition: all 0.25s;\n  z-index: 3;\n  border-left: 5px solid rgba(255, 255, 255, 0);\n  border-right: 5px solid rgba(255, 255, 255, 0);\n  :hover {\n    border-left: 5px solid rgba(0, 0, 0, 0.5);\n    border-right: 5px solid rgba(0, 0, 0, 0.5);\n  }\n`;\n\ntype Props = {\n  width?: number;\n  children: any;\n  primary?: \"left\" | \"right\";\n};\n\ntype State = {\n  width: number;\n  active?: boolean;\n  startPos?: number;\n  startWidth?: number;\n  primaryLeft?: boolean;\n};\n\nexport default class SplitPane extends Component<Props, State> {\n  state: State = {\n    width: this.props.width || 200,\n    primaryLeft: this.props.primary !== \"right\"\n  };\n\n  splitterProps = {\n    onMouseDown: (ev: any) => {\n      this.start(ev.clientX);\n    },\n    onTouchStart: (ev: any) => {\n      this.start(ev.touches[0].clientX);\n    }\n  };\n\n  rootProps = {\n    onMouseMove: (ev: any) => {\n      this.move(ev.clientX);\n    },\n    onTouchMove: (ev: any) => {\n      this.move(ev.touches[0].clientX);\n    },\n    onMouseUp: (ev: any) => {\n      this.stop();\n    }\n  };\n\n  start = (startPos: number) => {\n    this.setState({\n      active: true,\n      startPos,\n      startWidth: this.state.width\n    });\n  };\n\n  move = (pos: number) => {\n    const { active, startPos = 0, startWidth = 0, primaryLeft } = this.state;\n    if (active) {\n      let delta = pos - startPos;\n      if (!primaryLeft) delta *= -1;\n      const width = startWidth + delta;\n      this.setState({ width });\n    }\n  };\n\n  stop = () => {\n    this.setState({\n      active: false\n    });\n  };\n\n  render() {\n    const childArray = Children.toArray(this.props.children);\n    const { width, active, primaryLeft } = this.state;\n    return (\n      <Root\n        {...this.rootProps}\n        style={!primaryLeft ? { flexDirection: \"row-reverse\" } : undefined}\n      >\n        {childArray.reduce<ReactElement[]>((memo, children, i) => {\n          if (memo.length) {\n            memo.push(<Splitter key={`${i}-split`} {...this.splitterProps} />);\n          }\n\n          memo.push(\n            <Pane\n              {...{\n                key: i,\n                active,\n                style: i < childArray.length - 1 ? { flexBasis: width } : null,\n                flex: i >= childArray.length - 1\n              }}\n              key={i}\n              active={active}\n              style={{ flexBasis: width }}\n            >\n              {children}\n            </Pane>\n          );\n\n          return memo;\n        }, [])}\n      </Root>\n    );\n  }\n}\n","import styled from \"styled-components/macro\";\n\nexport const Background = styled(\"div\")`\n  height: 100%;\n  background: #fff;\n  position: relative;\n  display: flex;\n  flex-direction: column;\n`;\n\nexport const Gradient = styled(\"div\")`\n  height: 100%;\n  background: linear-gradient(90deg, #f5f5f5 50%, #fff);\n`;\n\nexport const Page = styled(\"div\")`\n  box-sizing: border-box;\n  min-height: 100%;\n  padding: 36px;\n  padding-top: 55px;\n  background-color: #f5f5f5;\n  display: flex;\n  flex-direction: column;\n  position: relative;\n`;\n\nexport const Center = styled(\"div\")`\n  margin: auto;\n  text-align: center;\n  max-width: 450px;\n`;\n\nexport const Title = styled(\"div\")`\n  font-weight: 500;\n  font-size: 30px;\n  font-size: 1.875rem;\n  letter-spacing: -0.05em;\n  margin-right: 15px;\n  margin-bottom: 24px;\n  line-height: 1.1;\n`;\n\nexport const Cols = styled(\"div\")`\n  display: flex;\n`;\n\nexport const Content = styled(\"div\")`\n  flex-grow: 1;\n  flex-shrink: 0;\n  flex-basis: 250px;\n  border-radius: 3px;\n  padding: 24px;\n`;\n\nexport const Outset = styled(\"div\")`\n  margin-left: -24px;\n`;\n","import React from \"react\";\nimport { Page, Center } from \"./common/page\";\n\nexport default function Empty() {\n  return (\n    <Page>\n      <Center>\n        <h1>Hello!</h1>\n        <p>\n          Please, select the content you would like to edit in the left sidebar.\n        </p>\n      </Center>\n    </Page>\n  );\n}\n","import React from \"react\";\n\nexport type Props = React.SVGProps<SVGSVGElement> & {\n  path: string;\n  ref?: any;\n};\n\nexport default function Icon({ path, ...props }: Props) {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width=\"24\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      {...props}\n    >\n      <path d={path} fill=\"currentColor\" />\n    </svg>\n  );\n}\n","import React from \"react\";\nimport styled, { css } from \"styled-components/macro\";\nimport Icon from \"./Icon\";\n\ntype P = {\n  light?: boolean;\n};\nconst cssStyle = ({ light }: P) => css`\n  cursor: pointer;\n  display: inline-flex;\n  align-items: center;\n  padding: 0.7em 1em;\n  outline: none;\n  border: none;\n  border-radius: 3px;\n  background: ${light ? \"transparent\" : \"var(--primary-color)\"};\n  color: ${light ? \"var(--accent-color)\" : \"#fff\"};\n  text-transform: uppercase;\n  white-space: nowrap;\n  text-decoration: none;\n  font-weight: 500;\n  font-size: 0.8em;\n  line-height: 1;\n  transition: all 0.3s cubic - bezier(0.55, 0, 0.1, 1);\n  min-height: var(--input-min-height);\n  :hover {\n    background-color: ${light ? \"rgba(0, 0, 0, 0.05)\" : \"var(--accent-color)\"};\n  }\n  & > span:not(:empty) {\n    margin-left: 0.4em;\n  }\n`;\nexport const StyledButton = styled(\"button\")`\n  ${(p: P) => cssStyle(p)}\n`;\nexport const StyledLink = styled(\"a\")`\n  ${(p: P) => cssStyle(p)}\n  padding-top: 0;\n  padding-bottom: 0;\n`;\n\ntype Props = {\n  icon?: string;\n  children?: any;\n  light?: boolean;\n  css?: any;\n} & (\n  | React.ButtonHTMLAttributes<HTMLButtonElement> & { asLink?: false }\n  | React.AnchorHTMLAttributes<HTMLAnchorElement> & { asLink: true });\n\nexport default function Button({\n  icon,\n  children,\n  asLink,\n  css: style,\n  ...props\n}: Props) {\n  const renderMutualContent = (\n    <>\n      {icon && <Icon path={icon} />}\n      {children && <span>{children}</span>}\n    </>\n  );\n\n  return asLink ? (\n    <StyledLink css={style} {...(props as any)}>\n      {renderMutualContent}\n    </StyledLink>\n  ) : (\n    <StyledButton type=\"button\" css={style} {...(props as any)}>\n      {renderMutualContent}\n    </StyledButton>\n  );\n}\n","import React from \"react\";\nimport Icon, { Props as IconProps } from \"./Icon\";\n\nexport const paths = {\n  OpenInTab:\n    \"M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19C3,20.1 3.9,21 5,21H19C20.1,21 21,20.1 21,19V12H19V19Z\",\n  Link:\n    \"M10.59,13.41C11,13.8 11,14.44 10.59,14.83C10.2,15.22 9.56,15.22 9.17,14.83C7.22,12.88 7.22,9.71 9.17,7.76V7.76L12.71,4.22C14.66,2.27 17.83,2.27 19.78,4.22C21.73,6.17 21.73,9.34 19.78,11.29L18.29,12.78C18.3,11.96 18.17,11.14 17.89,10.36L18.36,9.88C19.54,8.71 19.54,6.81 18.36,5.64C17.19,4.46 15.29,4.46 14.12,5.64L10.59,9.17C9.41,10.34 9.41,12.24 10.59,13.41M13.41,9.17C13.8,8.78 14.44,8.78 14.83,9.17C16.78,11.12 16.78,14.29 14.83,16.24V16.24L11.29,19.78C9.34,21.73 6.17,21.73 4.22,19.78C2.27,17.83 2.27,14.66 4.22,12.71L5.71,11.22C5.7,12.04 5.83,12.86 6.11,13.65L5.64,14.12C4.46,15.29 4.46,17.19 5.64,18.36C6.81,19.54 8.71,19.54 9.88,18.36L13.41,14.83C14.59,13.66 14.59,11.76 13.41,10.59C13,10.2 13,9.56 13.41,9.17Z\",\n  Sort:\n    \"M10,13V11H18V13H10M10,19V17H14V19H10M10,7V5H22V7H10M6,17H8.5L5,20.5L1.5,17H4V7H1.5L5,3.5L8.5,7H6V17Z\",\n  ArrowRight:\n    \"M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z\",\n  ArrowLeft:\n    \"M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z\",\n  Filter:\n    \"M15,19.88C15.04,20.18 14.94,20.5 14.71,20.71C14.32,21.1 13.69,21.1 13.3,20.71L9.29,16.7C9.06,16.47 8.96,16.16 9,15.87V10.75L4.21,4.62C3.87,4.19 3.95,3.56 4.38,3.22C4.57,3.08 4.78,3 5,3V3H19V3C19.22,3 19.43,3.08 19.62,3.22C20.05,3.56 20.13,4.19 19.79,4.62L15,10.75V19.88M7.04,5L11,10.06V15.58L13,17.58V10.05L16.96,5H7.04Z\",\n  FilterRemove:\n    \"M14.73,20.83L17.58,18L14.73,15.17L16.15,13.76L19,16.57L21.8,13.76L23.22,15.17L20.41,18L23.22,20.83L21.8,22.24L19,19.4L16.15,22.24L14.73,20.83M13,19.88C13.04,20.18 12.94,20.5 12.71,20.71C12.32,21.1 11.69,21.1 11.3,20.71L7.29,16.7C7.06,16.47 6.96,16.16 7,15.87V10.75L2.21,4.62C1.87,4.19 1.95,3.56 2.38,3.22C2.57,3.08 2.78,3 3,3V3H17V3C17.22,3 17.43,3.08 17.62,3.22C18.05,3.56 18.13,4.19 17.79,4.62L13,10.75V19.88M5.04,5L9,10.06V15.58L11,17.58V10.05L14.96,5H5.04Z\",\n  Calendar:\n    \"M19,19H5V8H19M16,1V3H8V1H6V3H5C3.89,3 3,3.89 3,5V19C3,20.1 3.9,21 5,21H19C20.1,21 21,20.1 21,19V5C21,3.89 20.1,3 19,3H18V1\",\n  CalendarClock:\n    \"M15,13H16.5V15.82L18.94,17.23L18.19,18.53L15,16.69V13M19,8H5V19H9.67C9.24,18.09 9,17.07 9,16C9,12.13 12.13,9 16,9C17.07,9 18.09,9.24 19,9.67V8M5,21C3.89,21 3,20.1 3,19V5C3,3.89 3.89,3 5,3H6V1H8V3H16V1H18V3H19C20.1,3 21,3.9 21,5V11.1C22.24,12.36 23,14.09 23,16C23,19.87 19.87,23 16,23C14.09,23 12.36,22.24 11.1,21H5M16,11.15C13.32,11.15 11.15,13.32 11.15,16C11.15,18.68 13.32,20.85 16,20.85C18.68,20.85 20.85,18.68 20.85,16C20.85,13.32 18.68,11.15 16,11.15Z\",\n  ChevronRight: \"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z\",\n  Clear:\n    \"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\",\n  ClearCircle:\n    \"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z\",\n  Document:\n    \"M6,2A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2H6M6,4H13V9H18V20H6V4M8,12V14H16V12H8M8,16V18H13V16H8Z\",\n  Down: \"M7 10l5 5 5-5z\",\n  Edit:\n    \"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z\",\n  Plus: \"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z\",\n  BigPlus: \"M14 10h7v4h-7v7h-4v-7H3v-4h7V3h4z\",\n  Trash:\n    \"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z\",\n  More:\n    \"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z\",\n  DragHandle: \"M20 9H4v2h16V9zM4 15h16v-2H4v2z\",\n  Details:\n    \"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z\",\n  Fold:\n    \"M7.41 18.59L8.83 20 12 16.83 15.17 20l1.41-1.41L12 14l-4.59 4.59zm9.18-13.18L15.17 4 12 7.17 8.83 4 7.41 5.41 12 10l4.59-4.59z\",\n  Unfold:\n    \"M12 5.83L15.17 9l1.41-1.41L12 3 7.41 7.59 8.83 9 12 5.83zm0 12.34L8.83 15l-1.41 1.41L12 21l4.59-4.59L15.17 15 12 18.17z\",\n  Save:\n    \"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z\",\n  Publish: \"M5 4v2h14V4H5zm0 10h4v6h6v-6h4l-7-7-7 7z\",\n  Duplicate:\n    \"M11,17H4C2.9,17 2,16.1 2,15V3C2,1.9 2.9,1 4,1H16V3H4V15H11V13L15,16L11,19V17M19,21V7H8V13H6V7C6,5.9 6.9,5 8,5H19C20.1,5 21,5.9 21,7V21C21,22.1 20.1,23 19,23H8C6.9,23 6,22.1 6,21V19H8V21H19Z\",\n  History:\n    \"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z\",\n  Focus:\n    \"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm-7 7H3v4c0 1.1.9 2 2 2h4v-2H5v-4zM5 5h4V3H5c-1.1 0-2 .9-2 2v4h2V5zm14-2h-4v2h4v4h2V5c0-1.1-.9-2-2-2zm0 16h-4v2h4c1.1 0 2-.9 2-2v-4h-2v4z\",\n  Search:\n    \"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z\",\n  Descending:\n    \"M10,13V11H18V13H10M10,19V17H14V19H10M10,7V5H22V7H10M6,17H8.5L5,20.5L1.5,17H4V4H6V17Z\",\n  Settings:\n    \"M15.95 10.78c.03-.25.05-.51.05-.78s-.02-.53-.06-.78l1.69-1.32c.15-.12.19-.34.1-.51l-1.6-2.77c-.1-.18-.31-.24-.49-.18l-1.99.8c-.42-.32-.86-.58-1.35-.78L12 2.34c-.03-.2-.2-.34-.4-.34H8.4c-.2 0-.36.14-.39.34l-.3 2.12c-.49.2-.94.47-1.35.78l-1.99-.8c-.18-.07-.39 0-.49.18l-1.6 2.77c-.1.18-.06.39.1.51l1.69 1.32c-.04.25-.07.52-.07.78s.02.53.06.78L2.37 12.1c-.15.12-.19.34-.1.51l1.6 2.77c.1.18.31.24.49.18l1.99-.8c.42.32.86.58 1.35.78l.3 2.12c.04.2.2.34.4.34h3.2c.2 0 .37-.14.39-.34l.3-2.12c.49-.2.94-.47 1.35-.78l1.99.8c.18.07.39 0 .49-.18l1.6-2.77c.1-.18.06-.39-.1-.51l-1.67-1.32zM10 13c-1.65 0-3-1.35-3-3s1.35-3 3-3 3 1.35 3 3-1.35 3-3 3z\",\n  Reload:\n    \"M19 12h3.32l-4.95 4.95L12.42 12h4.55c.03-1.54-.55-3.07-1.73-4.25-2.34-2.34-6.14-2.34-8.48 0-2.34 2.34-2.34 6.15 0 8.49 1.84 1.84 4.6 2.23 6.82 1.17l1.47 1.47C12 20.69 8 20.29 5.34 17.65c-3.12-3.12-3.11-8.18.01-11.3 3.15-3.13 8.18-3.14 11.31-.01C18.22 7.9 19 9.95 19 12z\",\n  Eye:\n    \"M12,9C13.66,9 15,10.34 15,12C15,13.66 13.66,15 12,15C10.34,15 9,13.66 9,12C9,10.34 10.34,9 12,9M12,4.5C17,4.5 21.27,7.61 23,12C21.27,16.39 17,19.5 12,19.5C7,19.5 2.73,16.39 1,12C2.73,7.61 7,4.5 12,4.5M3.18,12C4.83,15.36 8.24,17.5 12,17.5C15.76,17.5 19.17,15.36 20.82,12C19.17,8.64 15.76,6.5 12,6.5C8.24,6.5 4.83,8.64 3.18,12Z\",\n  CrossedEye:\n    \"M2,5.27L3.28,4L20,20.72L18.73,22L15.65,18.92C14.5,19.3 13.28,19.5 12,19.5C7,19.5 2.73,16.39 1,12C1.69,10.24 2.79,8.69 4.19,7.46L2,5.27M12,9C13.66,9 15,10.34 15,12C15,12.35 14.94,12.69 14.83,13L11,9.17C11.31,9.06 11.65,9 12,9M12,4.5C17,4.5 21.27,7.61 23,12C22.18,14.08 20.79,15.88 19,17.19L17.58,15.76C18.94,14.82 20.06,13.54 20.82,12C19.17,8.64 15.76,6.5 12,6.5C10.91,6.5 9.84,6.68 8.84,7L7.3,5.47C8.74,4.85 10.33,4.5 12,4.5M3.18,12C4.83,15.36 8.24,17.5 12,17.5C12.69,17.5 13.37,17.43 14,17.29L11.72,15C10.29,14.85 9.15,13.71 9,12.28L5.6,8.87C4.61,9.72 3.78,10.78 3.18,12Z\",\n  SortAlphabetical:\n    \"M9.25,5L12.5,1.75L15.75,5H9.25M15.75,19L12.5,22.25L9.25,19H15.75M8.89,14.3H6L5.28,17H2.91L6,7H9L12.13,17H9.67L8.89,14.3M6.33,12.68H8.56L7.93,10.56L7.67,9.59L7.42,8.63H7.39L7.17,9.6L6.93,10.58L6.33,12.68M13.05,17V15.74L17.8,8.97V8.91H13.5V7H20.73V8.34L16.09,15V15.08H20.8V17H13.05Z\"\n};\n\ntype Props = Partial<IconProps>;\n\nconst icons: { [index: string]: React.FC<Props> } = {};\n\nObject.entries(paths).forEach(([name, path]) => {\n  icons[name] = (props: Props) => <Icon {...props} path={path} />;\n});\n\nexport default icons;\n","import * as Cotype from \"../../../typings\";\nexport enum Permission {\n  \"forbidden\" = 0,\n  \"view\" = 1,\n  \"edit\" = 2,\n  \"publish\" = 4\n}\n\nexport function isAllowed(\n  user: Cotype.Principal & Cotype.User,\n  model: Cotype.Model,\n  action: Permission\n) {\n  const { permissions } = user;\n\n  if (!model.writable) return false;\n  switch (model.type) {\n    case \"media\":\n      return true;\n    case \"settings\":\n      return permissions.settings;\n    case \"content\":\n      const rules = permissions.content;\n\n      const rule = model.name in rules ? rules[model.name] : rules[\"*\"];\n      if (!rule) return false;\n\n      /* tslint:disable-next-line:no-bitwise */\n      return (rule & action) === action;\n  }\n  return false;\n}\n","import React, { Component } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport styled from \"styled-components/macro\";\nimport Icon from \"../common/icons\";\nimport { testable } from \"../utils/helper\";\nconst Backdrop = styled(\"div\")`\n  position: fixed;\n  display: flex;\n  z-index: 4;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  background: rgba(0, 0, 0, 0.7);\n`;\n\nconst Modal = styled(\"div\")`\n  margin: auto;\n  background: #fff;\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.7);\n  border-radius: 4px;\n  overflow: hidden;\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  max-height: 90vh;\n`;\n\nconst Close = styled(\"div\")`\n  z-index: 1;\n  position: absolute;\n  top: 12px;\n  right: 12px;\n  width: 22px;\n  height: 22px;\n  cursor: pointer;\n  svg {\n    width: 100%;\n    height: 100%;\n  }\n`;\n\ntype Props = {\n  onClose?: () => void;\n  height?: string;\n  width?: string;\n  style?: object;\n  children: React.ReactNode;\n};\n\nexport default class Overlay extends Component<Props> {\n  close = ev => {\n    const { onClose } = this.props;\n    ev.stopPropagation();\n    if (onClose) onClose();\n  };\n\n  renderOverlay() {\n    const { style, children } = this.props;\n    return (\n      <Backdrop {...testable(\"overlay\")}>\n        <Modal onClick={ev => ev.stopPropagation()} style={style}>\n          {children}\n          <Close onClick={this.close}>\n            <Icon.Clear />\n          </Close>\n        </Modal>\n      </Backdrop>\n    );\n  }\n\n  render() {\n    const overlay = this.renderOverlay();\n    const el = document.getElementById(\"modal\");\n    return el ? ReactDOM.createPortal(overlay, el) : overlay;\n  }\n}\n","import React, { Fragment } from \"react\";\nimport styled from \"styled-components/macro\";\nimport Overlay from \"./Overlay\";\nimport Icon from \"./Icon\";\n\nconst Title = styled(\"div\")`\n  color: #fff;\n  background: var(--primary-color);\n  border-radius: 3px 3px 0 0;\n  font-size: 1.5em;\n  padding: 10px 20px;\n  font-weight: 300;\n  z-index: 1;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.16);\n  display: flex;\n  align-items: center;\n`;\n\nconst Body = styled(\"div\")`\n  padding: 20px;\n  color: #34363a;\n  flex: 1;\n  overflow-y: auto;\n  height: 100%;\n  max-height: 100%;\n`;\n\nexport const ActionBar = styled(\"div\")`\n  z-index: 1;\n  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.16);\n  width: 100%;\n  background: #fff;\n  display: flex;\n  flex-direction: row;\n  padding: 0.5em 2em;\n  box-sizing: border-box;\n  & > * {\n    margin-left: 1em;\n  }\n`;\n\nexport const StyledIcon = styled(Icon)`\n  margin-right: 0.5em;\n`;\n\ntype Props = {\n  title: string;\n  children: any;\n  onClose?: () => void;\n  actionButtons?: any;\n  style?: object;\n  bodyStyle?: object;\n  icon?: string;\n};\n\nexport default function ModalDialog({\n  title,\n  children,\n  onClose,\n  actionButtons,\n  style,\n  bodyStyle,\n  icon\n}: Props) {\n  return (\n    <Overlay\n      onClose={onClose}\n      style={{ color: \"#fff\", maxWidth: \"90vw\", ...style }}\n    >\n      <Title>\n        {icon && <StyledIcon path={icon} />}\n        {title}\n      </Title>\n      <Body style={bodyStyle ? bodyStyle : undefined}>{children}</Body>\n      {actionButtons && (\n        <ActionBar>\n          <div style={{ flex: 1 }} />\n          {actionButtons.map((b, index) => (\n            <Fragment key={index}>{b}</Fragment>\n          ))}\n        </ActionBar>\n      )}\n    </Overlay>\n  );\n}\n","import { VersionItem } from \"../../../typings\";\nimport React, { Component } from \"react\";\nimport styled from \"styled-components/macro\";\n\nimport ModalDialog from \"../common/ModalDialog\";\nimport ResultItem from \"../common/ResultItem\";\n\nconst defaultValues = {\n  publish: {\n    title: \"Unpublished references\",\n    description:\n      \"The content you're trying to publish contains references to other unpublished content. Please publish following content: \"\n  },\n  schedule: {\n    title: \"Content in use\",\n    description:\n      \"The content you're trying to schedule is required by other content. Please remove all references to this content from following contents in order to proceed the scheduling: \"\n  },\n  unpublish: {\n    title: \"Content in use\",\n    description:\n      \"The content you're trying to unpublish is referenced to by other content. Please remove all references to this content in following content:\"\n  },\n  delete: {\n    title: \"Content in use\",\n    description:\n      \"The content you're trying to delete is still in use. Please remove or replace references in following content first:\"\n  },\n  media: {\n    title: \"File in user\",\n    description:\n      \"The file you're trying to delete is still in use. Please remove or replace the file in following locations:\"\n  }\n};\nconst List = styled(\"div\")`\n  max-height: 50vw;\n  overflow: scroll;\n  margin-top: 24px;\n`;\nconst Item = styled(\"div\")`\n  display: flex;\n  align-items: center;\n  width: 100%;\n  box-sizing: border-box;\n  padding: 10px;\n  cursor: pointer;\n  border-radius: 3px;\n  :hover {\n    background-color: var(--light-color);\n  }\n`;\n\ntype Props = {\n  onClose: () => void;\n  items: VersionItem[];\n  title?: string;\n  description?: string;\n  type: \"publish\" | \"unpublish\" | \"delete\" | \"media\" | \"schedule\";\n};\n\nexport default class ConflictDialog extends Component<Props> {\n  render() {\n    const { onClose, items, title, description, type } = this.props;\n\n    return (\n      <ModalDialog\n        title={title || (defaultValues[type] && defaultValues[type].title)}\n        onClose={onClose}\n      >\n        <div>\n          {description ||\n            (defaultValues[type] && defaultValues[type].description)}\n        </div>\n        <List>\n          {items.map(item => (\n            <Item key={item.id} onClick={onClose}>\n              <ResultItem item={item} />\n            </Item>\n          ))}\n        </List>\n      </ModalDialog>\n    );\n  }\n}\n","import * as Cotype from \"../../../typings\";\nimport React, { Component, Fragment, version } from \"react\";\nimport { withRouter } from \"react-router-dom\";\nimport { RouteComponentProps } from \"react-router\";\nimport styled, { css } from \"styled-components/macro\";\nimport Button from \"../common/Button\";\nimport { paths } from \"../common/icons\";\nimport { withUser } from \"../auth/UserContext\";\nimport { isAllowed, Permission } from \"../auth/acl\";\n\nimport api from \"../api\";\nimport { conflictTypes } from \".\";\nimport ConflictDialog from \"../common/ConflictDialog\";\nimport { testable } from \"../utils/helper\";\n\nconst { edit, publish } = Permission;\n\nconst baseButtonClass = css`\n  margin-left: 1em;\n`;\n\nconst deactivatedModelAction = css`\n  cursor: auto;\n  & > svg {\n    color: var(--disabled-color);\n  }\n  :hover {\n    & > svg {\n      color: var(--disabled-color);\n    }\n  }\n`;\nconst deactivatedContentAction = css`\n  cursor: auto;\n  background: var(--disabled-color);\n  :hover {\n    background: var(--disabled-color);\n  }\n`;\n\nconst unpublishButtonClass = css`\n  background: #47d08c;\n  & > svg {\n    transform: rotate(180deg);\n  }\n  :hover {\n    background: #52eb9f;\n  }\n  ${baseButtonClass};\n`;\nconst publishButtonClass = css`\n  background: #f9b750;\n  :hover {\n    background: #f9c87b;\n  }\n  ${baseButtonClass};\n`;\n\nconst previewButtonClass = css`\n  background: #4a4a4a;\n  :hover {\n    background: #686868;\n  }\n  ${baseButtonClass};\n`;\n\nconst modelActionButtons = css`\n  background: none;\n  padding-left: 0;\n  & > svg {\n    color: var(--primary-color);\n  }\n  :hover {\n    background: none;\n    & > svg {\n      color: var(--accent-color);\n    }\n  }\n`;\n\nconst Root = styled(\"div\")`\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12);\n  box-sizing: border-box;\n  position: sticky;\n  top: 0;\n  width: 100%;\n  background: #fff;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  z-index: 2;\n  padding: 0.65em 2em 0.65em 1em;\n`;\n\ntype Props = RouteComponentProps<any> & {\n  user: Cotype.Principal & Cotype.User;\n  isNew?: boolean;\n  hasErrors?: boolean;\n  isDirty?: boolean;\n  isSubmitting?: boolean;\n  hasSchedule: boolean;\n  onDuplicate?: (ev?: any) => void;\n  onDelete?: (ev?: any) => void;\n  onPublishChange?: (ev?: any) => void;\n  onUnpublish?: () => void;\n  onRestore?: () => void;\n  onHistory?: () => void;\n  onPreview?: () => void;\n  onSchedule?: () => void;\n  versions?: (Cotype.VersionItem & { published: boolean })[];\n  activeVersion?: number;\n  model: Cotype.Model;\n  submitForm?: () => void;\n  errors?: { key: string };\n};\n\ntype State = {\n  conflictingRefs: Cotype.VersionItem[] | null;\n  conflictType: conflictTypes;\n};\n\nclass ActionBar extends Component<Props, State> {\n  state: State = {\n    conflictingRefs: null,\n    conflictType: \"publish\"\n  };\n  get activeVersion() {\n    const { versions, activeVersion } = this.props;\n    if (versions && activeVersion) {\n      return versions.find(v => v.rev === activeVersion);\n    }\n    if (versions && version.length) {\n      return versions[0];\n    }\n    return undefined;\n  }\n\n  onPublish = () => {\n    const { model, onPublishChange } = this.props;\n    if (this.activeVersion) {\n      api\n        .publish(model, this.activeVersion.id, this.activeVersion.rev)\n        .then(() => {\n          if (onPublishChange) onPublishChange();\n        })\n        .catch(err => {\n          if (err.status === 400) {\n            const { body } = err;\n            if (body.conflictingRefs) {\n              this.setState({\n                conflictingRefs: body.conflictingRefs,\n                conflictType: \"publish\"\n              });\n            }\n          }\n        });\n    }\n  };\n\n  renderErrors = () => {\n    const { conflictingRefs, conflictType } = this.state;\n    if (!conflictingRefs || !conflictType) return null;\n    return (\n      <ConflictDialog\n        onClose={() => this.setState({ conflictingRefs: null })}\n        items={conflictingRefs!}\n        type={conflictType}\n      />\n    );\n  };\n\n  renderModelActions = () => {\n    const {\n      isNew,\n      onDuplicate,\n      onDelete,\n      onHistory,\n      model,\n      user,\n      versions\n    } = this.props;\n\n    const canEdit = isAllowed(user, model, edit);\n    const inSettings = model.type === \"settings\";\n    const isSingleton = model.collection === \"singleton\";\n\n    const actions: any = [];\n\n    const buttonClass = isNew\n      ? css`\n          ${modelActionButtons};\n          ${deactivatedModelAction};\n        `\n      : modelActionButtons;\n\n    if (canEdit) {\n      if (onDelete && !isSingleton) {\n        actions.push(\n          <Button\n            {...testable(\"delete\")}\n            css={buttonClass}\n            icon={paths.Trash}\n            type=\"button\"\n            onClick={!isNew ? onDelete : undefined}\n          />\n        );\n      }\n\n      if (onDuplicate && !inSettings && !isSingleton) {\n        actions.push(\n          <Button\n            css={buttonClass}\n            icon={paths.Duplicate}\n            type=\"button\"\n            onClick={!isNew ? onDuplicate : undefined}\n          />\n        );\n      }\n    }\n    if (!inSettings) {\n      const hasVersions = versions ? versions.length > 1 : false;\n      actions.push(\n        <Button\n          css={\n            hasVersions\n              ? buttonClass\n              : css`\n                  ${modelActionButtons};\n                  ${deactivatedModelAction}\n                `\n          }\n          icon={paths.History}\n          type=\"button\"\n          onClick={onHistory}\n          disabled={!hasVersions}\n        />\n      );\n    }\n\n    return (\n      <div>\n        {actions.map((action, index) => (\n          <Fragment key={index}>{action}</Fragment>\n        ))}\n      </div>\n    );\n  };\n\n  renderContentActions = () => {\n    const {\n      isNew,\n      isDirty,\n      isSubmitting,\n      hasSchedule,\n      model,\n      submitForm,\n      user,\n      onSchedule,\n      onUnpublish,\n      onPreview\n    } = this.props;\n\n    const canEdit = isAllowed(user, model, edit);\n    const canPublish = isAllowed(user, model, publish);\n    const isPublished = this.activeVersion && this.activeVersion.published;\n\n    const inSettings = model.type === \"settings\";\n    const isSingleton = model.collection === \"singleton\";\n\n    const alwaysShowSave = inSettings || model.external || !canPublish;\n    const showSave = canEdit && (isDirty || isNew || alwaysShowSave);\n    const showPublish = canPublish && !showSave;\n    const showSchedule = showPublish && !isSingleton;\n    const showPreview = model.urlPath && !inSettings && onPreview;\n\n    const actions: any = [];\n\n    if (showSchedule) {\n      actions.push(\n        <Button\n          icon={hasSchedule ? paths.CalendarClock : paths.Calendar}\n          type=\"button\"\n          onClick={onSchedule}\n          css={modelActionButtons}\n          disabled={false}\n        />\n      );\n    }\n\n    if (showSave) {\n      const disabled = !isDirty || isSubmitting;\n      actions.push(\n        <Button\n          icon={paths.Save}\n          type=\"button\"\n          onClick={submitForm}\n          css={disabled ? deactivatedContentAction : undefined}\n          disabled={disabled}\n        >\n          Save\n        </Button>\n      );\n    }\n    if (showPublish) {\n      if (!isPublished) {\n        actions.push(\n          <Button\n            css={publishButtonClass}\n            icon={paths.Publish}\n            type=\"button\"\n            onClick={this.onPublish}\n            disabled={false}\n          >\n            Publish\n          </Button>\n        );\n      } else if (!isSingleton) {\n        actions.push(\n          <Button\n            css={unpublishButtonClass}\n            icon={paths.Publish}\n            type=\"button\"\n            onClick={onUnpublish}\n            disabled={false}\n          >\n            Unpublish\n          </Button>\n        );\n      }\n    }\n\n    if (showPreview) {\n      actions.push(\n        <Button\n          css={\n            isDirty || isNew\n              ? css`\n                  ${previewButtonClass};\n                  ${deactivatedModelAction};\n                `\n              : previewButtonClass\n          }\n          disabled={isDirty || isNew}\n          icon={paths.Details}\n          onClick={onPreview}\n        />\n      );\n    }\n\n    return (\n      <div>\n        {actions.map((action, index) => (\n          <Fragment key={index}>{action}</Fragment>\n        ))}\n      </div>\n    );\n  };\n\n  render() {\n    return (\n      <Root>\n        {this.renderErrors()}\n        {this.renderModelActions()}\n        <div style={{ flex: 1 }} />\n        {this.renderContentActions()}\n      </Root>\n    );\n  }\n}\n\nexport default withRouter(withUser(ActionBar));\n","export const required = (\n  value: string | number,\n  { required: isRequired }: { required?: boolean | undefined }\n) => {\n  if (isRequired && !value) {\n    return \"This field is required\";\n  }\n};\n","import React, { Component } from \"react\";\nimport { outputClass } from \"../../common/styles\";\nimport styled from \"styled-components/macro\";\n\nconst Container = styled(\"div\")`\n  ${outputClass}\n`;\ntype Props = {\n  value?: any;\n  \"data-name\"?: string;\n};\n\nexport default class TextOutput extends Component<Props> {\n  static getSummaryText(props: Props) {\n    return <TextOutput {...props} />;\n  }\n\n  render() {\n    // eslint-disable-next-line\n    const { value = \"\", [\"data-name\"]: dataName } = this.props;\n\n    return (\n      // eslint-disable-next-line\n      <Container data-name={dataName}>{value}</Container>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport { FieldProps } from \"formik\";\nimport { slugify } from \"../../utils/helper\";\nimport { Input } from \"../../common/styles\";\nimport { required } from \"./validation\";\nimport TextOutput from \"./TextOutput\";\n\ntype Props = FieldProps<any> & {\n  required?: boolean;\n  id?: string;\n  alwaysEditable?: boolean;\n};\nexport default class SlugInput extends Component<Props> {\n  static getDefaultValue(props: Props) {\n    return \"\";\n  }\n\n  static validate(value: string, props: object) {\n    const isRequired = required(value, props);\n    if (isRequired) return isRequired;\n  }\n\n  handleChange = (e: any) => {\n    const { field, form } = this.props;\n    form.setFieldValue(field.name, slugify(e.target.value));\n  };\n\n  render() {\n    const { field, form, id,alwaysEditable } = this.props;\n    if (\n      form.initialValues[field.name] === undefined ||\n      form.initialValues[field.name] === null ||\n      form.initialValues[field.name] === \"\" ||\n      id === undefined ||\n      alwaysEditable\n    ) {\n      const { value = \"\", ...props } = field;\n      return (\n        <Input value={value || \"\"} {...props} onChange={this.handleChange} />\n      );\n    }\n    return <TextOutput data-name={field.name} value={field.value} />;\n  }\n}\n","import React, { Component } from \"react\";\nimport { FieldProps } from \"formik\";\nimport { required as validateRequired } from \"./validation\";\nimport { Input } from \"../../common/styles\";\n\ntype Props = FieldProps<any> & {\n  required?: boolean;\n  readOnly?: boolean;\n  maxLength?: number;\n  minLength?: number;\n  validationRegex?: string;\n  regexError?: string;\n  placeholder?: string;\n};\nexport default class TextInput extends Component<Props> {\n  static getDefaultValue(props: Props) {\n    return \"\";\n  }\n\n  static getHint(model) {\n    const { maxLength, minLength } = model;\n    if (maxLength || minLength) {\n      return ` (${minLength ? `min. ${minLength}` : \"\"}${\n        minLength && maxLength ? \"/\" : \"\"\n      }${maxLength ? `max. ${maxLength}` : \"\"} Zeichen)`;\n    }\n  }\n\n  static validate(value: any = \"\", props: Props) {\n    const isRequired = validateRequired(value, props);\n    if (isRequired) return isRequired;\n    if (props.minLength && value.length < props.minLength) {\n      return \"Text is too short\";\n    }\n    if (props.maxLength && value.length > props.maxLength) {\n      return \"Text is too long\";\n    }\n    if (props.validationRegex) {\n      const check = value.match(props.validationRegex);\n      if (!check) {\n        return props.regexError ? props.regexError : \"not valid\";\n      }\n    }\n  }\n\n  render() {\n    const { field, maxLength, readOnly, placeholder, minLength } = this.props;\n    const { value, ...props } = field;\n    return (\n      <Input\n        readOnly={readOnly}\n        value={value || \"\"}\n        minLength={minLength}\n        maxLength={maxLength}\n        placeholder={placeholder}\n        {...props}\n      />\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport { FieldProps } from \"formik\";\nimport { inputClass } from \"../../common/styles\";\nimport { required as validateRequired } from \"./validation\";\nimport Textarea from \"react-textarea-autosize\";\nimport styled from \"styled-components/macro\";\n\nconst StyledTextarea = styled(Textarea)`\n  ${inputClass}\n`;\ntype Props = FieldProps<any> & {\n  required?: boolean;\n  readOnly?: boolean;\n  maxLength?: number;\n  minLength?: number;\n  minRows?: number;\n  maxRows?: number;\n};\nexport default class TextInput extends Component<Props> {\n  static getDefaultValue(props: Props) {\n    return \"\";\n  }\n\n  static getHint(model) {\n    const { maxLength, minLength } = model;\n    if (maxLength || minLength) {\n      return ` (${minLength ? `min. ${minLength}` : \"\"}${\n        minLength && maxLength ? \"/\" : \"\"\n      }${maxLength ? `max. ${maxLength}` : \"\"} Zeichen)`;\n    }\n  }\n\n  static validate(value: any = \"\", props: Props) {\n    const isRequired = validateRequired(value, props);\n    if (isRequired) return isRequired;\n    if (props.minLength && value.length < props.minLength) {\n      return \"Text is too short\";\n    }\n    if (props.maxLength && value.length > props.maxLength) {\n      return \"Text is too long\";\n    }\n  }\n\n  render() {\n    const {\n      field,\n      maxLength,\n      minLength,\n      minRows = 4,\n      maxRows,\n      readOnly\n    } = this.props;\n    const { value, ...props } = field;\n    return (\n      <StyledTextarea\n        readOnly={readOnly}\n        minLength={minLength}\n        maxLength={maxLength}\n        maxRows={maxRows}\n        minRows={minRows}\n        value={value || \"\"}\n        {...props}\n      />\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport { FieldProps } from \"formik\";\nimport \"rc-input-number/assets/index.css\";\nimport NumericInput from \"rc-input-number\";\nimport styled from \"styled-components/macro\";\nimport { required } from \"./validation\";\n\nconst StyledNumericInput = styled(NumericInput)`\n  border-radius: 0;\n  border: 1px solid #f0f0f0;\n  font-size: inherit;\n  outline: none;\n  height: 100%;\n  position: relative;\n  :focus,\n  :active {\n    border-color: var(--accent-color);\n    box-shadow: 0 0 0 3px var(--semi-transparent-accent-color);\n  }\n  & .rc-input-number-input-wrap {\n    box-sizing: border-box;\n    transition: box-shadow 0.1s ease, width 0.1s ease;\n    color: var(--dark-color);\n  }\n  & .rc-input-number-handler-wrap {\n    position: absolute;\n    right: 0;\n    top: 0;\n  }\n  & .rc-input-number-input {\n    padding: 10px;\n    font-size: inherit;\n    text-align: left;\n    color: var(--dark-color);\n    line-height: normal;\n    height: unset;\n  }\n  & .rc-input-number-handler {\n    height: 50%;\n    line-height: 16px;\n    background-color: var(--disabled-color);\n  }\n\n  & .rc-input-number-handler-up-inner::after,\n  .rc-input-number-handler-down-inner::after {\n    color: var(--dark-color);\n  }\n`;\n\ntype Props = FieldProps<any> & {\n  min?: number;\n  max?: number;\n  step?: number;\n  precision?: number;\n  placeholder?: string;\n  required?: boolean;\n};\nexport default class Number extends Component<Props> {\n  static getDefaultValue(props: Props) {\n    return undefined;\n  }\n\n  static validate(value: any, props: Props) {\n    const isRequired = required(value, props);\n    if (isRequired) return isRequired;\n  }\n\n  static getHint(model) {\n    const { min, max } = model;\n    if (min || max) {\n      return `( ${min ? `min: ${min} ` : \"\"}\n      ${max ? `max: ${max}` : \"\"})`;\n    }\n  }\n\n  handleChange = (value: number) => {\n    const { field, form } = this.props;\n    form.setFieldValue(field.name, value);\n  };\n\n  render() {\n    const { field, min, max, step, precision, placeholder } = this.props;\n    const { value } = field;\n\n    return (\n      <StyledNumericInput\n        onChange={this.handleChange}\n        value={value}\n        min={min}\n        max={max}\n        step={step ? step : undefined}\n        precision={precision ? precision : 0}\n        placeholder={placeholder ? placeholder : undefined}\n      />\n    );\n  }\n}\n","import React from \"react\";\nimport styled, { css } from \"styled-components/macro\";\nimport Loadable from \"react-loadable\";\n// import \"react-quill/dist/quill.bubble.css\";\nimport \"react-quill/dist/quill.snow.css\";\nimport { outputClass } from \"./styles\";\n\nconst nonInteractive = css`\n  ${outputClass} & .ql-editor {\n    /* padding: 0; */\n  }\n`;\nconst interactiveStyles = css`\n  & {\n    background: #fff;\n    & .ql-editor {\n      min-height: 80px;\n    }\n  }\n`;\n\ntype P = {\n  interactive?: boolean;\n};\nconst editorClass = (p: P) => css`\n  ${p.interactive ? interactiveStyles : nonInteractive}\n  .ql-toolbar {\n    border-radius: 3px 3px 0 0;\n    border-bottom-color: rgba(0, 0, 0, 0.16) !important;\n  }\n  .ql-container {\n    border-radius: 0 0 3px 3px;\n    font-family: inherit;\n  }\n  .ql-toolbar,\n  .ql-container {\n    border-color: rgba(0, 0, 0, 0.16);\n  }\n  .ql-editor ol,\n  .ql-editor ul,\n  .ql-editor pre,\n  .ql-editor blockquote,\n  .ql-editor h1,\n  .ql-editor h2,\n  .ql-editor h3,\n  .ql-editor h4,\n  .ql-editor h5,\n  .ql-editor h6 {\n    margin-bottom: 1em;\n  }\n  .ql-editor sup {\n    vertical-align: super;\n  }\n  .ql-editor sub {\n    vertical-align: sub;\n  }\n  .ql-bubble .ql-tooltip {\n    z-index: 2;\n  }\n  :focus-within {\n    box-shadow: 0 0 0 3px var(--semi-transparent-accent-color);\n    .ql-toolbar,\n    .ql-container {\n      border-color: var(--accent-color);\n    }\n  }\n`;\nconst iconH3 = `\n<svg width=\"17px\" height=\"12px\" viewBox=\"0 0 17 12\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n    <g id=\"Page-1\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n        <g id=\"h3\" fill=\"currentColor\">\n            <path d=\"M1.992,12.728 C1.81066576,12.9093342 1.58966797,13 1.329,13 C1.06833203,13 0.84733424,12.9093342 0.666,12.728 C0.48466576,12.5466658 0.394,12.325668 0.394,12.065 L0.394,1.525 C0.394,1.26433203 0.48466576,1.04333424 0.666,0.862 C0.84733424,0.68066576 1.06833203,0.59 1.329,0.59 C1.58966797,0.59 1.81066576,0.68066576 1.992,0.862 C2.17333424,1.04333424 2.264,1.26433203 2.264,1.525 L2.264,5.503 C2.264,5.60500051 2.31499949,5.656 2.417,5.656 L7.381,5.656 C7.48300051,5.656 7.534,5.60500051 7.534,5.503 L7.534,1.525 C7.534,1.26433203 7.62466576,1.04333424 7.806,0.862 C7.98733424,0.68066576 8.20833203,0.59 8.469,0.59 C8.72966797,0.59 8.95066576,0.68066576 9.132,0.862 C9.31333424,1.04333424 9.404,1.26433203 9.404,1.525 L9.404,12.065 C9.404,12.325668 9.31333424,12.5466658 9.132,12.728 C8.95066576,12.9093342 8.72966797,13 8.469,13 C8.20833203,13 7.98733424,12.9093342 7.806,12.728 C7.62466576,12.5466658 7.534,12.325668 7.534,12.065 L7.534,7.271 C7.534,7.16899949 7.48300051,7.118 7.381,7.118 L2.417,7.118 C2.31499949,7.118 2.264,7.16899949 2.264,7.271 L2.264,12.065 C2.264,12.325668 2.17333424,12.5466658 1.992,12.728 Z M11.32,7.07 C11.1666659,7.07 11.0333339,7.0133339 10.92,6.9 C10.8066661,6.7866661 10.75,6.6533341 10.75,6.5 L10.75,6.27 C10.75,6.1166659 10.8066661,5.9833339 10.92,5.87 C11.0333339,5.7566661 11.1666659,5.7 11.32,5.7 L15.05,5.7 C15.2033341,5.7 15.3366661,5.7566661 15.45,5.87 C15.5633339,5.9833339 15.62,6.1166659 15.62,6.27 L15.62,6.5 C15.62,6.8800019 15.4733348,7.1899988 15.18,7.43 L13.67,8.68 L13.67,8.69 C13.67,8.6966667 13.6733333,8.7 13.68,8.7 L13.8,8.7 C14.3800029,8.7 14.8449983,8.8799982 15.195,9.24 C15.5450018,9.6000018 15.72,10.0866636 15.72,10.7 C15.72,11.4733372 15.4833357,12.0666646 15.01,12.48 C14.5366643,12.8933354 13.8566711,13.1 12.97,13.1 C12.436664,13.1 11.8966694,13.0366673 11.35,12.91 C11.1899992,12.8699998 11.0583339,12.7816674 10.955,12.645 C10.8516662,12.5083327 10.8,12.3533342 10.8,12.18 L10.8,11.84 C10.8,11.706666 10.8549995,11.6016671 10.965,11.525 C11.0750006,11.448333 11.196666,11.4299998 11.33,11.47 C11.9033362,11.6566676 12.4033312,11.75 12.83,11.75 C13.2166686,11.75 13.5166656,11.6600009 13.73,11.48 C13.9433344,11.2999991 14.05,11.0500016 14.05,10.73 C14.05,10.4033317 13.9266679,10.173334 13.68,10.04 C13.4333321,9.906666 12.9733367,9.8366667 12.3,9.83 C12.1466659,9.83 12.0133339,9.77500055 11.9,9.665 C11.7866661,9.55499945 11.73,9.4233341 11.73,9.27 L11.73,9.25 C11.73,8.8766648 11.8733319,8.5666679 12.16,8.32 L13.58,7.09 L13.58,7.08 C13.58,7.0733333 13.5766667,7.07 13.57,7.07 L11.32,7.07 Z\" id=\"Shape\" fill-rule=\"nonzero\"></path>\n        </g>\n    </g>\n</svg>`;\n\nconst iconH4 = `\n<svg width=\"17px\" height=\"12px\" viewBox=\"0 0 17 12\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n    <g id=\"Page-1\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n        <g id=\"h3\" fill=\"currentColor\">\n            <path d=\"M1.992,12.728 C1.81066576,12.9093342 1.58966797,13 1.329,13 C1.06833203,13 0.84733424,12.9093342 0.666,12.728 C0.48466576,12.5466658 0.394,12.325668 0.394,12.065 L0.394,1.525 C0.394,1.26433203 0.48466576,1.04333424 0.666,0.862 C0.84733424,0.68066576 1.06833203,0.59 1.329,0.59 C1.58966797,0.59 1.81066576,0.68066576 1.992,0.862 C2.17333424,1.04333424 2.264,1.26433203 2.264,1.525 L2.264,5.503 C2.264,5.60500051 2.31499949,5.656 2.417,5.656 L7.381,5.656 C7.48300051,5.656 7.534,5.60500051 7.534,5.503 L7.534,1.525 C7.534,1.26433203 7.62466576,1.04333424 7.806,0.862 C7.98733424,0.68066576 8.20833203,0.59 8.469,0.59 C8.72966797,0.59 8.95066576,0.68066576 9.132,0.862 C9.31333424,1.04333424 9.404,1.26433203 9.404,1.525 L9.404,12.065 C9.404,12.325668 9.31333424,12.5466658 9.132,12.728 C8.95066576,12.9093342 8.72966797,13 8.469,13 C8.20833203,13 7.98733424,12.9093342 7.806,12.728 C7.62466576,12.5466658 7.534,12.325668 7.534,12.065 L7.534,7.271 C7.534,7.16899949 7.48300051,7.118 7.381,7.118 L2.417,7.118 C2.31499949,7.118 2.264,7.16899949 2.264,7.271 L2.264,12.065 C2.264,12.325668 2.17333424,12.5466658 1.992,12.728 Z M11.62,10.25 L11.62,10.26 C11.62,10.2666667 11.6233333,10.27 11.63,10.27 L13.28,10.27 C13.3400003,10.27 13.37,10.2433336 13.37,10.19 L13.37,7.77 C13.37,7.7633333 13.3666667,7.76 13.36,7.76 C13.3466666,7.76 13.34,7.7633333 13.34,7.77 L11.62,10.25 Z M10.68,11.6 C10.5266659,11.6 10.3950005,11.5433339 10.285,11.43 C10.1749995,11.3166661 10.12,11.1833341 10.12,11.03 L10.12,10.84 C10.12,10.4666648 10.2299989,10.1233349 10.45,9.81 L13.04,6.16 C13.2600011,5.8533318 13.5566648,5.7 13.93,5.7 L14.43,5.7 C14.5833341,5.7 14.7149994,5.7566661 14.825,5.87 C14.9350006,5.9833339 14.99,6.1166659 14.99,6.27 L14.99,10.19 C14.99,10.2433336 15.0199997,10.27 15.08,10.27 L15.48,10.27 C15.6333341,10.27 15.7666661,10.3266661 15.88,10.44 C15.9933339,10.5533339 16.05,10.6866659 16.05,10.84 L16.05,11.03 C16.05,11.1833341 15.9933339,11.3166661 15.88,11.43 C15.7666661,11.5433339 15.6333341,11.6 15.48,11.6 L15.08,11.6 C15.0199997,11.6 14.99,11.6299997 14.99,11.69 L14.99,12.43 C14.99,12.5833341 14.9350006,12.7166661 14.825,12.83 C14.7149994,12.9433339 14.5833341,13 14.43,13 L13.93,13 C13.7766659,13 13.6450005,12.9433339 13.535,12.83 C13.4249995,12.7166661 13.37,12.5833341 13.37,12.43 L13.37,11.69 C13.37,11.6299997 13.3400003,11.6 13.28,11.6 L10.68,11.6 Z\" id=\"Shape\" fill-rule=\"nonzero\"></path>\n        </g>\n    </g>\n</svg>`;\n\n// Quill is big, load it on demand ...\nconst ReactQuill = styled(\n  Loadable({\n    loader: () => import(\"react-quill\"),\n    loading: () => null,\n    render(loaded: any, { innerRef, ...props }: any) {\n      const Component = loaded.default;\n      const icons = loaded.Quill.import(\"ui/icons\");\n      icons.header[3] = iconH3;\n      icons.header[4] = iconH4;\n      return <Component ref={innerRef} {...props} />;\n    }\n  })\n)<{ interactive: boolean }>`\n  ${p => editorClass({ interactive: p.interactive })}\n`;\n\nexport default function Quill({ ...props }: any) {\n  const interactive = props.theme !== null;\n  return (\n    <ReactQuill\n      interactive={interactive}\n      style={{ padding: 0, margin: 0 }}\n      {...props}\n    />\n  );\n}\n","import React, { Component } from \"react\";\nimport { Formik, FormikActions, FormikProps } from \"formik\";\nimport { Cols, Content } from \"../common/page\";\nimport { Input } from \"./elements\";\nimport Button from \"../common/Button\";\nimport ModalDialog from \"../common/ModalDialog\";\nimport { paths } from \"../common/icons\";\nimport { Fields, RichtextType, UnionTypeTypes } from \"../../../typings\";\nimport { parse } from \"qs\";\nimport _pick from \"lodash/pick\";\n\nexport const errorClass = \"error-field-label\";\n\nconst types = {\n  link: {\n    type: \"object\",\n    label: \"Link\",\n    icon: \"link-variant\",\n    fields: {\n      link: {\n        type: \"content\",\n        models: [],\n        label: \"Link\",\n        allowAbsoluteRefs: true,\n        required: true\n      }\n    }\n  },\n  media: {\n    type: \"object\",\n    label: \"Media\",\n    icon: \"image-outline\",\n    fields: {\n      media: {\n        type: \"media\",\n        label: \"Media\",\n        required: true\n      }\n    }\n  },\n  mail: {\n    type: \"object\",\n    label: \"E-Mail\",\n    icon: \"email-outline\",\n    fields: {\n      email: {\n        type: \"string\",\n        label: \"E-Mail Adresse\",\n        required: true,\n        validationRegex:\n          '^(([^<>()\\\\[\\\\]\\\\\\\\.,;:\\\\s@\"]+(\\\\.[^<>()\\\\[\\\\]\\\\\\\\.,;:\\\\s@\"]+)*)|(\".+\"))@((\\\\[[0-9]{1,3}\\\\.[0-9]{1,3}\\\\.[0-9]{1,3}\\\\.[0-9]{1,3}])|(([a-zA-Z\\\\-0-9]+\\\\.)+[a-zA-Z]{2,}))$',\n        regexError: \"Has to be a valid e-mail address\"\n      },\n      subject: {\n        type: \"string\",\n        label: \"Betreff\"\n      }\n    }\n  },\n  tel: {\n    type: \"object\",\n    label: \"Telefon\",\n    icon: \"phone\",\n    fields: {\n      phoneNumber: {\n        type: \"string\",\n        label: \"Telefonnummer\",\n        required: true,\n        validationRegex: \"^\\\\+?[0-9]{3,}$\",\n        regexError: \"Has to be a valid phone number\"\n      }\n    }\n  }\n};\n\ntype Props = {\n  onSave: (text: string, link: string | false) => void;\n  onClose: () => void;\n  initial: { text: string; link: string };\n  linkFormats: RichtextType[\"linkFormats\"];\n};\n\nconst modalDialogStyle = {\n  width: \"80vw\",\n  background: \"#f5f5f5\",\n  maxWidth: 800\n};\nclass RichTextLinkModal extends Component<Props> {\n  onSubmit = (\n    values: any,\n    { setSubmitting, setFieldError }: FormikActions<any>\n  ) => {\n    if (!values.link || values.link.length === 0) {\n      return this.props.onSave(values.text, false);\n    }\n\n    if (values.link[0].value._type === \"link\" && values.link[0].value.link) {\n      let link = values.link[0].value.link.id;\n      if (values.link[0].value.link.model) {\n        link =\n          \"$intern:\" +\n          values.link[0].value.link.model +\n          \":\" +\n          values.link[0].value.link.id +\n          \"$\";\n      }\n      this.props.onSave(values.text.trim(), link);\n    }\n\n    if (values.link[0].value._type === \"media\" && values.link[0].value.media) {\n      const link = \"$media:\" + values.link[0].value.media + \"$\";\n      this.props.onSave(values.text.trim(), link);\n    }\n    if (values.link[0].value._type === \"mail\" && values.link[0].value.email) {\n      const subject =\n        values.link[0].value.subject && values.link[0].value.subject.length > 0\n          ? values.link[0].value.subject\n          : null;\n      const link =\n        \"mailto:\" +\n        values.link[0].value.email +\n        (subject ? `?subject=${subject}` : \"\");\n      this.props.onSave(values.text.trim(), link);\n    }\n\n    if (\n      values.link[0].value._type === \"tel\" &&\n      values.link[0].value.phoneNumber\n    ) {\n      const link = \"tel:\" + values.link[0].value.phoneNumber;\n      this.props.onSave(values.text.trim(), link);\n    }\n  };\n\n  render() {\n    const { linkFormats = [\"link\", \"mail\", \"media\", \"tel\"] } = this.props;\n    const model: Fields = {\n      link: {\n        label: \"Verlinkung\",\n        type: \"list\",\n        minLength: 0,\n        maxLength: 1,\n        item: {\n          type: \"union\",\n          types: _pick(types, linkFormats) as UnionTypeTypes\n        }\n      },\n      text: {\n        label: \"Text\",\n        type: \"string\"\n      }\n    };\n    const { initial } = this.props;\n    const link: any = initial.link\n      ? {\n          key: 0,\n          value: {\n            _type: \"link\",\n            link: {\n              model: undefined,\n              id: initial.link\n            }\n          }\n        }\n      : {};\n\n    const internalLinkMatch = /\\$intern:([\\w]*):([0-9]*)\\$/gm.exec(\n      initial.link\n    );\n\n    if (internalLinkMatch) {\n      link.value = {\n        _type: \"link\",\n        link: {\n          model: internalLinkMatch[1],\n          id: internalLinkMatch[2]\n        }\n      };\n    }\n    const mediaMatch = /\\$media:([\\w/.]*)\\$/gm.exec(initial.link);\n\n    if (mediaMatch) {\n      link.value = {\n        _type: \"media\",\n        media: mediaMatch[1],\n        link: undefined\n      };\n    }\n    /* eslint-disable-next-line */\n    const mailMatch = /mailto:((([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,})))/gm.exec(\n      initial.link\n    );\n\n    if (mailMatch) {\n      const more = initial.link.split(\"?\");\n      let params: { subject?: string } = {};\n      if (more[1]) {\n        params = parse(more[1]);\n      }\n      link.value = {\n        _type: \"mail\",\n        email: mailMatch[1],\n        subject: params.subject || \"\",\n        link: undefined\n      };\n    }\n\n    const telMatch = /tel:(\\+?[0-9]{3,})/gm.exec(initial.link);\n\n    if (telMatch) {\n      link.value = {\n        _type: \"tel\",\n        phoneNumber: telMatch[1],\n        link: undefined\n      };\n    }\n\n    const initialValues = {\n      text: initial.text,\n      link: link.value ? [link] : []\n    };\n    return (\n      <Formik\n        initialValues={initialValues}\n        validateOnChange={false}\n        validateOnBlur={false}\n        enableReinitialize\n        onSubmit={this.onSubmit}\n        render={(form: FormikProps<any>) => {\n          const { handleSubmit } = form as any;\n\n          const actions = [\n            <Button icon={paths.Save} onClick={handleSubmit}>\n              save\n            </Button>,\n            <Button icon={paths.Clear} onClick={this.props.onClose} light>\n              cancel\n            </Button>\n          ];\n          return (\n            <ModalDialog\n              onClose={this.props.onClose}\n              title=\"set link\"\n              icon={paths.Link}\n              actionButtons={actions}\n              style={modalDialogStyle}\n            >\n              <form onSubmit={handleSubmit}>\n                <Cols>\n                  <Content style={{ padding: 0 }}>\n                    <Input key={\"linkModal\"} fields={model} form={form} />\n                  </Content>\n                </Cols>\n              </form>\n            </ModalDialog>\n          );\n        }}\n      />\n    );\n  }\n}\n\nexport default RichTextLinkModal;\n","import React, { Component } from \"react\";\nimport { FieldProps, getIn } from \"formik\";\nimport Quill from \"../../common/Quill\";\nimport { required } from \"./validation\";\nimport _set from \"lodash/set\";\nimport { RichtextType } from \"../../../../typings\";\nimport RichTextLinkModal from \"../RichTextLinkModal\";\n\ntype Props = FieldProps<any> & RichtextType;\ntype State = {\n  open: boolean;\n  text: string;\n  link: string;\n  subStr: { index: number; length: number };\n};\n\nexport default class RichTextInput extends Component<Props> {\n  static getDefaultValue(props: Props) {\n    return { ops: [] };\n  }\n\n  static validate(v: any, props: Props) {\n    let value = \"\";\n\n    if (typeof v === \"object\") {\n      const { ops } = v;\n      if (ops && ops.length === 0) {\n        value = \"\";\n      } else if (ops && ops.length > 0 && ops[0] && ops[0].insert) {\n        value = ops[0].insert.trim().replace(/↵/g, \"\");\n      }\n    }\n    const isRequired = required(value, props);\n    if (isRequired) return isRequired;\n  }\n  quillRef: any | null = null;\n  state: State = {\n    open: false,\n    text: \"\",\n    link: \"\",\n    subStr: {\n      index: 0,\n      length: 0\n    }\n  };\n  setQuillToolTips = () => {\n    const that = this;\n    this.quillRef.theme.tooltip.show = function() {\n      const value = that.quillRef.getText(\n        this.linkRange.index,\n        this.linkRange.length\n      );\n      const { link } = that.quillRef.getFormat(\n        this.linkRange.index,\n        this.linkRange.length\n      );\n      if (!link) {\n        return;\n      }\n      that.setState({\n        open: true,\n        link,\n        text: value,\n        subStr: { index: this.linkRange.index, length: this.linkRange.length }\n      });\n    };\n  };\n  handleChange = (value, delta, source, editor) => {\n    const { field, form } = this.props;\n    const { ops } = editor.getContents();\n    const initialValue = getIn(form.initialValues, field.name);\n    if (typeof initialValue === \"string\") {\n      _set(form.initialValues, field.name, { ops });\n    }\n    form.setFieldValue(field.name, { ops });\n  };\n\n  get defaultValue() {\n    return RichTextInput.getDefaultValue(this.props);\n  }\n\n  linkHandler = (text, link) => {\n    this.setState({\n      open: false,\n      selection: \"\"\n    });\n    const { index, length } = this.state.subStr;\n    this.quillRef.deleteText(index, length);\n    if (text) {\n      this.quillRef.insertText(index, text, \"link\", link && link);\n    }\n  };\n\n  openLinkModal = val => {\n    if (!this.quillRef) {\n      return;\n    }\n    const { index, length } = this.quillRef.getSelection();\n    const text = this.quillRef.getText();\n    this.setState({\n      open: true,\n      text: text.substr(index, length),\n      link: \"\",\n      subStr: { index, length }\n    });\n  };\n  closeLinkModal = () => this.setState({ open: false });\n\n  render() {\n    const { field, formats, modules, linkFormats } = this.props;\n    const { open, text, link } = this.state;\n    let { value } = field;\n    value = value ? value : this.defaultValue;\n    return (\n      <>\n        {open && (\n          <RichTextLinkModal\n            linkFormats={linkFormats}\n            initial={{ text, link }}\n            onSave={this.linkHandler}\n            onClose={this.closeLinkModal}\n          />\n        )}\n        <Quill\n          key={typeof value === \"string\" ? \"html\" : \"delta\"}\n          innerRef={el => {\n            if (el) {\n              this.quillRef = el.getEditor();\n              this.setQuillToolTips();\n            }\n          }}\n          value={value}\n          bounds=\"#edit-form\"\n          onChange={this.handleChange}\n          theme=\"snow\"\n          formats={formats}\n          modules={{\n            ...(modules || {}),\n            toolbar: {\n              container: (modules && modules.toolbar) || [],\n              handlers: {\n                link: this.openLinkModal\n              }\n            }\n          }}\n        />\n      </>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport Quill from \"../../common/Quill\";\nimport { DeltaOperation } from \"quill\";\nimport Delta from \"quill-delta\";\n\ntype Ops = {\n  ops: DeltaOperation[];\n};\n\nfunction createDiff(oldContent: Ops, newContent: Ops) {\n  const oldDelta = new Delta(oldContent);\n  const newDelta = new Delta(newContent);\n  const diff = oldDelta.diff(newDelta);\n  diff.ops.forEach(op => {\n    // if the change was an insertion\n    if (op.insert) {\n      // color it green\n      op.attributes = {\n        background: \"#cce8cc\",\n        color: \"#003700\"\n      };\n    }\n    // if the change was a deletion\n    else if (op.delete) {\n      // keep the text\n      op.retain = op.delete;\n      delete op.delete;\n      // but color it red and struckthrough\n      op.attributes = {\n        background: \"#e8cccc\",\n        color: \"#370000\",\n        strike: true\n      };\n    }\n    // if attributes were changed\n    else if (op.retain && op.attributes) {\n      op.attributes = {\n        ...op.attributes,\n        background: \"#e8e5cd\"\n      };\n    }\n  });\n  return oldDelta.compose(diff);\n}\n\ntype Props = {\n  value: Ops;\n  compareTo: Ops | undefined;\n};\nexport default class RichTextOutput extends Component<Props> {\n  static getSummaryText(props: Props) {\n    if (!props.value || !props.value.ops || !props.value.ops.length)\n      return null;\n    return <RichTextOutput {...props} />;\n  }\n\n  render() {\n    const { value, compareTo } = this.props;\n    const delta = compareTo ? createDiff(compareTo, value) : value;\n\n    return <Quill value={delta || \"\"} readOnly theme={null} />;\n  }\n}\n","import { Type } from \"../../../../typings\";\nconst inputs: any = {};\n\nconst id = Symbol(\"inputs\");\n\nexport default {\n  id,\n  register(elements: any) {\n    Object.assign(inputs, elements);\n  },\n\n  get(t: Type) {\n    const input = \"input\" in t && t.input;\n    return (input && inputs[input]) || inputs[t.type];\n  }\n};\n","import React from \"react\";\nimport styled from \"styled-components/macro\";\nimport Icon from \"./icons\";\n\nexport const StyledButton = styled(\"button\")`\n  cursor: ${({ disabled }: P) => !disabled && \"pointer\"};\n  display: inline-flex;\n  align-items: center;\n  padding-left: 0;\n  outline: none;\n  border: none;\n  border-radius: 3px;\n  color: ${({ disabled }: P) =>\n    disabled ? \"var(--transparent-grey)\" : \"var(--dark-grey)\"};\n  text-transform: uppercase;\n  white-space: nowrap;\n  font-weight: 500;\n  font-size: 0.8em;\n  transition: all 0.3s cubic-bezier(0.55, 0, 0.1, 1);\n  font-weight: bold;\n  letter-spacing: 0.5px;\n  background: none;\n  :hover {\n    color: ${({ disabled }: P) =>\n      disabled ? \"var(--transparent-grey)\" : \"var(--dark-color)\"};\n    & svg {\n      color: ${({ disabled }: P) => !disabled && \"white\"};\n    }\n  }\n`;\n\nconst PlusIcon = styled(Icon.Plus)`\n  color: white;\n  width: 100%;\n  height: 100%;\n  color: var(--slightly-transparent-white);\n`;\n\ntype P = {\n  disabled: boolean | undefined;\n};\nconst IconWrapper = styled(\"div\")`\n  box-sizing: border-box;\n  background: ${({ disabled }: P) =>\n    disabled ? \"var(--transparent-grey)\" : \"var(--primary-color)\"};\n  padding: 0.7em;\n  border-radius: 4px;\n  margin-right: 0.5em;\n  width: var(--input-min-height);\n  height: var(--input-min-height);\n`;\n\ntype Props = {\n  icon?: string;\n  children: any;\n} & React.ButtonHTMLAttributes<HTMLButtonElement>;\n\nexport default function Button({ icon, children, disabled, ...props }: Props) {\n  return (\n    <StyledButton type=\"button\" {...props} disabled={disabled}>\n      <IconWrapper disabled={disabled}>\n        <PlusIcon />\n      </IconWrapper>\n      {children}\n    </StyledButton>\n  );\n}\n","// Props that should not be passed to the Input components:\nconst serverSideProps = [\"index\", \"model\"];\nexport default serverSideProps;\n","import React, { Component } from \"react\";\nimport styled from \"styled-components/macro\";\nimport Icon from \"../common/icons\";\nimport PopoverMenu, { Menu, Item } from \"./PopoverMenu\";\n\nexport const ItemAction = styled(\"button\")`\n  background: none;\n  outline: none;\n  border: none;\n  margin: 0;\n  padding: 0;\n  padding-top: 7px;\n  transition: all 0.3s cubic-bezier(0.55, 0, 0.1, 1);\n  & svg {\n    color: var(--dark-grey);\n  }\n  :hover {\n    cursor: pointer;\n  }\n`;\n\ntype Action = {\n  label: string;\n  onClick: () => void;\n  active?:boolean\n};\n\ntype Props = {\n  actions: Action[];\n  icon?: React.ReactNode;\n  buttonStyle?: object;\n};\ntype State = {\n  open: boolean;\n};\nexport default class MoreButton extends Component<Props, State> {\n  state = {\n    open: false\n  };\n\n  onToggle = () => {\n    this.setState(state => {\n      return { open: !state.open };\n    });\n  };\n\n  renderMenu = close => {\n    const { actions } = this.props;\n    return (\n      <Menu>\n        {actions.map(a => (\n          <Item\n            style={{ cursor: \"pointer\" }}\n            active={a.active}\n            key={a.label}\n            onClick={() => {\n              if (a.onClick) a.onClick();\n              close();\n            }}\n          >\n            {a.label}\n          </Item>\n        ))}\n      </Menu>\n    );\n  };\n\n  render() {\n    const { icon, buttonStyle } = this.props;\n    return (\n      <PopoverMenu renderMenu={this.renderMenu}>\n        <ItemAction type=\"button\" onClick={this.onToggle} style={buttonStyle}>\n          {icon || <Icon.More />}\n        </ItemAction>\n      </PopoverMenu>\n    );\n  }\n}\n","import React from \"react\";\nimport styled from \"styled-components/macro\";\n\ntype P = {\n  active: boolean;\n  disabled?: boolean;\n};\n\nconst Track = styled(\"div\")`\n  width: 44px;\n  height: 22px;\n  padding: 2px;\n  box-sizing: border-box;\n  border-radius: 11px;\n  cursor: ${(p: P) => (!p.disabled ? \"pointer\" : \"auto\")};\n  display: inline-block;\n  background: ${(p: P) =>\n    p.active\n      ? !p.disabled\n        ? \"var(--primary-color)\"\n        : \"rgba(0, 0, 0, 0.25)\"\n      : \"#ccc\"};\n`;\n\nconst Knob = styled(\"div\")`\n  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.26);\n  width: 18px;\n  height: 18px;\n  border-radius: 50%;\n  background: #fff;\n  transition: all 0.2s ease-in-out;\n  transform: translateX(${(p: P) => (p.active ? \"22px\" : 0)});\n`;\n\ntype Props = {\n  on: boolean;\n  disabled?: boolean;\n  onClick?: () => void;\n};\nconst ToggleSwitch = ({ on, onClick, disabled }: Props) => (\n  <Track active={on} onClick={onClick} disabled={disabled}>\n    <Knob active={on} />\n  </Track>\n);\n\nexport default ToggleSwitch;\n","import React, { Component } from \"react\";\nimport styled from \"styled-components/macro\";\nimport { inputClass } from \"./styles\";\nimport { DayModifiers } from \"react-day-picker\";\nimport DayPickerInput from \"react-day-picker/DayPickerInput\";\nimport \"react-day-picker/lib/style.css\";\nimport \"moment/locale/de\";\nimport MomentLocaleUtils from \"react-day-picker/moment\";\n\nexport const FORMAT = \"L\";\n\nconst Wrapper = styled(\"div\")`\n  .day-picker-container {\n    position: relative;\n    & > div {\n      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);\n      position: absolute;\n      z-index: 2;\n      background: white;\n    }\n    & input {\n      ${inputClass}\n      width: auto;\n      font-feature-settings: \"tnum\";\n      font-variant-numeric: tabular-nums;\n    }\n  }\n`;\n\ntype Props = {\n  value?: string;\n  placeholder?: string;\n  onChange?: (date: string) => void;\n};\n\nexport default class DatePicker extends Component<Props> {\n  format(value: string) {\n    return value\n      ? `${MomentLocaleUtils.formatDate(new Date(value), FORMAT, \"de\")}`\n      : \"\";\n  }\n\n  handleChange = (\n    selectedDay: Date,\n    modifiers: DayModifiers,\n    dayPickerInput: DayPickerInput\n  ) => {\n    const { onChange } = this.props;\n    if (onChange) {\n      const date = selectedDay\n        ? selectedDay.toISOString()\n        : dayPickerInput.getInput().value;\n      const setMidNight = new Date(date);\n      setMidNight.setUTCHours(0, 0, 0, 0);\n      onChange(setMidNight.toISOString());\n    }\n  };\n\n  render() {\n    const { value = \"\", placeholder } = this.props;\n    return (\n      <Wrapper>\n        <DayPickerInput\n          formatDate={MomentLocaleUtils.formatDate}\n          parseDate={MomentLocaleUtils.parseDate}\n          placeholder={placeholder || \"DD.MM.YYYY\"}\n          classNames={{\n            container: \"day-picker-container\",\n            overlay: \"\",\n            overlayWrapper: \"\"\n          }}\n          onDayChange={this.handleChange}\n          format={[FORMAT, \"l\", \"LL\", \"ll\"]}\n          dayPickerProps={{\n            locale: \"de\",\n            localeUtils: MomentLocaleUtils\n          }}\n          value={this.format(value)}\n        />\n      </Wrapper>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport { css } from \"styled-components/macro\";\nimport { Input } from \"./styles\";\n\nconst timeInputClass = css`\n  width: 5em;\n  font-feature-settings: \"tnum\";\n  font-variant-numeric: tabular-nums;\n`;\n\nconst regexp = /^\\d{0,2}?:?\\d{0,2}$/;\n\nconst isValidHour = (h: any) => Number.isInteger(h) && h >= 0 && h < 24;\n\nconst isValidMinutes = (m: any) =>\n  (Number.isInteger(m) && m >= 0 && m < 60) || Number.isNaN(m);\n\ntype Props = {\n  value?: string;\n  placeholder?: string;\n  onChange?: (value: string) => void;\n};\n\ntype State = {\n  value: string;\n};\n\nexport default class TimeInput extends Component<Props, State> {\n  state = {\n    value: this.props.value || \"00:00\"\n  };\n\n  lastVal = \"\";\n\n  isValid(val) {\n    if (!regexp.test(val)) return false;\n\n    const [hh, mm] = val.split(\":\");\n    const hours = Number(hh);\n    const minutes = Number(mm);\n\n    if (!isValidHour(hours) || !isValidMinutes(minutes)) {\n      return false;\n    }\n\n    // first mm digit must be <= 5\n    if (minutes < 10 && Number(mm[0]) > 5) return false;\n\n    return true;\n  }\n\n  onChange(value: string) {\n    if (value === this.state.value) return;\n    if (this.isValid(value)) {\n      if (\n        value.length === 2 &&\n        this.lastVal.length !== 3 &&\n        !value.includes(\":\")\n      ) {\n        value += \":\";\n      }\n\n      if (value.length === 2 && this.lastVal.length === 3) {\n        value = value.slice(0, 1);\n      }\n\n      if (value.length > 5) {\n        return false;\n      }\n\n      this.lastVal = value;\n      this.setState({ value });\n\n      if (value.length === 5) {\n        const { onChange } = this.props;\n        if (onChange) onChange(value);\n      }\n    }\n  }\n\n  render() {\n    return (\n      <Input\n        css={timeInputClass}\n        type=\"tel\"\n        value={this.state.value}\n        placeholder={this.props.placeholder}\n        onChange={e => this.onChange(e.target.value)}\n      />\n    );\n  }\n}\n","import * as Cotype from \"../../../typings\";\nimport React, { Component } from \"react\";\nimport styled from \"styled-components/macro\";\nimport moment from \"moment\";\nimport ModalDialog from \"./ModalDialog\";\nimport Button from \"./Button\";\nimport ToggleSwitch from \"./ToggleSwitch\";\nimport { paths } from \"./icons\";\nimport DatePicker from \"./DatePicker\";\nimport TimeInput from \"./TimeInput\";\nimport ConflictDialog from \"./ConflictDialog\";\n\nconst modalStyle = {\n  width: 750,\n  height: 500,\n  background: \"#f5f5f5\",\n  maxWidth: \"90vw\",\n  maxHeight: \"90hw\"\n};\n\ntype Props = Cotype.Schedule & {\n  schedule: Cotype.Schedule;\n  onClose: () => void;\n  onSchedule: (schedule: Cotype.Schedule) => Promise<void | any>;\n};\n\ntype State = {\n  visibleFrom: boolean;\n  visibleFromDate: string;\n  visibleFromTime: string;\n  visibleUntil: boolean;\n  visibleUntilDate: string;\n  visibleUntilTime: string;\n  conflictingRefs: Cotype.VersionItem[] | null;\n};\n\nconst Row = styled(\"div\")`\n  display: flex;\n  flex-wrap: wrap;\n  margin-bottom: 1em;\n`;\nconst Half = styled(\"div\")`\n  flex: 0 0 50%;\n`;\nconst Label = styled(\"span\")`\n  font-weight: bold;\n  margin-left: 1em;\n`;\n\nconst toIsoDate = (v?: Date | null) => {\n  const d = v ? new Date(v) : new Date();\n  return d.toISOString();\n};\n\nconst toTime = (v?: Date | null) => {\n  if (!v) return \"00:00\";\n  return moment(v).format(\"HH:mm\");\n};\n\nexport default class ScheduleModal extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    const { visibleFrom, visibleUntil } = props.schedule;\n    this.state = {\n      visibleFrom: !!visibleFrom,\n      visibleFromDate: toIsoDate(visibleFrom),\n      visibleFromTime: toTime(visibleFrom),\n      visibleUntil: !!visibleUntil,\n      visibleUntilDate: toIsoDate(visibleUntil),\n      visibleUntilTime: toTime(visibleUntil),\n      conflictingRefs: null\n    };\n  }\n\n  get visibleFrom() {\n    const { visibleFrom, visibleFromDate, visibleFromTime } = this.state;\n    if (!visibleFrom) return null;\n    const [hh, mm] = visibleFromTime.split(\":\").map(Number);\n    return moment(visibleFromDate)\n      .hours(hh)\n      .minutes(mm)\n      .toDate();\n  }\n\n  get visibleUntil() {\n    const { visibleUntil, visibleUntilDate, visibleUntilTime } = this.state;\n    if (!visibleUntil) return null;\n    const [hh, mm] = visibleUntilTime.split(\":\").map(Number);\n    return moment(visibleUntilDate)\n      .hours(hh)\n      .minutes(mm)\n      .toDate();\n  }\n\n  onSchedule = () => {\n    const { visibleFrom, visibleUntil } = this;\n\n    this.props\n      .onSchedule({\n        visibleFrom,\n        visibleUntil\n      })\n      .catch(err => {\n        const { body } = err;\n        this.setState({\n          conflictingRefs: body.conflictingRefs\n        });\n      });\n  };\n  renderErrors = () => {\n    const { conflictingRefs } = this.state;\n    if (!conflictingRefs) return null;\n    return (\n      <ConflictDialog\n        onClose={() => this.setState({ conflictingRefs: null })}\n        items={conflictingRefs!}\n        type=\"schedule\"\n      />\n    );\n  };\n\n  render() {\n    const { onClose } = this.props;\n    const {\n      visibleFrom,\n      visibleFromDate,\n      visibleFromTime,\n      visibleUntil,\n      visibleUntilDate,\n      visibleUntilTime\n    } = this.state;\n    const actionButtons = [\n      <Button icon={paths.History} onClick={this.onSchedule}>\n        Schedule\n      </Button>\n    ];\n\n    return (\n      <ModalDialog\n        title={\"Schedule\"}\n        icon={paths.Calendar}\n        onClose={onClose}\n        style={modalStyle}\n        actionButtons={actionButtons}\n      >\n        {this.renderErrors()}\n        <Row>\n          <Half>\n            <Row>\n              <ToggleSwitch\n                on={visibleFrom}\n                onClick={() => this.setState({ visibleFrom: !visibleFrom })}\n              />\n              <Label>Visible From</Label>\n            </Row>\n            {visibleFrom && (\n              <Row>\n                <DatePicker\n                  value={visibleFromDate}\n                  onChange={date => this.setState({ visibleFromDate: date })}\n                />\n                <TimeInput\n                  value={visibleFromTime}\n                  placeholder=\"hh:mm\"\n                  onChange={time => this.setState({ visibleFromTime: time })}\n                />\n              </Row>\n            )}\n          </Half>\n\n          <Half>\n            <Row>\n              <ToggleSwitch\n                on={visibleUntil}\n                onClick={() => this.setState({ visibleUntil: !visibleUntil })}\n              />\n              <Label>Visible Until</Label>\n            </Row>\n            {visibleUntil && (\n              <Row>\n                <DatePicker\n                  value={visibleUntilDate}\n                  onChange={date => this.setState({ visibleUntilDate: date })}\n                />\n                <TimeInput\n                  value={visibleUntilTime}\n                  placeholder=\"hh:mm\"\n                  onChange={time => this.setState({ visibleUntilTime: time })}\n                />\n              </Row>\n            )}\n          </Half>\n        </Row>\n      </ModalDialog>\n    );\n  }\n}\n","export const hasActuallyErrors = (obj: any) => {\n  if (!obj) return false;\n  if (typeof obj === \"string\") {\n    return true;\n  }\n\n  const t = Object.values(obj)\n    .map(hasActuallyErrors)\n    .filter(Boolean);\n\n  if (!t.length) {\n    return false;\n  }\n  return true;\n};\n","import * as Cotype from \"../../../../../../typings\";\nimport React from \"react\";\nimport { SortableElement, SortableHandle } from \"react-sortable-hoc\";\nimport styled, { css } from \"styled-components/macro\";\nimport { Field, ArrayHelpers, FormikProps, getIn } from \"formik\";\nimport Icon from \"../../../../common/icons\";\nimport { ITEM_VALUE_KEY } from \"./Input\";\nimport { hasActuallyErrors } from \"../../../formHelpers\";\n\nconst DragHandleIcon = styled(Icon.DragHandle)`\n  user-select: none;\n  opacity: 0.8;\n  cursor: move;\n  position: absolute;\n  z-index: 0;\n  top: 9px;\n  left: calc(-12px - 0.5 * var(--input-min-height));\n  transition: all 0.2s cubic-bezier(0.55, 0, 0.1, 1);\n  & path {\n    fill: #fff;\n  }\n  :hover {\n    opacity: 1;\n  }\n`;\n\nconst hasErrorClass = css`\n  color: #fff;\n  background: rgba(250, 57, 135, 0.05);\n  border-color: var(--error-color);\n  & > div {\n    color: var(--dark-color);\n  }\n`;\n\ntype Item = {\n  isSorting: boolean;\n  hasError?: boolean;\n  schedule: Cotype.Schedule;\n};\n\nfunction color(schedule: Cotype.Schedule) {\n  const { visibleFrom, visibleUntil } = schedule;\n  if (!visibleFrom && !visibleUntil) return \"var(--primary-color)\";\n  const now = new Date();\n  const future = visibleFrom && new Date(visibleFrom) > now;\n  const past = visibleUntil && new Date(visibleUntil) < now;\n  return future || past ? \"#4A4A4A\" : \"#4ECF8E\";\n}\n\nexport const Item = styled(\"div\")<Item>`\n  user-select: ${p => (p.isSorting ? \"none\" : \"auto\")};\n  background-color: var(--transparent-grey);\n  display: flex;\n  margin-bottom: 10px;\n  box-sizing: border-box;\n  position: relative;\n  border-left: var(--input-min-height) solid ${p => color(p.schedule)};\n  padding: 14px 32px 14px 21px;\n  border-radius: 4px;\n  ${p => p.hasError && hasErrorClass};\n`;\n\ntype P = {\n  sortable?: boolean;\n  isSorting?: boolean;\n};\nexport const ItemField = styled(\"div\")`\n  flex: 1;\n  position: relative;\n  :hover > svg,\n  :hover > .item-action {\n    opacity: ${(p: P) => (p.isSorting ? 0.5 : 1)};\n  }\n`;\n\nexport const ItemActions = styled(\"div\")`\n  user-select: none;\n  opacity: 0.5;\n  position: absolute;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  top: 0;\n  right: 0;\n  transition: all 0.2s cubic-bezier(0.55, 0, 0.1, 1);\n  :hover {\n    opacity: 1;\n  }\n`;\n\nexport const ItemAction = styled(\"button\")`\n  user-select: none;\n  border-radius: 50%;\n  border: none;\n  width: 4em;\n  height: 4em;\n  background: #fff;\n  transition: all 0.3s cubic-bezier(0.55, 0, 0.1, 1);\n  & svg {\n    color: var(--primary-color);\n  }\n  & svg:not(:last-child) {\n    margin-right: 0.8em;\n  }\n`;\n\nconst DragHandle = SortableHandle(() => <DragHandleIcon />);\n\ntype SortableItem = {\n  sortIndex: number;\n  sortable: boolean | undefined;\n  ItemComponent: React.ComponentType<any> & {\n    validate: (value: any, itemType: any) => void;\n  };\n  itemType;\n  arrayHelpers: ArrayHelpers & { form: FormikProps<any> };\n  renderItemOptions: (\n    arrayHelpers: ArrayHelpers & { form: FormikProps<any> },\n    sortIndex: number,\n    length: number,\n    sortable: boolean\n  ) => React.ReactNode;\n  name: string;\n  length: number;\n  isSorting: boolean;\n  schedule: Cotype.Schedule;\n};\nconst SortableItem = SortableElement(\n  ({\n    sortIndex,\n    sortable,\n    ItemComponent,\n    itemType,\n    arrayHelpers,\n    renderItemOptions,\n    name,\n    length,\n    isSorting,\n    schedule\n  }: SortableItem) => {\n    const fieldName = `${name}.${sortIndex}.${ITEM_VALUE_KEY}`;\n    const error = getIn(arrayHelpers.form.errors, fieldName);\n    return (\n      <Item\n        schedule={schedule}\n        isSorting={isSorting}\n        hasError={hasActuallyErrors(error)}\n      >\n        {sortable && <DragHandle />}\n        <ItemField sortable={sortable} isSorting={isSorting}>\n          <Field\n            name={fieldName}\n            render={props => <ItemComponent {...props} {...itemType} />}\n            {...itemType}\n            validate={value => {\n              if (typeof ItemComponent.validate === \"function\") {\n                return ItemComponent.validate(value, itemType);\n              }\n            }}\n          />\n        </ItemField>\n        <ItemActions className=\"item-action\">\n          {renderItemOptions(arrayHelpers, sortIndex, length, !!sortable)}\n        </ItemActions>\n      </Item>\n    );\n  }\n);\n\nexport default SortableItem;\n","import * as Cotype from \"../../../../../../typings\";\nimport React from \"react\";\nimport { ArrayHelpers, FormikProps } from \"formik\";\nimport { SortableContainer } from \"react-sortable-hoc\";\nimport SortableItem from \"./SortableItem\";\nimport styled from \"styled-components/macro\";\nimport { dragClass } from \"./Input\";\n\ntype Item = {\n  key: number | string;\n  value: { _type: string };\n} & Cotype.Schedule;\n\ntype SortableList = {\n  items: Item[];\n  name: string;\n  sortable: boolean | undefined;\n  ItemComponent: React.ComponentType<any> & { validate: () => void };\n  itemType;\n  arrayHelpers: ArrayHelpers & { form: FormikProps<any> };\n  renderItemOptions: (\n    arrayHelpers: ArrayHelpers & { form: FormikProps<any> },\n    sortIndex: number,\n    length: number\n  ) => React.ReactNode;\n  isSorting: boolean;\n};\nconst BasicSortableList = SortableContainer(\n  ({ items, ...props }: SortableList) => {\n    const { types } = props.itemType;\n    return (\n      <div>\n        {items &&\n          items\n            // only show data for existing models\n            .filter(i => {\n              // no type check necessary\n              if (!types && !(i.value || {})._type) return true;\n              return i.value._type && i.value._type in types;\n            })\n            .map((item, index) => (\n              <SortableItem\n                disabled={props.sortable ? false : true}\n                key={item.key}\n                index={index}\n                length={items.length}\n                schedule={item}\n                // point to the index of the unfiltered array\n                sortIndex={items.findIndex(i => i.key === item.key)}\n                {...props}\n              />\n            ))}\n      </div>\n    );\n  }\n);\nexport const DRAG_HELPER_CLASS = \"dragging-helper-class\";\nconst SortableList = styled(BasicSortableList)`\n  &.${DRAG_HELPER_CLASS} {\n    ${dragClass}\n  }\n`;\nexport default SortableList;\n","import * as Cotype from \"../../../../../../typings\";\nimport React, { Component } from \"react\";\nimport styled, { css } from \"styled-components/macro\";\nimport { FieldProps, FieldArray } from \"formik\";\nimport _omit from \"lodash/omit\";\nimport inputs from \"../../inputs\";\nimport serverSideProps from \"../../serverSideProps\";\nimport ListButton from \"../../../../common/ListButton\";\nimport MoreButton from \"../../../../common/MoreButton\";\nimport Schedule from \"../../../../common/Schedule\";\nimport SortableList, { DRAG_HELPER_CLASS } from \"./SortableList\";\n\nexport const ITEM_VALUE_KEY = \"value\";\n\nexport const dragClass = css`\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);\n  z-index: 4;\n`;\n\nconst Root = styled(\"div\")`\n  margin-bottom: 20px;\n`;\n\ntype Props = FieldProps<any> & Cotype.ListType;\ntype State = {\n  Factory?: React.ComponentClass | null;\n  isSorting: boolean;\n  schedule?: any;\n  onSchedule?: any;\n};\nexport default class ListInput extends Component<Props, State> {\n  static getDefaultValue(props: Props) {\n    return [];\n  }\n\n  static validate(value: string, { required }) {\n    if (required && (!value || !value.length)) {\n      return \"This field is required\";\n    }\n  }\n\n  state: State = {\n    isSorting: false\n  };\n\n  get mustNotAddItems() {\n    const {\n      maxLength,\n      field: { value }\n    } = this.props;\n    return maxLength ? value && value.length >= maxLength : false;\n  }\n\n  renderItemOptions = (arrayHelpers: any, index: number, lastIndex: number) => {\n    const {\n      sortable,\n      schedule,\n      field: { value }\n    } = this.props;\n    const actions = [\n      {\n        label: \"Remove\",\n        onClick: () => arrayHelpers.remove(index)\n      }\n    ];\n    if (!this.mustNotAddItems) {\n      actions.push({\n        label: \"Add new item\",\n        onClick: () =>\n          this.createItem(item => arrayHelpers.insert(index + 1, item))\n      });\n    }\n\n    if (schedule) {\n      actions.unshift({\n        label: \"Schedule\",\n        onClick: () => {\n          const { form, field } = this.props;\n          const item = field.value[index];\n          const name = `${field.name}[${index}]`;\n          this.setState({\n            schedule: item,\n            onSchedule: (s: Cotype.Schedule) => {\n              form.setFieldValue(name, { ...item, ...s });\n              this.closeSchedule();\n            }\n          });\n        }\n      });\n    }\n\n    if (sortable && value && value.length > 1) {\n      actions.push(\n        {\n          label: \"Move to top\",\n          onClick: () => arrayHelpers.move(index, 0)\n        },\n        {\n          label: \"Move to Bottom\",\n          onClick: () => arrayHelpers.move(index, lastIndex)\n        }\n      );\n    }\n    return <MoreButton actions={actions} />;\n  };\n\n  createItem = insert => {\n    const itemType = this.props.item;\n    const comp = inputs.get(itemType);\n\n    const value = this.props.field.value || [];\n    const key = 1 + value.reduce((max, item) => Math.max(max, item.key), 0);\n    const fieldProps = {\n      ..._omit(itemType, serverSideProps),\n      models:\n        \"model\" in itemType\n          ? [itemType.model]\n          : \"models\" in itemType\n          ? itemType.models\n          : undefined\n    };\n    if (comp.itemFactory) {\n      const Factory = comp.itemFactory(fieldProps, item => {\n        if (item) insert({ key, [ITEM_VALUE_KEY]: item });\n        this.setState({ Factory: null });\n      });\n      this.setState({ Factory });\n      return;\n    }\n\n    if (comp.getDefaultValue) {\n      insert({ key, [ITEM_VALUE_KEY]: comp.getDefaultValue(fieldProps) });\n    } else {\n      insert({ key, [ITEM_VALUE_KEY]: null });\n    }\n  };\n\n  closeSchedule = () => {\n    this.setState({ onSchedule: null });\n  };\n\n  render() {\n    const { field, item: itemType, sortable, addLabel } = this.props;\n\n    const { name, value } = field;\n    const ItemComponent = inputs.get(itemType);\n    const { Factory, isSorting, schedule, onSchedule } = this.state;\n    const fieldProps = {\n      ..._omit(itemType, serverSideProps),\n      models:\n        \"model\" in itemType\n          ? [itemType.model]\n          : \"models\" in itemType\n          ? itemType.models\n          : undefined\n    };\n    return (\n      <FieldArray\n        validateOnChange={false}\n        name={name}\n        render={arrayHelpers => (\n          <Root>\n            {value && (\n              <SortableList\n                lockToContainerEdges\n                lockAxis=\"y\"\n                items={value}\n                ItemComponent={ItemComponent}\n                sortable={sortable}\n                itemType={fieldProps}\n                renderItemOptions={this.renderItemOptions}\n                arrayHelpers={arrayHelpers}\n                name={name}\n                useDragHandle\n                helperClass={DRAG_HELPER_CLASS}\n                onSortStart={() => this.setState({ isSorting: true })}\n                onSortEnd={({ oldIndex, newIndex }) => {\n                  arrayHelpers.move(oldIndex, newIndex);\n                  this.setState({ isSorting: false });\n                }}\n                isSorting={isSorting}\n              />\n            )}\n            <ListButton\n              type=\"button\"\n              disabled={this.mustNotAddItems}\n              onClick={() => this.createItem(item => arrayHelpers.push(item))}\n            >\n              <span>{addLabel || \"Add\"}</span>\n            </ListButton>\n            {Factory && <Factory />}\n            {onSchedule && (\n              <Schedule\n                schedule={schedule}\n                onClose={this.closeSchedule}\n                onSchedule={onSchedule}\n              />\n            )}\n          </Root>\n        )}\n      />\n    );\n  }\n}\n","import React from \"react\";\nimport styled from \"styled-components/macro\";\nimport { Field, ArrayHelpers, FormikProps } from \"formik\";\nimport Icon from \"../../../../common/icons\";\nimport { SortableElement } from \"react-sortable-hoc\";\nimport { ITEM_VALUE_KEY } from \"../block/Input\";\n\ntype Item = {\n  isSorting?: boolean;\n  sortable?: boolean | undefined;\n};\n\nexport const Item = styled(\"div\")`\n  box-sizing: border-box;\n  user-select: ${(p: Item) => (p.isSorting ? \"none\" : \"auto\")};\n  color: rgba(0, 0, 0, 0.87);\n  border: none;\n  cursor: ${(p: Item) => (p.sortable ? \"move\" : \"auto\")};\n  min-height: var(--input-min-height);\n  outline: none;\n  padding: 5px;\n  display: inline-flex;\n  transition: background-color 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,\n    box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;\n  white-space: nowrap;\n  align-items: center;\n  border-radius: 4px;\n  vertical-align: middle;\n  text-decoration: none;\n  justify-content: center;\n  background-color: var(--transparent-grey);\n  margin: 0 10px 10px 0;\n  border-left: 5px solid var(--primary-color);\n`;\n\nconst StyledButton = styled(\"button\")`\n  padding: 0;\n  border: none;\n  background: none;\n  cursor: pointer;\n  :focus {\n    outline: 0;\n  }\n`;\n\nconst ClearCircleIcon = styled(Icon.ClearCircle)`\n  color: rgba(0, 0, 0, 0.26);\n  margin: 0 4px;\n`;\n\ntype SortableItem = {\n  sortIndex: number;\n  sortable: boolean | undefined;\n  ItemComponent: React.ComponentType<any> & {\n    validate: (value: any, itemType: any) => void;\n  };\n  itemType;\n  arrayHelpers: ArrayHelpers & { form: FormikProps<any> };\n  removeItem: (arg: any) => void;\n  name: string;\n  length: number;\n  isSorting: boolean;\n};\nconst SortableItem = SortableElement(\n  ({\n    sortIndex,\n    sortable,\n    ItemComponent,\n    itemType,\n    removeItem,\n    name,\n    isSorting\n  }: SortableItem) => {\n    return (\n      <Item isSorting={isSorting} sortable={sortable}>\n        <Field\n          name={`${name}.${sortIndex}.${ITEM_VALUE_KEY}`}\n          render={props => (\n            <ItemComponent\n              {...props}\n              {...itemType}\n              value={props.field.value}\n              layout=\"inList\"\n            />\n          )}\n          {...itemType}\n          validate={value => {\n            if (typeof ItemComponent.validate === \"function\") {\n              return ItemComponent.validate(value, itemType);\n            }\n          }}\n        />\n        <StyledButton type=\"button\" onClick={() => removeItem(sortIndex)}>\n          <ClearCircleIcon />\n        </StyledButton>\n      </Item>\n    );\n  }\n);\n\nexport default SortableItem;\n","import React from \"react\";\nimport { ArrayHelpers, FormikProps } from \"formik\";\nimport { SortableContainer } from \"react-sortable-hoc\";\nimport SortableItem from \"./SortableItem\";\n\ntype SortableList = {\n  items: ({ key: number | string; value: { _type: string } })[];\n  name: string;\n  sortable: boolean | undefined;\n  ItemComponent: React.ComponentType<any> & { validate: () => void };\n  itemType;\n  arrayHelpers: ArrayHelpers & { form: FormikProps<any> };\n  removeItem: (index: number) => void;\n  isSorting: boolean;\n};\nconst SortableList = SortableContainer(({ items, ...props }: SortableList) => {\n  return (\n    <div>\n      {items &&\n        items\n          // only show data for existing models\n          .filter(i => {\n            // no type check necessary\n            if (!props.itemType.types && !(i.value || {})._type) return true;\n            return (\n              i.value._type &&\n              props.itemType.types.hasOwnProperty(i.value._type)\n            );\n          })\n          .map((item, index) => (\n            <SortableItem\n              disabled={props.sortable ? false : true}\n              key={item.key}\n              index={index}\n              length={items.length}\n              // point to the index of the unfiltered array\n              sortIndex={items.findIndex(i => i.key === item.key)}\n              {...props}\n            />\n          ))}\n    </div>\n  );\n});\n\nexport default SortableList;\n","import { Type } from \"../../../../typings\";\nconst outputs: any = {};\n\nconst id = Symbol(\"outputs\");\n\nexport default {\n  id,\n  register(elements: any) {\n    Object.assign(outputs, elements);\n  },\n\n  get(t: Type) {\n    const input = \"input\" in t && t.input;\n    return (input && outputs[input]) || outputs[t.type];\n  }\n};\n","import * as Cotype from \"../../../../../../typings\";\nimport React, { Component, Fragment } from \"react\";\nimport styled from \"styled-components/macro\";\nimport { FieldProps, FieldArray } from \"formik\";\nimport inputs from \"../../inputs\";\nimport Button from \"../../../../common/Button\";\nimport ListButton from \"../../../../common/ListButton\";\nimport SortableList from \"./SortableList\";\nimport outputs from \"../../outputs\";\nimport { DRAG_HELPER_CLASS } from \"../block/SortableList\";\nimport _omit from \"lodash/omit\";\nimport serverSideProps from \"../../serverSideProps\";\n\nexport const ITEM_VALUE_KEY = \"value\";\n\nconst NewItemActions = styled(\"div\")`\n  & > *:not(:last-child) {\n    margin-right: 1em !important;\n  }\n  margin-top: 10px;\n`;\nconst Cancel = styled(\"span\")`\n  cursor: pointer;\n  color: var(--dark-grey);\n`;\n\ntype Props = FieldProps<any> & Cotype.ListType;\ntype State = {\n  Factory?: React.ComponentClass | null;\n  isSorting: boolean;\n  newItemValue: string | null;\n};\nexport default class ChipListInput extends Component<Props, State> {\n  static getDefaultValue(props: Props) {\n    return [];\n  }\n\n  static validate(value: string, { required }) {\n    if (required && (!value || !value.length)) {\n      return \"This field is required\";\n    }\n  }\n\n  state: State = {\n    isSorting: false,\n    newItemValue: \"\"\n  };\n\n  createItem = (insert, item = null) => {\n    let { newItemValue } = this.state;\n    if (item) newItemValue = item;\n    if (!newItemValue) return;\n\n    const { value } = this.props.field;\n\n    let maxId = 0;\n    if (value) {\n      value.forEach(v => {\n        if (v.key > maxId) maxId = v.key;\n      });\n      maxId++;\n    }\n\n    insert({ key: maxId, [ITEM_VALUE_KEY]: newItemValue });\n    this.setState({ newItemValue: \"\" });\n  };\n\n  createFactory = arrayHelpers => {\n    const itemType = this.props.item;\n    const InputComponent = inputs.get(itemType);\n    const fieldProps = {\n      ..._omit(itemType, serverSideProps),\n      models:\n        \"model\" in itemType\n          ? [itemType.model]\n          : \"models\" in itemType\n          ? itemType.models\n          : undefined\n    };\n    let Factory;\n    if (InputComponent.itemFactory) {\n      Factory = InputComponent.itemFactory(fieldProps, item => {\n        if (item) this.createItem(i => arrayHelpers.push(i), item);\n        this.setState({ Factory: null });\n      });\n    } else {\n      const setFieldValue = (n, v) => this.setState({ newItemValue: v });\n      const onChange = e => this.setState({ newItemValue: e.target.value });\n\n      Factory = () => (\n        <div>\n          <InputComponent\n            {...fieldProps}\n            form={{ setFieldValue }}\n            field={{ value: this.state.newItemValue, name: \"new\", onChange }}\n            layout=\"inList\"\n            placeholder=\"Search for another one...\"\n            value={this.state.newItemValue}\n          />\n          <NewItemActions>\n            <Button\n              type=\"submit\"\n              onClick={() =>\n                this.createItem(item => {\n                  arrayHelpers.push(item);\n                  this.setState({\n                    Factory: null\n                  });\n                })\n              }\n            >\n              <span>OK</span>\n            </Button>\n            <Cancel\n              onClick={() =>\n                this.setState({\n                  Factory: null\n                })\n              }\n            >\n              Abbrechen\n            </Cancel>\n          </NewItemActions>\n        </div>\n      );\n    }\n    this.setState({ Factory });\n  };\n\n  render() {\n    const { field, item: itemType, sortable, maxLength } = this.props;\n    const { name, value } = field;\n    const ItemComponent = outputs.get(itemType);\n    const { Factory, isSorting } = this.state;\n\n    const isNotAllowedToAddMoreItems = maxLength\n      ? value && value.length >= maxLength\n      : false;\n    const fieldProps = {\n      ..._omit(itemType, serverSideProps),\n      models:\n        \"model\" in itemType\n          ? [itemType.model]\n          : \"models\" in itemType\n          ? itemType.models\n          : undefined\n    };\n    return (\n      <FieldArray\n        validateOnChange={false}\n        name={name}\n        render={arrayHelpers => (\n          <Fragment>\n            <SortableList\n              lockToContainerEdges\n              axis=\"xy\"\n              items={value}\n              ItemComponent={ItemComponent}\n              sortable={sortable}\n              itemType={fieldProps}\n              removeItem={index => arrayHelpers.remove(index)}\n              arrayHelpers={arrayHelpers}\n              name={name}\n              helperClass={DRAG_HELPER_CLASS}\n              onSortStart={() => this.setState({ isSorting: true })}\n              onSortEnd={({ oldIndex, newIndex }) => {\n                arrayHelpers.move(oldIndex, newIndex);\n                this.setState({ isSorting: false });\n              }}\n              shouldCancelStart={(e: any) => {\n                const disabledElements = [\"path\", \"svg\", \"button\"];\n                if (e.target.tagName !== undefined) {\n                  if (\n                    disabledElements.indexOf(e.target.tagName.toLowerCase()) !==\n                    -1\n                  ) {\n                    return true;\n                  }\n                }\n                return false;\n              }}\n              isSorting={isSorting}\n            />\n            {!isNotAllowedToAddMoreItems &&\n              (Factory ? (\n                <Factory />\n              ) : (\n                <ListButton\n                  type=\"button\"\n                  onClick={() => this.createFactory(arrayHelpers)}\n                >\n                  Hinzufügen\n                </ListButton>\n              ))}\n          </Fragment>\n        )}\n      />\n    );\n  }\n}\n","import * as Cotype from \"../../../../../typings\";\nimport React, { Component } from \"react\";\nimport { FieldProps } from \"formik\";\nimport Inline from \"./inline/Input\";\nimport Block from \"./block/Input\";\nimport { required } from \"../validation\";\nimport inputs from \"../inputs\";\n\ntype Props = FieldProps<any> & Cotype.ListType;\n\nconst listNeedsToHaveMoreItems = (listValues: any[], props: Props): boolean => {\n  const { minLength } = props;\n  return (\n    minLength !== undefined &&\n    ((props.required || !!(listValues || []).length) &&\n      listValues.length < minLength)\n  );\n};\nexport const listNeedsToHaveLessItems = (\n  listValues: any[],\n  props: Props\n): boolean => {\n  const { maxLength } = props;\n  return (\n    maxLength !== undefined &&\n    (props.required || !!(listValues || []).length) &&\n    listValues.length > maxLength\n  );\n};\n\nclass Input extends Component<Props> {\n  static validate(value: any, props: Props) {\n    const isRequired = required(value ? value.length : value, props);\n    if (isRequired) return isRequired;\n    const errors: any = [];\n\n    const { minLength, maxLength } = props;\n\n    if (listNeedsToHaveMoreItems(value, props)) {\n      return `This list needs to contain at least ${minLength} items${\n        props.required ? \"\" : \" when used\"\n      }.`;\n    }\n\n    if (listNeedsToHaveLessItems(value, props)) {\n      return `This list must not contain more then ${maxLength} items${\n        props.required ? \"\" : \" when used\"\n      }.`;\n    }\n\n    if (value && value.length) {\n      value.forEach((item, idx) => {\n        const component = inputs.get(props.item);\n        const error = component && component.validate(item.value, props.item);\n        if (error) errors[idx] = { value: error };\n      });\n\n      if (errors.length > 0) return errors;\n    }\n  }\n\n  render() {\n    const { layout = \"block\" } = this.props;\n    if (layout === \"inline\") return <Inline {...this.props} />;\n    return <Block {...this.props} />;\n  }\n}\n\nexport default Input;\n","import { Type } from \"../../../../../../typings\";\nimport React from \"react\";\nimport outputs from \"../../outputs\";\nimport styled from \"styled-components/macro\";\nimport { Item } from \"./SortableItem\";\n\nconst ItemField = styled(\"div\")`\n  flex: 1;\n  position: relative;\n  padding-right: 0.8em;\n`;\n\ntype Props = {\n  value: any[];\n  item: Type;\n};\n\nexport default (props: Props) => {\n  const { value, item: itemType } = props;\n  const ItemComponent = outputs.get(itemType);\n\n  return (\n    <div>\n      {value &&\n        value.map((item, index) => (\n          <Item key={index} style={{ borderColor: \"rgba(0, 0, 0, 0.25)\" }}>\n            <ItemField>\n              <ItemComponent value={item.value} {...itemType} />\n            </ItemField>\n          </Item>\n        ))}\n    </div>\n  );\n};\n","import * as Cotype from \"../../../../../../typings\";\nimport React from \"react\";\nimport outputs from \"../../outputs\";\nimport styled from \"styled-components/macro\";\n\nconst ItemField = styled(\"div\")`\n  background-color: var(--transparent-grey);\n  display: flex;\n  flex-direction: column;\n  margin-bottom: 10px;\n  box-sizing: border-box;\n  position: relative;\n  border-left: var(--input-min-height) solid rgba(0, 0, 0, 0.25);\n  padding: 14px 32px 14px 21px;\n  border-radius: 4px;\n  width: 100%;\n`;\n\ntype Props = {\n  value: any[];\n  item: Cotype.Type;\n  sortable: boolean;\n};\n\nexport default (props: Props) => {\n  const { value, item: itemType } = props;\n  const ItemComponent = outputs.get(itemType);\n  return (\n    <div>\n      {value &&\n        value.map((item, index) => (\n          <ItemField key={index}>\n            <ItemComponent value={item.value} {...itemType} layout=\"inList\" />\n          </ItemField>\n        ))}\n    </div>\n  );\n};\n","import * as Cotype from \"../../../../../typings\";\nimport React, { Component } from \"react\";\nimport Inline from \"./inline/Output\";\nimport Block from \"./block/Output\";\nimport outputs from \"../outputs\";\n\ntype Props = Cotype.ListType & {\n  value: any[];\n  item: Cotype.Type;\n  sortable: boolean;\n};\n\nexport default class Output extends Component<Props> {\n  static getSummary = (type, props) => {\n    const { value, item: itemType } = props;\n    const getSummary = outputs.get(itemType)[type];\n\n    if (!value || !getSummary) return null;\n    return value.reduce((summary, item) => {\n      if (summary) return summary;\n      return getSummary({ ...itemType, value: item.value });\n    }, null);\n  };\n\n  static getSummaryImage(props: Props) {\n    return Output.getSummary(\"getSummaryImage\", props);\n  }\n\n  static getSummaryText(props: Props) {\n    return Output.getSummary(\"getSummaryText\", props);\n  }\n\n  render() {\n    const { layout = \"block\" } = this.props;\n    if (layout === \"inline\") return <Inline {...this.props} />;\n    return <Block {...this.props} />;\n  }\n}\n","import React, { Component } from \"react\";\nimport styled, { css } from \"styled-components/macro\";\nimport { Error } from \"../common/styles\";\nimport { errorClass } from \"../Edit/Form\";\n\nconst FieldBlock = styled(\"div\")`\n  box-sizing: border-box;\n  /* padding-top: 24px;\n  padding-bottom: 24px;\n  padding-left: 24px; */\n  padding: 24px;\n`;\n\nconst FieldListBlock = styled(\"div\")`\n  box-sizing: border-box;\n  padding-top: 12px;\n  padding-bottom: 12px;\n`;\n\nconst labelColor = css`\n  color: var(--dark-color);\n  font-weight: bold;\n`;\n\nconst LabelBlock = styled(\"div\")`\n  ${labelColor} margin-bottom: 0.5em;\n`;\n\nconst InlineLabel = styled(\"span\")`\n  ${labelColor} margin-left: 0.2em;\n  margin-right: 1em;\n`;\n\nconst Cell = styled(\"td\")`\n  padding-bottom: 1em;\n`;\n\nconst LabelCell = styled(Cell)`\n  ${labelColor} min-width: 125px;\n`;\n\n// TODO can we remove inline and inList?\nexport type FieldLayout =\n  | \"vertical\"\n  | \"horizontal\"\n  | \"modal\"\n  | \"inline\"\n  | \"inList\";\n\ntype Props = {\n  layout?: FieldLayout;\n  fields: {\n    key?: string;\n    error?: string;\n    label: any;\n    element: any;\n  }[];\n};\n\nexport default class Fields extends Component<Props> {\n  render() {\n    const errorHandler = error =>\n      typeof error === \"string\" && (\n        <Error className={errorClass}>{error}</Error>\n      );\n\n    const { fields, layout = \"vertical\" } = this.props;\n    if (layout === \"horizontal\") {\n      return (\n        <table>\n          <tbody>\n            {fields.map(f => (\n              <tr key={f.key || f.label}>\n                <LabelCell>{f.label}</LabelCell>\n                <Cell>{f.element}</Cell>\n                {errorHandler(f.error)}\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      );\n    }\n    if (layout === \"inline\") {\n      return (\n        <div>\n          {fields.map(f => (\n            <label key={f.key || f.label}>\n              {f.element}\n              <InlineLabel>{f.label}</InlineLabel>\n              {errorHandler(f.error)}\n            </label>\n          ))}\n        </div>\n      );\n    }\n    if (layout === \"inList\") {\n      return (\n        <div style={{ width: \"100%\" }}>\n          {fields.map(f => (\n            <FieldListBlock key={f.key || f.label}>\n              <LabelBlock>{f.label}</LabelBlock>\n              <div>{f.element}</div>\n              {errorHandler(f.error)}\n            </FieldListBlock>\n          ))}\n        </div>\n      );\n    }\n    return (\n      <div>\n        {fields.map(f => (\n          <FieldBlock key={f.key || f.label}>\n            <LabelBlock>{f.label}</LabelBlock>\n            <div>{f.element}</div>\n            {errorHandler(f.error)}\n          </FieldBlock>\n        ))}\n      </div>\n    );\n  }\n}\n","import * as Cotype from \"../../../../typings\";\nimport React, { Component } from \"react\";\nimport { titleCase } from \"title-case\";\n\nimport Fields, { FieldLayout } from \"../../common/Fields\";\nimport outputs from \"./outputs\";\n\ntype Props = {\n  value: any;\n  compareTo?: any;\n  layout?: FieldLayout;\n  fields: Cotype.Fields;\n};\nexport default class ObjectOutput extends Component<Props> {\n  static getSummary = (type, props) => {\n    const { value, fields } = props;\n    if (!value) return null;\n    return Object.keys(fields).reduce((summary, key) => {\n      if (summary) return summary;\n      const f = fields[key];\n      const output = outputs.get(f);\n      if (output[type] && value[key]) {\n        return output[type]({ ...f, value: value[key] });\n      }\n      return null;\n    }, null);\n  };\n\n  static getSummaryImage(props: Props) {\n    return ObjectOutput.getSummary(\"getSummaryImage\", props);\n  }\n\n  static getSummaryText(props: Props) {\n    return ObjectOutput.getSummary(\"getSummaryText\", props);\n  }\n\n  render() {\n    const { value, compareTo, fields, layout } = this.props;\n    return (\n      <Fields\n        layout={layout}\n        fields={\n          Object.keys(fields)\n            .map(key => {\n              const f = fields[key];\n              if (\"hidden\" in f) return null;\n              const { type, label = titleCase(key), ...props } = f;\n              if (type === \"position\" || type === \"references\") {\n                return null;\n              }\n              const FieldComponent = outputs.get(f);\n              const element = (\n                <FieldComponent\n                  {...props}\n                  value={(value || {})[key]}\n                  compareTo={compareTo && compareTo[key]}\n                />\n              );\n              return { label, element, key };\n            })\n            .filter(Boolean) as any\n        }\n      />\n    );\n  }\n}\n","import * as Cotype from \"../../../../typings\";\nimport React, { Component } from \"react\";\nimport { Field, FieldProps, getIn } from \"formik\";\nimport _omit from \"lodash/omit\";\nimport { titleCase } from \"title-case\";\nimport Fields, { FieldLayout } from \"../../common/Fields\";\nimport inputs from \"./inputs\";\nimport ObjectOutput from \"./ObjectOutput\";\nimport ModalDialog from \"../../common/ModalDialog\";\nimport Button from \"../../common/Button\";\nimport styled from \"styled-components/macro\";\nimport { required } from \"./validation\";\nimport { paths } from \"../../common/icons\";\nimport { hasActuallyErrors } from \"../formHelpers\";\nimport serverSideProps from \"./serverSideProps\";\n\nconst modalStyle = {\n  width: \"80vw\",\n  height: \"90vh\",\n  background: \"#f5f5f5\",\n  maxWidth: 1200\n};\nconst Summary = styled(\"div\")`\n  flex: 1;\n  display: flex;\n  margin-right: 1em;\n`;\ntype Props = Partial<FieldProps<any>> & {\n  layout?: FieldLayout;\n  fields: Cotype.Fields;\n  form: any;\n  label?: string;\n  modalView?: boolean;\n  model?: Cotype.Model;\n  id?: string;\n};\n\ntype State = {\n  showModal?: boolean;\n  initalValues?: any;\n  initalErrors?: any;\n};\n\nexport default class ObjectInput extends Component<Props> {\n  static getDefaultValue({ fields }) {\n    const initialValues = {};\n    Object.keys(fields).forEach(id => {\n      const f = fields[id];\n      if (f.type === \"references\") {\n        return;\n      }\n      const component = inputs.get(f);\n      initialValues[id] =\n        component && component.getDefaultValue\n          ? component.getDefaultValue(f)\n          : null;\n    });\n    return initialValues;\n  }\n\n  static validate(value, props) {\n    const isRequired = required(value, props);\n    if (isRequired) return isRequired;\n\n    const errors = {};\n    Object.keys(props.fields).forEach(f => {\n      if (props.fields[f].type === \"references\") {\n        return;\n      }\n      const component = inputs.get(props.fields[f]);\n      const error = component.validate((value || {})[f], props.fields[f]);\n      if (error) errors[f] = error;\n    });\n    if (Object.keys(errors).length > 0) return errors;\n  }\n\n  state: State = {\n    showModal: false\n  };\n\n  toggleModal = () => {\n    this.setState((prevState: State) => {\n      const { form, field } = this.props;\n      const nextState = {\n        ...prevState,\n        showModal: !prevState.showModal\n      };\n\n      if (form && field) {\n        const initalErrros = getIn(form.errors, field.name);\n        return {\n          ...nextState,\n          initalValues: JSON.parse(JSON.stringify(form.values)),\n          initalErrors: initalErrros\n            ? JSON.parse(JSON.stringify(initalErrros))\n            : initalErrros\n        };\n      }\n\n      return nextState;\n    });\n  };\n\n  renderSummary() {\n    const { field, fields } = this.props;\n\n    if (!field) return null;\n    const { value } = field;\n    const image = ObjectOutput.getSummaryImage({ value, fields });\n    const text = ObjectOutput.getSummaryText({ value, fields });\n\n    return (\n      <Summary style={{ flex: 1 }}>\n        {image && <div style={{ marginRight: \"1em\" }}>{image}</div>}\n        {text && <div>{text}</div>}\n      </Summary>\n    );\n  }\n\n  renderModal() {\n    if (!this.state.showModal) return null;\n    const { label, form, field, id } = this.props;\n\n    const onSubmit = () => {\n      if (!field) {\n        return;\n      }\n\n      if (form.validateField(field.name) instanceof Promise) {\n        form.validateField(field.name).then(err => {\n          const errors = JSON.stringify(err);\n          if (!errors) {\n            this.toggleModal();\n          }\n        });\n      } else {\n        form.validateField(field.name);\n        setTimeout(() => {\n          const err = !!getIn(this.props.form.errors, field.name);\n          if (!err) {\n            this.toggleModal();\n          }\n        }, 50);\n      }\n    };\n\n    const onClose = () => {\n      if (field) {\n        form.setValues(this.state.initalValues);\n        form.setFieldError(field.name, this.state.initalErrors);\n      }\n\n      this.toggleModal();\n    };\n\n    const actions = [\n      <Button icon={paths.Save} onClick={onSubmit}>\n        Übernehmen\n      </Button>,\n      <Button icon={paths.Clear} onClick={onClose} light>\n        Abbrechen\n      </Button>\n    ];\n\n    return (\n      <ModalDialog\n        title={label ? label : \"Edit\"}\n        onClose={onClose}\n        actionButtons={actions}\n        style={modalStyle}\n      >\n        <ObjectInput\n          {...this.props}\n          modalView={false}\n          layout=\"vertical\"\n          id={id}\n        />\n      </ModalDialog>\n    );\n  }\n\n  render() {\n    const { form, field, fields, layout, modalView, model, id } = this.props;\n\n    if (modalView) {\n      return (\n        <div>\n          <div\n            style={{\n              display: \"flex\",\n              alignItems: \"flex-end\"\n            }}\n          >\n            {this.renderSummary()}\n            <div>\n              <Button onClick={this.toggleModal}>Edit</Button>\n            </div>\n          </div>\n          {this.renderModal()}\n        </div>\n      );\n    }\n    const fieldKeys = Object.keys(fields);\n    const prefix = field ? `${field.name}.` : \"\";\n    return (\n      <Fields\n        layout={layout}\n        fields={\n          fieldKeys\n            .map(key => {\n              const f = fields[key];\n              const { label: l, ...props } = f;\n\n              if (\n                \"hidden\" in f ||\n                f.type === \"references\" ||\n                f.type === \"virtual\"\n              )\n                return null;\n\n              const component = inputs.get(f);\n              let label = l || titleCase(key);\n\n              if (component && typeof component.getHint === \"function\") {\n                const getHint = component.getHint(fields[key]);\n                if (getHint) label += ` ${getHint}`;\n              }\n\n              if (\"required\" in f && f.required) {\n                label += \"*\";\n              }\n\n              const name = `${prefix}${key}`;\n              const error = getIn(form.errors, name);\n\n              const fieldProps = {\n                ..._omit(props, serverSideProps),\n                models:\n                  \"model\" in props\n                    ? [props.model]\n                    : \"models\" in props\n                    ? props.models\n                    : undefined\n              };\n              const element = (\n                <Field\n                  name={name}\n                  component={component}\n                  model={model}\n                  id={id}\n                  {...fieldProps}\n                  validate={value => {\n                    if (typeof component.validate === \"function\") {\n                      return component.validate(value, props);\n                    }\n                  }}\n                />\n              );\n              return {\n                label,\n                element,\n                key,\n                error: hasActuallyErrors(error) ? error : undefined\n              };\n            })\n            .filter(Boolean) as any\n        }\n      />\n    );\n  }\n}\n","import * as Cotype from \"../../../../typings\";\nimport React, { Component, Fragment } from \"react\";\nimport { FieldProps } from \"formik\";\nimport styled from \"styled-components/macro\";\nimport { titleCase } from \"title-case\";\nimport basePath from \"../../basePath\";\nimport Button from \"../../common/Button\";\nimport ModalDialog from \"../../common/ModalDialog\";\nimport ObjectInput from \"./ObjectInput\";\nimport inputs from \"./inputs\";\nimport { required } from \"./validation\";\n\nexport const TypeLabel = styled(\"div\")`\n  color: var(--primary-color);\n  font-weight: bold;\n  font-size: 16px;\n  text-transform: uppercase;\n  margin-bottom: 1em;\n`;\n\ntype IconProps = {\n  name: string;\n};\nconst Icon = styled(\"div\")<IconProps>`\n  display: inline-block;\n  width: 24px;\n  height: 24px;\n  mask-image: url(${({ name }) => `${basePath}/rest/icons/${name}.svg`});\n  background-color: var(--accent-color);\n  margin-right: 4px;\n`;\nconst WrapFlexCenter = styled(\"div\")`\n  display: flex;\n  align-items: center;\n`;\n\ntype Props = FieldProps<any> & {\n  types: object;\n};\ntype State = {\n  type: string;\n};\nexport default class UnionInput extends Component<Props, State> {\n  static getDefaultValue(props: Props) {\n    return null;\n  }\n\n  static validate(value: any, props) {\n    const isRequired = required(value, props);\n    if (isRequired) return isRequired;\n\n    const type = props.types[value._type];\n    const component = inputs.get(type);\n    const errors = component.validate(value, type);\n\n    if (errors) return errors;\n  }\n\n  static itemFactory(type: Cotype.UnionType, cb: (arg: object | null) => void) {\n    return () => (\n      <ModalDialog\n        title=\"Choose a type\"\n        onClose={() => cb(null)}\n        style={{ minWidth: 250, maxWidth: 750 }}\n      >\n        <WrapFlexCenter style={{ flexWrap: \"wrap\" }}>\n          {Object.keys(type.types).map(typeKey => (\n            <Button\n              light\n              key={typeKey}\n              // icon={type.types[typeKey].icon}\n              onClick={() => cb({ _type: typeKey })}\n            >\n              <WrapFlexCenter>\n                {type.types[typeKey].icon && (\n                  <Icon name={type.types[typeKey].icon!} />\n                )}\n                {type.types[typeKey].label || typeKey}\n              </WrapFlexCenter>\n            </Button>\n          ))}\n        </WrapFlexCenter>\n      </ModalDialog>\n    );\n  }\n\n  render() {\n    const { field, types, form, ...props } = this.props;\n    const { value } = field;\n    if (!value) return null;\n    const { _type } = value;\n    const type = types[_type];\n    return (\n      <Fragment>\n        <TypeLabel>{type.label || titleCase(_type)}</TypeLabel>\n        <ObjectInput field={field} form={form} {...type} {...props} />\n      </Fragment>\n    );\n  }\n}\n","import React, { Component, Fragment } from \"react\";\nimport ObjectOutput from \"./ObjectOutput\";\nimport outputs from \"./outputs\";\nimport { TypeLabel } from \"./UnionInput\";\nimport { titleCase } from \"title-case\";\n\ntype Props = {\n  value: {\n    _type: string;\n    [index: string]: any;\n  };\n  types: {};\n};\n\nexport default class UnionOutput extends Component<Props> {\n  static getSummary = (type, props) => {\n    const { value, types } = props;\n    if (!value || !value._type) return null;\n    const output = outputs.get(types[value._type]);\n    if (output && output[type]) {\n      return output[type]({ ...types[value._type], value });\n    }\n    return null;\n  };\n\n  static getSummaryImage(props: Props) {\n    return UnionOutput.getSummary(\"getSummaryImage\", props);\n  }\n\n  static getSummaryText(props: Props) {\n    return UnionOutput.getSummary(\"getSummaryText\", props);\n  }\n\n  render() {\n    const { value, types, ...props } = this.props;\n    if (!value) return null;\n    const { _type } = value;\n    const type = types[_type];\n    if (!type) return null;\n    const fields = type.fields;\n    return (\n      <Fragment>\n        <TypeLabel style={{ color: \"var(--dark-color)\" }}>\n          {type.label || titleCase(_type)}\n        </TypeLabel>\n        <ObjectOutput fields={fields} value={value} {...props} />\n      </Fragment>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport { FieldProps } from \"formik\";\nimport api from \"../../api\";\nimport { required } from \"./validation\";\n\ntype Props = FieldProps<any> & {\n  nullLabel?: string;\n  fetch?: string;\n  values?: string[] | any[];\n  required?: boolean;\n};\ntype State = {\n  options: any[];\n};\nexport default class OptionsInput extends Component<Props, State> {\n  static getDefaultValue(props: Props) {\n    if (props.nullLabel) return null;\n    return props.values && props.values[0]\n      ? typeof props.values[0] === \"string\"\n        ? props.values[0]\n        : props.values[0].value\n      : null;\n  }\n\n  static validate(value: any, props: Props) {\n    const isRequired = required(value, props);\n    if (isRequired) return isRequired;\n  }\n\n  state: State = {\n    options: []\n  };\n\n  setOptions = opts => {\n    const { nullLabel } = this.props;\n\n    const options = opts\n      ? opts.map(o => (typeof o === \"string\" ? { label: o, value: o } : o))\n      : [];\n    if (nullLabel) {\n      options.unshift({ label: nullLabel, value: \"\" });\n    }\n    this.setState({ options });\n  };\n\n  componentDidMount() {\n    const { values, fetch, nullLabel, form, field } = this.props;\n\n    if (fetch) {\n      api.get(fetch).then(this.setOptions);\n    } else {\n      this.setOptions(values);\n      if (!nullLabel && !field.value && values && values.length > 0) {\n        form.setFieldValue(\n          field.name,\n          typeof values[0] === \"string\" ? values[0] : values[0].value\n        );\n      }\n    }\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    const { nullLabel, values, form, field } = this.props;\n\n    if (!nullLabel && !field.value && values && values !== prevProps.values) {\n      form.setFieldValue(\n        field.name,\n        typeof values[0] === \"string\" ? values[0] : values[0].value\n      );\n    }\n  }\n\n  render() {\n    const { field } = this.props;\n    const { options } = this.state;\n    const { value, ...props } = field;\n    const selected = options.find(o => String(o.value) === String(value));\n    return (\n      <select\n        value={\n          selected\n            ? typeof selected === \"string\"\n              ? selected\n              : selected.value\n            : \"\"\n        }\n        {...props}\n      >\n        {options.map(o => (\n          <option key={o.value} value={o.value}>\n            {o.label}\n          </option>\n        ))}\n      </select>\n    );\n  }\n}\n","import React, { Component } from \"react\";\n\ntype Props = {\n  value: string | { label: string; value: string };\n};\nexport default class OptionsOutput extends Component<Props> {\n  render() {\n    const { value } = this.props;\n    return (\n      <select disabled>\n        <option value={typeof value === \"string\" ? value : value && value.value}>{typeof value === \"string\" ? value : value && value.label}</option>)\n      </select>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport styled from \"styled-components/macro\";\nimport PopoverMenu, { Menu, Item } from \"./PopoverMenu\";\nimport Icon from \"./icons\";\nimport { testable } from \"../utils/helper\";\n\ntype P = {\n  disabled?: boolean;\n};\n\nconst Button = styled(\"div\")`\n  display: inline-block;\n  border-radius: 3px;\n  position: relative;\n  background-color: ${(p: P) =>\n    p.disabled ? \"var(--disabled-color)\" : \"var(--accent-color)\"};\n`;\n\nconst ButtonFace = styled(\"div\")`\n  border-radius: 3px;\n  box-sizing: border-box;\n  color: #fff;\n  cursor: pointer;\n  font-family: inherit;\n  font-size: 1.1em;\n  font-weight: 500;\n  line-height: inherit;\n  padding: 0.8em 1em;\n  display: inline-flex;\n  text-transform: uppercase;\n  white-space: nowrap;\n  background-color: ${(p: P) =>\n    p.disabled ? \"var(--disabled-color)\" : \"transparent\"};\n  :hover {\n    background-color: ${(p: P) =>\n      p.disabled ? \"var(--disabled-color)\" : \"hsla(0, 0%, 100%, 0.1)\"};\n  }\n`;\n\nconst Label = styled(\"div\")`\n  flex: 1;\n  margin-right: 1em;\n`;\n\nconst styles = {\n  item: {\n    cursor: \"pointer\"\n  }\n};\n\ntype Action = {\n  label: string;\n  onClick?: () => void;\n  disabled?: boolean;\n};\n\ntype Props = {\n  label: string;\n  disabled?: boolean;\n  actions: Action[];\n};\nexport default class ActionButton extends Component<Props> {\n  renderMenu = (close: () => void) => {\n    const { disabled, actions } = this.props;\n    if (disabled) return null;\n    return (\n      <Menu>\n        {actions.filter(a => !a.disabled).map(a => (\n          <Item\n            {...testable(\"action-item\")}\n            style={styles.item}\n            key={a.label}\n            onClick={() => {\n              if (a.onClick) a.onClick();\n              close();\n            }}\n          >\n            {a.label}\n          </Item>\n        ))}\n      </Menu>\n    );\n  };\n\n  render() {\n    const { label, disabled, actions, ...rest } = this.props;\n    return (\n      <span>\n        <PopoverMenu renderMenu={this.renderMenu}>\n          <Button disabled={disabled}>\n            <ButtonFace disabled={disabled} {...rest}>\n              <Label>{label}</Label>\n              <Icon.Down />\n            </ButtonFace>\n          </Button>\n        </PopoverMenu>\n      </span>\n    );\n  }\n}\n","import { Type, MapKeyValue } from \"../../../../typings\";\nimport React, { Component } from \"react\";\nimport { Field, FieldProps, getIn } from \"formik\";\nimport styled from \"styled-components/macro\";\nimport ActionButton from \"../../common/ActionButton\";\nimport api from \"../../api\";\nimport Fields from \"../../common/Fields\";\nimport inputs from \"./inputs\";\nimport { required } from \"./validation\";\n\nconst Action = styled(\"span\")`\n  margin-left: 1em;\n  opacity: 0;\n  cursor: pointer;\n  color: var(--accent-color);\n  :hover {\n    text-decoration: underline;\n  }\n  tr:hover & {\n    opacity: 1;\n  }\n  transition: opacity 0.5s;\n`;\n\ntype Props = FieldProps<any> & {\n  values: Type;\n  keys: {\n    values?: MapKeyValue[];\n    fetch: string;\n  };\n};\n\nexport default class MapInput extends Component<Props> {\n  static getDefaultValue(props: Props) {\n    return {};\n  }\n\n  static validate(value, props) {\n    const isRequired = required(value, props);\n    if (isRequired) return isRequired;\n  }\n  state = {\n    options: this.props.keys.values || []\n  };\n\n  componentDidMount() {\n    if (this.props.keys.fetch) {\n      api\n        .get(this.props.keys.fetch)\n        .then(fetched =>\n          this.setState({ options: [...this.state.options, ...fetched] })\n        );\n    }\n  }\n\n  add(key: string) {\n    const { form, field } = this.props;\n    form.setFieldValue(field.name, {\n      ...field.value,\n      [key]: null\n    });\n  }\n\n  remove(key: string) {\n    const { form, field } = this.props;\n    const value = { ...field.value };\n    delete value[key];\n    form.setFieldValue(field.name, value);\n  }\n\n  getValue(v: MapKeyValue) {\n    return typeof v === \"object\" ? v.value : v;\n  }\n\n  getLabel(v: MapKeyValue) {\n    return typeof v === \"object\" ? v.label : v;\n  }\n\n  render() {\n    const { field, values, form } = this.props;\n    const { options } = this.state;\n\n    if (!options) return null;\n    const component = inputs.get(values);\n    const prefix = field ? `${field.name}.` : \"\";\n    const { value } = field;\n\n    const existingKeys = options.filter(\n      k => value && this.getValue(k) in value\n    );\n    const remainingKeys = options.filter(\n      k => value && !(this.getValue(k) in value)\n    );\n\n    return (\n      <div>\n        <Fields\n          layout=\"horizontal\"\n          fields={existingKeys.map(key => {\n            const label = (\n              <div style={{ display: \"flex\" }}>\n                {this.getLabel(key)}\n                <Action onClick={() => this.remove(this.getValue(key))}>\n                  remove\n                </Action>\n              </div>\n            );\n            key = this.getValue(key);\n            const name = `${prefix}${key}`;\n            const error = getIn(form.errors, name);\n\n            const element = (\n              <Field\n                name={`${prefix}${key}`}\n                component={component}\n                {...values}\n              />\n            );\n            return {\n              key,\n              label,\n              element,\n              error\n            };\n          })}\n        />\n        <ActionButton\n          data-name={field.name}\n          label=\"Add …\"\n          disabled={!remainingKeys.length}\n          actions={remainingKeys.map(label => ({\n            label: this.getLabel(label),\n            onClick: () => {\n              this.add(this.getValue(label));\n            }\n          }))}\n        />\n      </div>\n    );\n  }\n}\n","import { matchMime } from \"../utils/helper\";\n\nexport type MediaFilter = {\n  mimeType?: string;\n  maxSize?: number;\n  minWidth?: number;\n  minHeight?: number;\n  maxWidth?: number;\n  maxHeight?: number;\n};\n\ntype GetElementType<T extends any[]> = T extends (infer U)[] ? U : never;\n\nfunction every<T extends any[]>(\n  thing: T,\n  cb: (value: GetElementType<T>, index: number, array: T[]) => boolean\n) {\n  return Array.prototype.every.call(thing, cb);\n}\n\nfunction map<T extends any[], U>(\n  thing: T,\n  cb: (value: any, index: number, array: any[]) => U\n) {\n  return Array.prototype.map.call(thing, cb);\n}\n\nexport default function createValidator(\n  mediaType?: string,\n  mediaFilter?: MediaFilter\n) {\n  return async (files: File[]): Promise<boolean> => {\n    let allowed = true;\n    if (mediaType && mediaType !== \"all\") {\n      allowed = allowed && every(files, file => file.type.includes(mediaType));\n    }\n    if (mediaFilter) {\n      if (mediaFilter.mimeType) {\n        allowed =\n          allowed &&\n          every(files, file => matchMime(file.type, mediaFilter.mimeType));\n      }\n      if (mediaFilter.maxSize) {\n        allowed =\n          allowed &&\n          every(\n            files,\n            file => mediaFilter && file.size < (mediaFilter as any).maxSize\n          );\n      }\n      if (\n        mediaFilter.minHeight ||\n        mediaFilter.minWidth ||\n        mediaFilter.maxWidth ||\n        mediaFilter.maxHeight\n      ) {\n        const checkedImageSizes = await Promise.all(\n          map(\n            files,\n            file =>\n              new Promise(resolve => {\n                const reader = new FileReader();\n                reader.readAsDataURL(file);\n                reader.onload = (e: any) => {\n                  const image = new Image();\n                  image.src = e.target.result;\n                  image.onload = () => {\n                    const height = image.naturalHeight;\n                    const width = image.naturalWidth;\n                    resolve(\n                      !(\n                        (mediaFilter.maxWidth &&\n                          mediaFilter.maxWidth < width) ||\n                        (mediaFilter.minWidth &&\n                          mediaFilter.minWidth > width) ||\n                        (mediaFilter.maxHeight &&\n                          mediaFilter.maxHeight < height) ||\n                        (mediaFilter.minHeight &&\n                          mediaFilter.minHeight > height)\n                      )\n                    );\n                  };\n                };\n              })\n          )\n        );\n        allowed = checkedImageSizes.reduce(\n          (acc, a) => acc && a,\n          allowed\n        ) as boolean;\n      }\n    }\n\n    return allowed;\n  };\n}\n","import React, { useMemo, useEffect } from \"react\";\nimport { useDropzone } from \"react-dropzone\";\nimport { useUpload } from \"react-use-upload\";\nimport createValidator, { MediaFilter } from \"./createValidator\";\nimport useValidation from \"./useValidation\";\n\nexport type Props = {\n  render: any;\n  onUpload: any;\n  className?: string;\n  activeClass: string;\n  multiple?: boolean;\n  mediaType?: string;\n  mediaFilter?: MediaFilter;\n};\n\nconst noop = () => {\n  /* noop */\n};\n\nexport default function UploadZone({\n  render,\n  onUpload,\n  className,\n  activeClass,\n  multiple,\n  mediaType,\n  mediaFilter\n}: Props) {\n  const validator = useMemo(() => createValidator(mediaType, mediaFilter), [\n    mediaType,\n    mediaFilter\n  ]);\n  const [files, onFiles, reset] = useValidation(validator);\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({\n    multiple,\n    noKeyboard: true,\n    noClick: true,\n    onDrop: onFiles\n  });\n  const { done, response, progress, error } = useUpload(files as any, {\n    path: \"/upload\",\n    name: \"file\",\n    withCredentials: true\n  });\n  useEffect(() => {\n    if (!done) return;\n    reset();\n    onUpload(response.response);\n  }, [done, response, onUpload, reset]);\n\n  return (\n    <div\n      {...getRootProps()}\n      onClick={\n        noop /* Even though we told dropzone to not care for clicks, it prevents default.\n                (https://github.com/react-dropzone/react-dropzone/blob/93bded79f01641aaf5c4d29642a881cdc0e77bcf/src/index.js#L461)\n                We need to overwrite in order to work with nested file inputs */\n      }\n      className={`${className} ${isDragActive ? activeClass : \"\"}`}\n    >\n      <input {...getInputProps()} />\n      {useMemo(\n        () =>\n          render({\n            ...response,\n            complete: done,\n            onFiles,\n            progress,\n            error,\n            files\n          }),\n        [render, progress, files, onFiles, done, response, error]\n      )}\n    </div>\n  );\n}\n","import { useState, useMemo } from \"react\";\n\nexport default function useValidation(\n  validator: (files: File[]) => Promise<boolean>\n): [File[] | undefined, (files: File[]) => void, () => void] {\n  const [fileState, setValidatedFiles] = useState<File[]>();\n  const setFiles = useMemo(\n    () => async (files: File[]) => {\n      if (await validator(files)) {\n        setValidatedFiles(files);\n      } else {\n        alert(\"File doesn't match requirements\");\n      }\n    },\n    [validator, setValidatedFiles]\n  );\n  const reset = useMemo(() => () => setValidatedFiles(undefined), [\n    setValidatedFiles\n  ]);\n\n  return [fileState, setFiles, reset];\n}\n","import React, { Component } from \"react\";\nimport styled, { css } from \"styled-components/macro\";\nimport Icon from \"../common/icons\";\nimport { testable } from \"../utils/helper\";\nimport { mediaBasePath } from \"../basePath\";\n\ntype P = {\n  onClick?: (ev: any) => void;\n  disabled?: boolean;\n};\nconst Tile = styled(\"div\")`\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 150px;\n  height: 150px;\n  background: #eee\n    url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"4\" height=\"4\" fill-opacity=\".05\" ><rect x=\"2\" width=\"2\" height=\"2\" /><rect y=\"2\" width=\"2\" height=\"2\" /></svg>');\n  background-size: 20px 20px;\n  box-shadow: 0 2px 3px rgba(0, 0, 0, 0.3);\n  ${(p: P) =>\n    p.onClick &&\n    css`\n      cursor: pointer;\n    `};\n  ${(p: P) =>\n    p.disabled &&\n    css`\n      opacity: 0.2;\n      cursor: not-allowed;\n    `};\n`;\n\nconst Caption = styled(\"div\")`\n  position: absolute;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  padding: 3px 8px;\n  background-color: rgba(0, 0, 0, 0.6);\n  color: #fff;\n  font-size: 11px;\n  overflow-wrap: break-word;\n`;\n\nconst ItemActions = styled(\"div\")`\n  position: absolute;\n  z-index: 1;\n  opacity: 0;\n  transition: opacity 0.2s;\n  div:hover > & {\n    opacity: 1;\n  }\n`;\n\nconst Action = styled(\"div\")`\n  background-color: #fff;\n  height: 30px;\n  width: 30px;\n  border-radius: 15px;\n  color: #000;\n  display: block;\n  margin: 0 auto;\n  display: inline-block;\n  position: relative;\n  margin: 4px;\n  box-shadow: 0 1px 6px rgba(0, 0, 0, 0.6);\n  cursor: pointer;\n  svg {\n    width: 100%;\n    height: 100%;\n    padding: 4px;\n    box-sizing: border-box;\n    path: {\n      fill: inherit;\n    }\n  }\n`;\n\nconst Doc = styled(\"div\")`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  margin-bottom: 10px;\n  text-transform: uppercase;\n`;\n\ntype Props = {\n  id: string;\n  originalname: string;\n  width: number | \"auto\" | null;\n  height: number | \"auto\" | null;\n  editable?: boolean;\n  disabled?: boolean;\n  onSelect?: (ev: any) => void;\n  onDelete?: (ev: any) => void;\n  style?: any;\n};\n\nexport default class Image extends Component<Props> {\n  render() {\n    const {\n      style,\n      onSelect,\n      originalname,\n      width,\n      editable,\n      onDelete,\n      disabled\n    } = this.props;\n\n    return (\n      <div>\n        <Tile\n          style={style}\n          onClick={!editable && !disabled ? onSelect : undefined}\n          disabled={disabled}\n          {...testable(\"media-tile\")}\n        >\n          {!disabled && editable && (\n            <ItemActions {...testable(\"media-tile-actions\")}>\n              {onSelect && (\n                <Action onClick={onSelect} {...testable(\"media-details\")}>\n                  <Icon.Details />\n                </Action>\n              )}\n              {onDelete && (\n                <Action\n                  onClick={onDelete}\n                  style={{ backgroundColor: \"#ff5e49\", color: \"#fff\" }}\n                  {...testable(\"media-delete\")}\n                >\n                  <Icon.Trash />\n                </Action>\n              )}\n            </ItemActions>\n          )}\n          {width ? this.renderImage() : this.renderIcon()}\n          <Caption {...testable(\"media-caption\")}>{originalname}</Caption>\n        </Tile>\n      </div>\n    );\n  }\n\n  renderImage() {\n    const { id } = this.props;\n    return (\n      <img\n        style={{ objectFit: \"contain\" }}\n        src={id.includes(\"://\") ? id : `${mediaBasePath}/thumbs/square/${id}`}\n        alt={\"\"}\n        width=\"150\"\n        height=\"150\"\n        {...testable(\"media-preview\")}\n      />\n    );\n  }\n\n  renderIcon() {\n    const { originalname } = this.props;\n    const ext = originalname && originalname.replace(/.*\\./, \"\");\n    return (\n      <Doc>\n        <Icon.Document width={48} height={48} {...testable(\"media-preview\")} />\n        {ext}\n      </Doc>\n    );\n  }\n}\n","import React, { Component } from \"react\";\n\nimport {\n  CellMeasurer,\n  CellMeasurerCache\n} from \"react-virtualized/dist/es/CellMeasurer\";\n\nimport {\n  Masonry,\n  MasonryCellProps,\n  createCellPositioner\n} from \"react-virtualized/dist/es/Masonry\";\n\nimport { AutoSizer } from \"react-virtualized/dist/es/AutoSizer\";\n\nimport Image from \"./Image\";\nimport { matchMime } from \"../utils/helper\";\n\nconst columnWidth = 150;\nconst spacer = 20;\n\ntype Props = {\n  count: number;\n  data;\n  onSelect;\n  editable;\n  onDelete;\n  onRowsRendered: (a) => void;\n  mediaFilter?: {\n    mimeType?: string;\n    maxSize?: number;\n    minWidth?: number;\n    minHeight?: number;\n    maxWidth?: number;\n    maxHeight?: number;\n  };\n};\nexport default class Gallery extends Component<Props> {\n  // Default sizes help Masonry decide how many images to batch-measure\n  cache = new CellMeasurerCache({\n    defaultHeight: columnWidth,\n    defaultWidth: columnWidth,\n    fixedWidth: true\n  });\n\n  masonry: Masonry | undefined;\n  columnCount: number = 1;\n  width: number = 200;\n\n  cellPositioner = createCellPositioner({\n    cellMeasurerCache: this.cache,\n    columnCount: this.columnCount,\n    columnWidth,\n    spacer\n  });\n\n  cellRenderer = ({ index, key, parent, style }: MasonryCellProps) => {\n    const { data, onSelect, editable, onDelete, mediaFilter } = this.props;\n    const media = data[index];\n    if (!media) return null;\n    const disabledMedia =\n      mediaFilter &&\n      ((mediaFilter.mimeType &&\n        !matchMime(media.mimetype, mediaFilter.mimeType)) ||\n        (mediaFilter.maxSize && mediaFilter.maxSize < media.size) ||\n        (mediaFilter.maxWidth && mediaFilter.maxWidth < media.width) ||\n        (mediaFilter.minWidth && mediaFilter.minWidth > media.width) ||\n        (mediaFilter.maxHeight && mediaFilter.maxHeight < media.height) ||\n        (mediaFilter.minHeight && mediaFilter.minHeight > media.height));\n    return (\n      <CellMeasurer\n        cache={this.cache}\n        index={index}\n        key={media.id}\n        parent={parent}\n      >\n        <Image\n          style={style}\n          {...media}\n          onSelect={() => onSelect([media])}\n          onDelete={() => onDelete(media)}\n          editable={editable && !disabledMedia}\n          disabled={disabledMedia}\n        />\n      </CellMeasurer>\n    );\n  };\n\n  setMasonryRef = ref => {\n    this.masonry = ref;\n  };\n\n  onResize = ({ width }) => {\n    this.width = width;\n    this.calculateColumnCount();\n    this.resetCellPositioner();\n    if (this.masonry) this.masonry.recomputeCellPositions();\n  };\n\n  calculateColumnCount() {\n    this.columnCount = Math.floor(this.width / (columnWidth + spacer));\n  }\n\n  resetCellPositioner() {\n    this.cellPositioner.reset({\n      columnCount: this.columnCount,\n      columnWidth,\n      spacer\n    });\n  }\n\n  renderMasonry = size => {\n    const { count, onRowsRendered } = this.props;\n    this.calculateColumnCount();\n    return (\n      <Masonry\n        ref={this.setMasonryRef}\n        cellCount={Number(count)}\n        cellMeasurerCache={this.cache}\n        cellPositioner={this.cellPositioner}\n        cellRenderer={this.cellRenderer}\n        autoHeight={false}\n        height={size.height}\n        width={size.width}\n        style={{ outline: \"none\", padding: \"20px\" }}\n        overscanByPixels={1000}\n        onCellsRendered={onRowsRendered}\n      />\n    );\n  };\n\n  render() {\n    const { data } = this.props;\n    if (!data) return null;\n    return (\n      <AutoSizer onResize={this.onResize} data={data}>\n        {this.renderMasonry}\n      </AutoSizer>\n    );\n  }\n}\n","import { Media } from \"../../../../typings\";\nimport React, { Component } from \"react\";\nimport Draggable from \"react-draggable\";\nimport Icon, { paths } from \"../../common/icons\";\nimport styled from \"styled-components/macro\";\nimport Button from \"../../common/Button\";\nimport { mediaBasePath } from \"../../basePath\";\n\nconst DEFAULT_PREVIEW_PATH = \"/thumbs/preview/\";\n\nconst Root = styled(\"div\")`\n  max-width: 100%;\n  max-height: 100%;\n  width: 100%;\n  height: 100%;\n  background-color: #f5f5f5;\n  border-radius: 4px;\n`;\ntype EditBackground = {\n  inEdit?: boolean;\n};\n\nconst EditBackground = styled(\"div\")`\n  height: 100vh;\n  width: 100vw;\n  position: fixed;\n  background-color: rgba(0, 0, 0, 0.65);\n  top: 0;\n  left: 0;\n  right: 0;\n  z-index: 20;\n  display: ${(p: EditRoot) => (p.inEdit ? \"block\" : \"none\")};\n  opacity: ${(p: EditRoot) => (p.inEdit ? 1 : 0)};\n  transition: all 0.3s ease;\n`;\n\ntype ActionsBar = {\n  bottom?: boolean;\n};\nconst ActionsBar = styled(\"div\")`\n  position: absolute;\n  top: ${({ bottom }: ActionsBar) => (bottom ? \"100%\" : 0)};\n  right: ${({ bottom }: ActionsBar) => bottom && 0};\n  left: ${({ bottom }: ActionsBar) => !bottom && \"100%\"};\n  background: rgba(255, 255, 255, 0.8);\n  border-radius: 4px;\n  box-sizing: border-box;\n  white-space: nowrap;\n`;\n\ntype EditRoot = {\n  inEdit?: boolean;\n};\n\nconst EditRoot = styled(\"div\")`\n  z-index: ${(p: EditRoot) => p.inEdit && 21};\n  position: relative;\n  max-width: 100%;\n  max-height: 100%;\n  height: 100%;\n`;\n\ntype TargetWrapper = {\n  width: number;\n  height: number;\n};\nconst TargetWrapper = styled(\"div\")`\n  max-height: 100%;\n  max-width: 100%;\n  width: ${({ width, height }: TargetWrapper) =>\n    width > height && `${width}px`};\n  height: ${({ width, height }: TargetWrapper) =>\n    width < height && `${height}px`};\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translateX(-50%) translateY(-50%);\n`;\n\ntype FocusTarget = {\n  inEdit: boolean;\n};\nconst FocusTarget = styled(\"div\")`\n  position: absolute;\n  top: 0px;\n  left: 0ox;\n  display: flex;\n  cursor: ${(p: FocusTarget) => p.inEdit && \"move\"};\n  & > svg {\n    color: #fff;\n    filter: drop-shadow(0 3px 3px rgba(0, 0, 0, 0.6));\n    margin: -2px;\n  }\n`;\n\nconst MoreIcon = styled(Icon.More)`\n  position: absolute;\n  top: 7px;\n  right: 7px;\n  z-index: 1;\n  color: var(--dark-color);\n  background: rgba(255, 255, 255, 0.8);\n  border-radius: 100%;\n  margin: 0 0 0 4px;\n  box-shadow: 0 2px 3px rgba(0, 0, 0, 0.15);\n  cursor: pointer;\n`;\n\nconst Img = styled(\"img\")`\n  border-radius: 3px;\n  max-height: 100%;\n  max-width: 100%;\n  object-fit: contain;\n  user-select: none;\n`;\n\ntype Props = {\n  initialX?: number;\n  initialY?: number;\n  data: Media;\n  onPosistionChange: (x: number, y: number) => void;\n};\ntype State = {\n  positionX?: number;\n  positionY?: number;\n  ratio?: number;\n  inEdit: boolean;\n  displayWidth?: number;\n  displayHeight?: number;\n};\n\nexport default class ImageFocus extends Component<Props, State> {\n  state: State = {\n    inEdit: false\n  };\n\n  focusTarget: React.RefObject<any>;\n\n  constructor(props) {\n    super(props);\n    this.focusTarget = React.createRef();\n  }\n\n  componentDidMount() {\n    window.addEventListener(\"resize\", this.getDimensions);\n    setTimeout(() => {\n      this.getDimensions();\n    }, 100);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"resize\", this.getDimensions);\n  }\n\n  getDimensions = () => {\n    const { data, initialX, initialY } = this.props;\n\n    const displayWidth = this.focusTarget.current.clientWidth;\n    const displayHeight = this.focusTarget.current.clientHeight;\n    const ratio = displayWidth / data.width!;\n    const positionX: number =\n      initialX === undefined ? displayWidth / 2 : initialX * ratio;\n    const positionY: number =\n      initialY === undefined ? displayHeight / 2 : initialY * ratio;\n\n    this.setState({ positionX, positionY, ratio, displayWidth, displayHeight });\n  };\n\n  onDragStop = (e, data: { x: number; y: number }) => {\n    const { x, y } = data;\n    this.setState({ positionX: x, positionY: y });\n  };\n\n  onSave = () => {\n    const { ratio = 1, positionX = 0, positionY = 0 } = this.state;\n\n    this.props.onPosistionChange(positionX / ratio, positionY / ratio);\n    this.setState({ inEdit: false });\n  };\n\n  onCancel = () => {\n    const { initialX, initialY } = this.props;\n    const { ratio = 1 } = this.state;\n\n    if (initialX && initialY) {\n      this.setState({\n        positionX: initialX * ratio,\n        positionY: initialY * ratio\n      });\n    } else {\n      this.getDimensions();\n    }\n    this.setState({ inEdit: false });\n  };\n\n  render() {\n    const { positionX, positionY, inEdit, ratio, displayHeight } = this.state;\n    const {\n      data: { width, height, id }\n    } = this.props;\n    return (\n      <Root>\n        <EditRoot inEdit={inEdit}>\n          {!inEdit && (\n            <MoreIcon\n              onClick={() => {\n                if (!this.state.ratio) this.getDimensions();\n                this.setState({ inEdit: true });\n              }}\n            />\n          )}\n          <TargetWrapper width={width!} height={height!}>\n            {inEdit && (\n              <ActionsBar\n                bottom={\n                  displayHeight !== undefined &&\n                  (displayHeight >= height! || height! < width!)\n                }\n              >\n                <Button icon={paths.Save} onClick={this.onSave} light>\n                  Ok\n                </Button>\n                <Button icon={paths.Clear} onClick={this.onCancel} light>\n                  Cancel\n                </Button>\n              </ActionsBar>\n            )}\n            <Img\n              src={`${mediaBasePath}${DEFAULT_PREVIEW_PATH}${id}`}\n              ref={this.focusTarget}\n              style={{\n                width: width! > height! ? width! : \"unset\",\n                height: width! < height! ? height! : \"unset\"\n              }}\n              alt=\"\"\n            />\n            <Draggable\n              bounds=\"img\"\n              onStop={this.onDragStop}\n              position={\n                positionX && positionY\n                  ? { x: positionX, y: positionY }\n                  : undefined\n              }\n              disabled={!inEdit}\n            >\n              {ratio ? (\n                <FocusTarget inEdit={inEdit}>\n                  <Icon.Focus />\n                </FocusTarget>\n              ) : (\n                <div />\n              )}\n            </Draggable>\n          </TargetWrapper>\n        </EditRoot>\n        <EditBackground\n          inEdit={inEdit}\n          onClick={() => this.setState({ inEdit: false })}\n        />\n      </Root>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport styled from \"styled-components/macro\";\nimport ColorHash from \"color-hash\";\nimport { Input } from \"./styles\";\nimport Button from \"./Button\";\nimport Icon, { paths } from \"./icons\";\nimport { testable } from \"../utils/helper\";\n\nconst colorHash = new ColorHash({ saturation: 0.7, lightness: 0.6 });\n\nexport const Item = styled(\"div\")`\n  box-sizing: border-box;\n  color: \"#fff\";\n  border: none;\n  min-height: var(--input-min-height);\n  outline: none;\n  padding: 5px;\n  display: inline-flex;\n  transition: background-color 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,\n    box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;\n  white-space: nowrap;\n  align-items: center;\n  border-radius: 4px;\n  vertical-align: middle;\n  text-decoration: none;\n  justify-content: center;\n  /* background-color: var(--transparent-grey); */\n  margin: 0 10px 10px 0;\n  /* border-left: 5px solid var(--primary-color); */\n`;\n\nconst StyledButton = styled(\"button\")`\n  padding: 0;\n  border: none;\n  background: none;\n  cursor: pointer;\n  :focus {\n    outline: 0;\n  }\n`;\nconst Root = styled(\"div\")`\n  margin: 10px 0;\n`;\nconst Form = styled(\"form\")`\n  display: flex;\n  width: 100%;\n`;\n\nconst ClearCircleIcon = styled(Icon.ClearCircle)`\n  color: rgba(255, 255, 255, 0.8);\n  margin: 0 0 0 4px;\n`;\n\ntype Props = {\n  values?: string[];\n  onAdd: (value: string) => void;\n  onDelete: (index: number) => void;\n};\n\ntype State = {\n  newValue: string;\n};\n\nexport default class ChipList extends Component<Props, State> {\n  state: State = {\n    newValue: \"\"\n  };\n\n  onAdd = () => {\n    const { newValue } = this.state;\n    this.props.onAdd(newValue);\n    this.setState({ newValue: \"\" });\n  };\n  render() {\n    const { values, onDelete } = this.props;\n    const { newValue } = this.state;\n    return (\n      <Root>\n        {values &&\n          values.map((v, index) => (\n            <Item key={index} style={{ background: colorHash.hex(String(v)) }}>\n              {v}\n              <StyledButton type=\"button\" onClick={() => onDelete(index)}>\n                <ClearCircleIcon />\n              </StyledButton>\n            </Item>\n          ))}\n        <Form\n          onSubmit={e => {\n            e.preventDefault();\n            this.onAdd();\n          }}\n        >\n          <Input\n            {...testable(\"chip-list-input\")}\n            value={newValue}\n            onChange={e => this.setState({ newValue: e.target.value })}\n          />\n          <Button icon={paths.Plus} light type=\"submit\">\n            Add\n          </Button>\n        </Form>\n      </Root>\n    );\n  }\n}\n","import * as Cotype from \"../../../../typings\";\nimport React, { Component } from \"react\";\nimport styled from \"styled-components/macro\";\nimport TimeAgo from \"react-time-ago\";\nimport { formatBytes, testable } from \"../../utils/helper\";\nimport ModalDialog from \"../../common/ModalDialog\";\nimport { Cols, Content, Outset } from \"../../common/page\";\nimport FocusPoint from \"./FocusPoint\";\nimport Button from \"../../common/Button\";\nimport { paths } from \"../../common/icons\";\nimport ChipList from \"../../common/ChipList\";\nimport api from \"../../api\";\nimport { mediaBasePath } from \"../../basePath\";\nimport { Input } from \"../../common/styles\";\n\nconst MetaInput = styled(\"div\")`\n  margin-bottom: 10px;\n`;\nconst MetaData = styled(\"div\")`\n  background-color: #f5f5f5;\n  border-radius: 4px;\n  padding: 24px;\n  padding: 1.5rem;\n`;\nconst Grid = styled(\"div\")`\n  list-style: none;\n  margin-right: 0;\n  margin-left: -24px;\n  padding-left: 0;\n  padding-right: 0;\n  letter-spacing: -1000em;\n  display: flex;\n  flex-wrap: wrap;\n`;\nconst FlexRow = styled(\"div\")`\n  display: flex;\n  width: 100%;\n`;\nconst Meta = styled(\"div\")`\n  display: inline-block;\n  padding-left: 24px;\n  vertical-align: top;\n  box-sizing: border-box;\n  letter-spacing: 0;\n  width: 100%;\n  margin-bottom: 1.5rem;\n`;\nconst MetaItemLabel = styled(\"div\")`\n  text-transform: uppercase;\n  color: #848484;\n  font-weight: 500;\n  font-size: 14px;\n  font-size: 0.875rem;\n  margin-bottom: 0.5em;\n`;\nconst MetaItemValue = styled(\"div\")`\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n`;\n\nconst MetaItem = ({\n  label,\n  value,\n  noMargin\n}: {\n  label: string;\n  value: string | React.ReactNode;\n  noMargin?: boolean;\n}) => {\n  return (\n    <Meta style={noMargin ? { marginBottom: 0 } : {}}>\n      <MetaItemLabel>{label}</MetaItemLabel>\n      <MetaItemValue>{value}</MetaItemValue>\n    </Meta>\n  );\n};\n\nconst modalStyle = {\n  width: \"90vw\",\n  maxWidth: 1200,\n  height: \"80vmin\",\n  maxHeight: 800\n};\n\ntype Props = {\n  onClose: () => void;\n  fetchMediaItem: (media: Cotype.Media) => void;\n  data: Cotype.Media[];\n};\n\ntype State = {\n  x: number | null;\n  y: number | null;\n  tags: string[];\n  alt: string | null;\n  credit: string | null;\n  originalname: string | null;\n};\nexport default class Details extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    const [\n      { focusX, focusY, tags, credit, alt, originalname }\n    ] = this.props.data;\n    const n = originalname.split(\".\");\n    n.pop();\n    const nameWithoutExt = n.join(\".\");\n    this.state = {\n      x: focusX,\n      y: focusY,\n      tags: tags ? tags : [],\n      alt,\n      credit,\n      originalname: nameWithoutExt\n    };\n  }\n\n  onFocusChange = (x: number, y: number) => {\n    this.setState({ x, y });\n  };\n\n  onSave = () => {\n    const { x, y, tags, credit, alt, originalname } = this.state;\n    const [media] = this.props.data;\n    const n = this.props.data[0].originalname.split(\".\");\n    const ext = n.pop();\n    api\n      .updateMedia(media.id, {\n        focusX: x,\n        focusY: y,\n        tags,\n        credit,\n        alt,\n        originalname: originalname + \".\" + ext\n      })\n      .then(() => {\n        this.props.fetchMediaItem(media);\n      });\n\n    this.props.onClose();\n  };\n\n  onAddTag = (tag: string) => {\n    const { tags } = this.state;\n    tags.push(tag);\n    this.setState({ tags });\n  };\n\n  onDeleteTag = (index: number) => {\n    const { tags } = this.state;\n    tags.splice(index, 1);\n    this.setState({ tags });\n  };\n  render() {\n    const { onClose, data } = this.props;\n\n    const { x, y, tags, credit, alt, originalname } = this.state;\n    if (!data) return null;\n\n    const [media] = this.props.data;\n\n    const {\n      imagetype,\n      created_at,\n      size,\n      width,\n      height,\n      focusX,\n      focusY,\n      id\n    } = media;\n\n    const actions = [\n      <Button icon={paths.Save} onClick={this.onSave}>\n        Save\n      </Button>,\n      <Button icon={paths.Clear} onClick={onClose} light>\n        Cancel\n      </Button>\n    ];\n\n    const hasPreview = !![\"png\", \"jpg\", \"svg\"].find(t => t === imagetype);\n\n    return (\n      <ModalDialog\n        onClose={onClose}\n        title=\"Details\"\n        actionButtons={actions}\n        style={modalStyle}\n        bodyStyle={{ padding: 0 }}\n      >\n        <Cols style={{ height: \"100%\" }}>\n          {hasPreview && (\n            <Content>\n              <FocusPoint\n                data={media}\n                onPosistionChange={this.onFocusChange}\n                initialX={x ? x : focusX ? focusX : undefined}\n                initialY={y ? y : focusY ? focusY : undefined}\n              />\n            </Content>\n          )}\n          <Content style={{ overflowY: \"scroll\" }}>\n            <Outset style={!hasPreview ? { marginLeft: 0 } : undefined}>\n              <MetaData>\n                <MetaInput>\n                  <MetaItemLabel>Alt</MetaItemLabel>\n                  <Input\n                    {...testable(\"meta-data-alt\")}\n                    value={alt || \"\"}\n                    onChange={e => this.setState({ alt: e.target.value })}\n                  />\n                </MetaInput>\n                <MetaInput>\n                  <MetaItemLabel>File Name</MetaItemLabel>\n                  <Input\n                    {...testable(\"meta-data-originalname\")}\n                    value={originalname || \"\"}\n                    onChange={e =>\n                      this.setState({ originalname: e.target.value })\n                    }\n                  />\n                </MetaInput>\n                <MetaInput>\n                  <MetaItemLabel>Credit</MetaItemLabel>\n                  <Input\n                    value={credit || \"\"}\n                    onChange={e => this.setState({ credit: e.target.value })}\n                  />\n                </MetaInput>\n                <MetaInput>\n                  <MetaItemLabel>URL</MetaItemLabel>\n                  <FlexRow>\n                    <Input\n                      value={\n                        window.location.origin + mediaBasePath + \"/media/\" + id\n                      }\n                      readOnly\n                    />\n                    <Button\n                      icon={paths.OpenInTab}\n                      light\n                      href={mediaBasePath + \"/media/\" + id}\n                      target=\"_blank\"\n                      asLink\n                      title=\"open in new tab\"\n                    >\n                      open\n                    </Button>\n                  </FlexRow>\n                </MetaInput>\n                <MetaItemLabel>Tags</MetaItemLabel>\n                <ChipList\n                  onAdd={this.onAddTag}\n                  onDelete={this.onDeleteTag}\n                  values={tags}\n                />\n              </MetaData>\n              <MetaData style={{ marginTop: \"1em\" }}>\n                <Grid>\n                  <MetaItem label=\"File type\" value={imagetype} />\n                  <MetaItem label=\"File size\" value={formatBytes(size)} />\n                  <MetaItem\n                    label=\"Upload date\"\n                    value={<TimeAgo date={new Date(created_at)} />}\n                  />\n                  {width && (\n                    <MetaItem\n                      label=\"Dimensions\"\n                      value={`${width}x${height}px`}\n                      noMargin\n                    />\n                  )}\n                </Grid>\n              </MetaData>\n            </Outset>\n          </Content>\n        </Cols>\n      </ModalDialog>\n    );\n  }\n}\n","import React, { ReactNode, InputHTMLAttributes } from \"react\";\nimport styled from \"styled-components/macro\";\n\nconst FileInput = styled(\"input\")`\n  top: 0;\n  right: 0;\n  opacity: 0;\n  width: 100%;\n  height: 100%;\n  cursor: pointer;\n  position: absolute;\n`;\n\nconst Container = styled(\"div\")`\n  overflow: hidden;\n  position: relative;\n`;\n\ntype Props = InputHTMLAttributes<HTMLInputElement> & {\n  onFiles: (files: FileList) => void;\n  children: ReactNode;\n};\n\nexport default function UploadField({ onFiles, children, ...rest }: Props) {\n  return (\n    <Container>\n      {children}\n      <FileInput\n        {...rest}\n        type=\"file\"\n        onChange={e => {\n          if (!e.target.files) {\n            return;\n          }\n          onFiles(e.target.files);\n        }}\n      />\n    </Container>\n  );\n}\n","import React, { useState, useEffect } from \"react\";\nimport styled from \"styled-components/macro\";\nimport ButtonImport from \"../common/Button\";\nimport Icon from \"../common/icons\";\nimport MoreButton from \"../common/MoreButton\";\nimport UploadField from \"./UploadField\";\nimport { useUpload } from \"react-use-upload\";\n\nconst Root = styled(\"div\")`\n  padding: 0 20px;\n  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.08);\n  position: relative;\n  background-color: #fff;\n  z-index: 1;\n  display: flex;\n  align-items: stretch;\n`;\nconst Filters = styled(\"div\")`\n  padding-right: 20px;\n  border-right: 1px solid #f0f0f0;\n  display: flex;\n  align-items: stretch;\n`;\n\nconst IconBox = styled(\"div\")`\n  padding-left: 20px;\n  padding-right: 20px;\n  border-right: 1px solid #f0f0f0;\n  display: flex;\n  align-items: center;\n  font-size: 15px;\n  font-size: 0.9375rem;\n  color: var(--dark-grey);\n  & button {\n    padding: 0;\n  }\n`;\n\nconst Search = styled(\"div\")`\n  position: relative;\n  display: flex;\n  align-items: center;\n  padding-left: 20px;\n  flex: 1;\n  & > svg {\n    color: var(--disabled-color);\n  }\n`;\n\nconst SearchInput = styled(\"input\")`\n  border: 0;\n  padding-left: 40px;\n  background-color: transparent;\n  display: block;\n  box-sizing: border-box;\n  width: 100%;\n  padding: 10px;\n  border-radius: 0;\n  background-image: none;\n  transition: border 0.2s cubic-bezier(0.55, 0, 0.1, 1);\n  font-size: 15px;\n  font-size: 0.9375rem;\n  :focus {\n    outline: 0;\n  }\n`;\nconst Add = styled(\"div\")`\n  display: flex;\n  align-items: stretch;\n  padding-left: 20px;\n  & > div {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n`;\n\ntype P = {\n  active?: boolean;\n};\nconst Button = styled(ButtonImport)`\n  color: var(--dark-color);\n  -webkit-appearance: none;\n  background-color: transparent;\n  padding: 17px 20px 13px;\n  border-width: 0;\n  border-bottom: 4px solid transparent;\n  border-radius: 0;\n  border-bottom-color: ${(p: P) => p.active && \"var(--accent-color)\"};\n  :hover {\n    color: #fff;\n  }\n`;\n\nconst UploadButton = styled(ButtonImport)`\n  -webkit-appearance: none;\n  border-width: 0;\n  :hover {\n    color: #fff;\n  }\n  color: #fff;\n  background: var(--accent-color);\n  padding: 0.7em 1em;\n  border-radius: 3px;\n  border-bottom: 0px;\n`;\n\ntype OrderButton = {\n  ascending?: boolean;\n};\nconst OrderButton = styled(\"div\")`\n  padding-left: 20px;\n  padding-right: 20px;\n  height: 24px;\n  cursor: pointer;\n  & > svg {\n    color: var(--dark-grey);\n    transform: ${({ ascending }: OrderButton) => ascending && \"rotate(180deg)\"};\n  }\n`;\n\nexport type Props = {\n  onFilterChange: (filter: string) => void;\n  onSearch: (query: string) => void;\n  filters: ({ label: string; value: string })[];\n  orderBys: ({ label: string; value: string })[];\n  onOrderByChange: (orderBy: string) => void;\n  onOrderChange: (order: string) => void;\n  onUnUsedChange: (unUsed: boolean) => void;\n  onUsedChange: (used: boolean) => void;\n  onUpload: any;\n  onUploadProgress: (progress: number) => void;\n};\n\nexport default function Topbar(props: Props) {\n  const [filter, setFilter] = useState(props.filters[0].label);\n  const [unUsed, setUnUsed] = useState(false);\n  const [used, setUsed] = useState(false);\n  const [orderBy, setOrderBy] = useState(\"Date\");\n  const [descending, setDescending] = useState(true);\n  const [uploadFieldKey, setUploadFieldKey] = useState(0);\n  const [files, setFiles] = useState<FileList>();\n  const { onUpload, onUploadProgress } = props;\n  const { done, response, progress } = useUpload(files as any, {\n    path: \"/upload\",\n    name: \"file\",\n    withCredentials: true\n  });\n\n  useEffect(() => {\n    if (!progress) return;\n    onUploadProgress(progress || 0);\n  }, [progress, onUploadProgress]);\n\n  useEffect(() => {\n    if (!done) return;\n    onUpload(response.response);\n  }, [done, response, onUpload]);\n\n  const {\n    filters,\n    onFilterChange,\n    onSearch,\n    orderBys,\n    onOrderByChange,\n    onOrderChange,\n    onUnUsedChange,\n    onUsedChange\n  } = props;\n\n  return (\n    <Root>\n      <Filters>\n        {filters &&\n          filters.map((f, idx) => (\n            <Button\n              active={f.label === filter}\n              key={idx}\n              onClick={() => {\n                setFilter(f.label);\n                onFilterChange(f.value);\n              }}\n            >\n              {f.label}\n            </Button>\n          ))}\n      </Filters>\n      <IconBox>\n        <MoreButton\n          actions={orderBys.map(o => ({\n            label: \"Orderd by: \" + o.label,\n            active: orderBy === o.label,\n            onClick: () => {\n              setOrderBy(o.label);\n              onOrderByChange(o.value);\n            }\n          }))}\n          icon={<Icon.SortAlphabetical />}\n        />\n        <OrderButton\n          ascending={!descending}\n          onClick={() => {\n            onOrderChange(!descending ? \"desc\" : \"asc\");\n            setDescending(!descending);\n          }}\n        >\n          <Icon.Descending />\n        </OrderButton>\n        <MoreButton\n          actions={[\n            {\n              label: \"Show all documents\",\n              onClick: () => {\n                onUnUsedChange(false);\n                setUnUsed(false);\n                onUsedChange(false);\n                setUsed(false);\n              },\n              active: !unUsed && !used\n            },\n            {\n              label: \"Show unused documents\",\n              onClick: () => {\n                onUnUsedChange(true);\n                setUnUsed(true);\n                onUsedChange(false);\n                setUsed(false);\n              },\n              active: unUsed\n            },\n            {\n              label: \"Show used documents\",\n              onClick: () => {\n                onUsedChange(true);\n                setUsed(true);\n                onUnUsedChange(false);\n                setUnUsed(false);\n              },\n              active: used\n            }\n          ]}\n          icon={(unUsed || used) ? <Icon.FilterRemove /> : <Icon.Filter />}\n        />\n      </IconBox>\n      <Search>\n        <Icon.Search />\n        <SearchInput\n          onChange={e => {\n            onSearch(e.target.value);\n          }}\n          placeholder=\"Filter results...\"\n        />\n      </Search>\n      <div style={{ flex: 1 }} />\n      <Add>\n        <UploadField\n          key={uploadFieldKey}\n          onFiles={e => {\n            setFiles(e);\n            // set new key in order to render new input field, otherwise\n            // onFiles is not called when trying to upload the same file twice\n            setUploadFieldKey(Date.now());\n          }}\n          multiple\n        >\n          <UploadButton>Upload New</UploadButton>\n        </UploadField>\n      </Add>\n    </Root>\n  );\n}\n","import * as Cotype from \"../../../typings\";\nimport React, { Component } from \"react\";\nimport styled from \"styled-components/macro\";\nimport { RenderInfo } from \"../common/ScrollList\";\nimport api from \"../api\";\nimport UploadZone from \"./UploadZone\";\nimport Gallery from \"./Gallery\";\nimport Details from \"./Details\";\nimport ConflictDialog from \"../common/ConflictDialog\";\nimport Topbar from \"./Topbar\";\nimport { MediaType } from \"../../../typings\";\nimport ModalDialog from \"../common/ModalDialog\";\nimport { testable } from \"../utils/helper\";\n\nconst Root = styled(\"div\")`\n  height: 100%;\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n`;\nconst DuplicateDialog = styled(\"div\")`\n  width: 50vw;\n  height: 50vh;\n  max-height: 50vw;\n`;\n\nconst Main = styled(\"div\")`\n  flex: 1;\n  user-select: none;\n`;\n\nconst ACTIVE_CLASS = \"activeClass-UploadZone\";\nconst StyledUploadZone = styled(UploadZone)`\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  &.${ACTIVE_CLASS} {\n    background: var(--light-color);\n  }\n`;\n\nconst FilterTypes = [\n  { label: \"All\", value: \"all\" },\n  { label: \"Images\", value: \"image/\" },\n  { label: \"Videos\", value: \"video/\" },\n  { label: \"PDF\", value: \"application/pdf\" }\n];\n\nconst OrderByTypes = [\n  { label: \"Date\", value: \"created_at\" },\n  { label: \"Size\", value: \"size\" },\n  { label: \"Name\", value: \"originalname\" }\n];\n\ntype State = {\n  items: Cotype.Media[];\n  details: object | any;\n  total: number;\n  lastRequestedIndex: number;\n  editable: boolean;\n  conflictingItems: object[] | any;\n  duplicates: Cotype.MediaType[] | null;\n  fileType?: string;\n  orderBy?: string;\n  order?: string;\n  search?: string;\n  filters: ({ label: string; value: string })[];\n  topbarProgress: number | undefined;\n  unUsed: boolean;\n  used: boolean;\n};\ntype Props = {\n  model?: object;\n  onSelect?: (ev: any) => void;\n  openFromInput?: boolean;\n  mediaType?: string;\n  mediaFilter?: {\n    mimeType?: string;\n    maxSize?: number;\n    minWidth?: number;\n    minHeight?: number;\n    maxWidth?: number;\n    maxHeight?: number;\n  };\n};\n\nexport default class Media extends Component<Props, State> {\n  state: State = {\n    total: 0,\n    items: [],\n    lastRequestedIndex: 0,\n    details: null,\n    conflictingItems: null,\n    duplicates: null,\n    editable: false,\n    orderBy: \"created_at\",\n    order: \"desc\",\n    filters: FilterTypes,\n    topbarProgress: undefined,\n    unUsed: false,\n    used: false\n  };\n\n  constructor(props: Props) {\n    super(props);\n    if (!props.onSelect) {\n      this.state.editable = true;\n    }\n    if (\n      props.mediaType &&\n      typeof props.mediaType === \"string\" &&\n      props.mediaType !== \"all\"\n    ) {\n      this.state.filters = this.state.filters.filter(el =>\n        el.value.includes(props.mediaType as string)\n      );\n      if (this.state.filters.length > 0) {\n        this.state.fileType = this.state.filters[0].value;\n      }\n    }\n  }\n\n  componentDidMount() {\n    this.fetchNextData();\n  }\n\n  fetchNextData = () => {\n    this.fetchData(this.state.lastRequestedIndex, 100);\n  };\n\n  fetchData = (offset: number, limit = 100) => {\n    const { fileType, order, orderBy, search, items, unUsed, used } = this.state;\n\n    this.setState({ lastRequestedIndex: offset + limit });\n\n    const query = {\n      mimetype: fileType,\n      order,\n      orderBy,\n      search,\n      offset,\n      limit,\n      unUsed: unUsed ? true : undefined,\n      used: used ? true : undefined\n    };\n    api.listMedia(query).then(res =>\n      this.setState({\n        total: res.total,\n        items: items.slice(0, offset).concat(res.items)\n      })\n    );\n  };\n\n  onRowsRendered = ({ stopIndex }: RenderInfo) => {\n    // Lazy-load next batch of items\n    if (stopIndex >= this.state.lastRequestedIndex) this.fetchNextData();\n  };\n\n  fetchMediaItem = (media: Cotype.Media) => {\n    api.loadMedia(media.id).then(res => {\n      this.setState((prevState: State) => {\n        const newItems = prevState.items.map(i => (i.id === res.id ? res : i));\n        return { items: newItems };\n      });\n    });\n  };\n\n  /**\n   * @description Delete file if possible, otherwise show conflict dialog\n   */\n  deleteMedia = (media: Cotype.Media) => {\n    api\n      .deleteMedia(media.id)\n      .then(res => {\n        const { items: curItems } = this.state;\n        if (Array.isArray(curItems)) {\n          const items = curItems.slice();\n          items.splice(items.indexOf(media), 1);\n          this.setState({ items, details: null });\n        }\n      })\n      .catch(err => {\n        if (err.status === 400)\n          this.setState({ conflictingItems: err.body, details: null });\n      });\n  };\n\n  onUpload = (res: { files: MediaType[]; duplicates: MediaType[] }) => {\n    this.fetchData(0);\n    if (res.duplicates.length) {\n      this.setState({ duplicates: res.duplicates });\n    }\n  };\n\n  onSelect = (media: object) => {\n    const { onSelect } = this.props;\n    if (onSelect) {\n      onSelect(media);\n    } else {\n      this.setState({ details: media });\n    }\n  };\n\n  onFilterChange = (type: string) => {\n    const { fileType } = this.state;\n    if (fileType === type) return;\n    if (type === \"all\") {\n      this.setState(\n        { fileType: undefined, lastRequestedIndex: 0 },\n        this.fetchNextData\n      );\n    } else {\n      this.setState(\n        { fileType: type, lastRequestedIndex: 0 },\n        this.fetchNextData\n      );\n    }\n  };\n\n  onOrderByChange = (orderBy: string) => {\n    this.setState({ orderBy, lastRequestedIndex: 0 }, this.fetchNextData);\n  };\n  onOrderChange = (order: string) => {\n    this.setState({ order, lastRequestedIndex: 0 }, this.fetchNextData);\n  };\n  onUnUsedChange = (unUsed: boolean) => {\n    this.setState({ unUsed, lastRequestedIndex: 0 }, this.fetchNextData);\n  };\n  onUsedChange = (used: boolean) => {\n    this.setState({ used, lastRequestedIndex: 0 }, this.fetchNextData);\n  };\n\n  onSearch = (search: string) => {\n    this.setState({ search, lastRequestedIndex: 0 }, this.fetchNextData);\n  };\n\n  closeDetails = () => {\n    this.setState({ details: null });\n  };\n\n  closeConflict = () => {\n    this.setState({ conflictingItems: null });\n  };\n\n  renderDuplicatesDialog() {\n    const { duplicates } = this.state;\n    if (duplicates === null) return null;\n    return (\n      <ModalDialog\n        title={\"One or more files you tried to upload already exist.\"}\n        onClose={() => this.setState({ duplicates: null })}\n      >\n        <DuplicateDialog>\n          <Gallery\n            count={duplicates.length}\n            data={duplicates}\n            editable={false}\n            onSelect={undefined}\n            onDelete={undefined}\n            onRowsRendered={() => undefined}\n          />\n        </DuplicateDialog>\n      </ModalDialog>\n    );\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    return Object.entries(nextState).some(([k, v]) => v !== this.state[k]);\n  }\n  render() {\n    const { details, conflictingItems, filters } = this.state;\n    return (\n      <Root {...testable(\"upload-zone\")}>\n        {conflictingItems && (\n          <ConflictDialog\n            onClose={this.closeConflict}\n            items={conflictingItems}\n            type=\"media\"\n            title=\"File in use\"\n            description=\"The file you're trying to delete is still in use. Please remove or\n            replace the file in following locations:\"\n          />\n        )}\n        {this.renderDuplicatesDialog()}\n        {details && (\n          <Details\n            onClose={this.closeDetails}\n            data={details}\n            fetchMediaItem={this.fetchMediaItem}\n          />\n        )}\n        <Topbar\n          onUpload={this.onUpload}\n          onUploadProgress={progress =>\n            this.setState({ topbarProgress: progress })\n          }\n          filters={filters}\n          onFilterChange={this.onFilterChange}\n          onOrderByChange={this.onOrderByChange}\n          onUnUsedChange={this.onUnUsedChange}\n          onUsedChange={this.onUsedChange}\n          onSearch={this.onSearch}\n          orderBys={OrderByTypes}\n          onOrderChange={this.onOrderChange}\n        />\n        <StyledUploadZone\n          activeClass={ACTIVE_CLASS}\n          onUpload={this.onUpload}\n          render={({ progress }: any) => {\n            const { total, items, editable, topbarProgress } = this.state;\n            const isProgress =\n              (progress && progress < 100) ||\n              (topbarProgress && topbarProgress < 100);\n            const itemCount = isProgress ? total + 1 : total;\n            const data = isProgress\n              ? [\n                  {\n                    progress:\n                      progress && progress < 100 ? progress : topbarProgress\n                  },\n                  ...items\n                ]\n              : items;\n            return (\n              <Main>\n                <Gallery\n                  count={itemCount}\n                  data={data}\n                  editable={editable}\n                  onSelect={this.onSelect}\n                  onDelete={this.deleteMedia}\n                  onRowsRendered={this.onRowsRendered}\n                  mediaFilter={this.props.mediaFilter}\n                />\n              </Main>\n            );\n          }}\n        />\n      </Root>\n    );\n  }\n}\n","import React from \"react\";\nimport { css } from \"styled-components/macro\";\nimport { CircularProgressbar } from \"react-circular-progressbar\";\n\nconst classes = {\n  path: css`\n    stroke: var(--primary-color);\n    stroke-linecap: round;\n    transition: stroke-dashoffset 0.5s ease 0s;\n  `,\n  trail: css`\n    stroke: #ddd;\n  `,\n  text: css`\n    fill: var(--primary-color);\n    font-size: 20px;\n    dominant-baseline: middle;\n    text-anchor: middle;\n  `,\n  background: css`\n    fill: #ddd;\n  `,\n  root: \"\"\n};\n\ntype Props = {\n  percentage: number;\n  size?: number | string;\n};\nexport default function ProgressCircle({ percentage, size = \"100%\" }: Props) {\n  return (\n    <CircularProgressbar\n      value={percentage}\n      text={`${percentage}%`}\n      classes={classes as any}\n      styles={{ root: { width: size } }}\n    />\n  );\n}\n","export const sizeFormat = (bytes: number, decimals?: number) => {\n  if (bytes === 0) return \"0 Bytes\";\n  const k = 1024;\n  const dm = decimals || 2;\n  const sizes = [\"Bytes\", \"KB\", \"MB\", \"GB\", \"TB\", \"PB\", \"EB\", \"ZB\", \"YB\"];\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n  return (\n    parseFloat((bytes / Math.pow(k, i)).toFixed(i > 2 ? dm : 0)) +\n    \" \" +\n    sizes[i]\n  );\n};\n","import { Media as MediaType, UnionType } from \"../../../../typings\";\nimport React, { Component } from \"react\";\nimport styled, { CSSProp } from \"styled-components/macro\";\nimport { FieldProps } from \"formik\";\nimport api from \"../../api\";\nimport Media from \"../../Media\";\nimport Image from \"../../Media/Image\";\nimport Button, { StyledButton } from \"../../common/Button\";\nimport ModalDialog from \"../../common/ModalDialog\";\nimport ProgressCircle from \"../../common/ProgressCircle\";\nimport { inputClass, Input } from \"../../common/styles\";\nimport UploadZone from \"../../Media/UploadZone\";\nimport UploadField from \"../../Media/UploadField\";\nimport { required } from \"./validation\";\nimport { sizeFormat } from \"../../utils/formatters\";\nimport { testable } from \"../../utils/helper\";\n\nconst Root = styled(\"div\")`\n  display: flex;\n  flex: 1;\n  align-items: center;\n`;\n\nconst ACTIVE_CLASS = \"active-upload-zone\";\n\nconst StyledUploadZone = styled(UploadZone)<{ css: CSSProp }>`\n  &.${ACTIVE_CLASS} {\n    border-color: var(--accent-color);\n    outline: 1px solid var(--accent-color);\n  }\n`;\n\nconst Chooser = styled(\"div\")`\n  display: flex;\n  flex: 1;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  margin: 20px;\n  min-height: 110px;\n`;\n\nconst Buttons = styled(\"div\")`\n  margin-top: 10px;\n  display: flex;\n  align-items: center;\n`;\n\nconst EmptyTile = styled(\"div\")`\n  width: 150px;\n  height: 150px;\n  border: 1px dashed var(--dark-grey);\n`;\n\nconst modalDialogStyle = {\n  width: \"80vw\",\n  height: \"90vh\",\n  background: \"#f5f5f5\",\n  maxWidth: 1600\n};\n\nfunction MediaImage({ media, onDelete }) {\n  if (typeof media === \"string\") {\n    return (\n      <Image\n        id={media}\n        originalname={media.split(\"/\").splice(-1)[0]}\n        width={150}\n        height={150}\n        onDelete={onDelete}\n        editable\n      />\n    );\n  }\n  return <Image {...media} onDelete={onDelete} editable />;\n}\n\nconst UploadButton = StyledButton.withComponent(\"label\");\n\ntype Props = FieldProps<any> & {\n  withExternal?: boolean;\n  mediaType?: string;\n  mimeType?: string;\n  maxSize?: number;\n  minWidth?: number;\n  minHeight?: number;\n  maxWidth?: number;\n  maxHeight?: number;\n};\ntype State = {\n  media?: MediaType | string;\n  open?: boolean;\n  externalRefOpen?: boolean;\n  externalRefVal?: string;\n};\nexport default class MediaInput extends Component<Props, State> {\n  static validate(value, props) {\n    const isRequired = required(value, props);\n    if (isRequired) return isRequired;\n  }\n\n  static getHint(model) {\n    const {\n      minHeight,\n      minWidth,\n      maxHeight,\n      maxWidth,\n      maxSize,\n      mimeType\n    } = model;\n    const str: string[] = [];\n\n    if (minHeight) {\n      str.push(\"Min Höhe: \" + minHeight + \"px\");\n    }\n    if (minWidth) {\n      str.push(\"Min Breite: \" + minWidth + \"px\");\n    }\n    if (maxHeight) {\n      str.push(\"Max Höhe: \" + maxHeight + \"px\");\n    }\n    if (maxWidth) {\n      str.push(\"Max Breite: \" + maxWidth + \"px\");\n    }\n    if (maxSize) {\n      str.push(\"Max Größe: \" + sizeFormat(maxSize, 2));\n    }\n    if (mimeType) {\n      str.push(\"Erlaubtes Dateiformat: \" + mimeType);\n    }\n    if (str.length > 0) {\n      return `(${str.join(\", \")})`;\n    } else {\n      return \"\";\n    }\n  }\n\n  static itemFactory(type: UnionType, cb: (arg: any) => void) {\n    return () => (\n      <ModalDialog\n        onClose={() => cb(null)}\n        title=\"Gallery\"\n        style={modalDialogStyle}\n      >\n        <Media openFromInput onSelect={([media]) => cb(media.id)} />\n      </ModalDialog>\n    );\n  }\n\n  state: State = {};\n\n  componentDidMount() {\n    this.fetchMedia();\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    const id = this.props.field.value;\n\n    if (id !== prevProps.field.value) this.fetchMedia();\n  }\n\n  fetchMedia() {\n    const id = this.props.field.value;\n\n    if (this.props.withExternal && id && id.match(/^http/)) {\n      this.setState({ media: id, externalRefVal: id });\n      return;\n    }\n\n    if (id) {\n      api.loadMedia(id).then(media => {\n        if (this.props.field.value) {\n          this.setState({ media });\n        }\n      });\n    } else {\n      this.setState({ media: undefined });\n    }\n  }\n\n  openGallery = () => {\n    this.setState({ open: true });\n  };\n\n  closeGallery = () => {\n    this.setState({ open: false });\n  };\n\n  chooseMedia = ([media]: MediaType[] | string[]) => {\n    this.closeGallery();\n    this.setState({ media });\n    this.props.form.setFieldValue(\n      this.props.field.name,\n      media ? (typeof media === \"string\" ? media : media.id) : null\n    );\n  };\n\n  onUpload = (res: {\n    files: MediaType[] | string[];\n    duplicates: MediaType[];\n  }) => {\n    this.chooseMedia(res.files);\n  };\n\n  externalRefDialog = () => {\n    this.setState({ externalRefOpen: true });\n  };\n\n  closeExternalRefDialog = () => {\n    this.setState({\n      externalRefOpen: false,\n      externalRefVal:\n        typeof this.state.media === \"string\" ? this.state.media : \"\"\n    });\n  };\n\n  closeAndSaveExternalRefDialog = () => {\n    this.setState({\n      externalRefOpen: false\n    });\n\n    this.chooseMedia([this.state.externalRefVal || \"\"]);\n  };\n\n  setExternalRef = (event: { target: { value: string } }) => {\n    this.setState({ externalRefVal: event.target.value });\n  };\n\n  onDelete = () => {\n    this.props.form.setFieldValue(this.props.field.name, null);\n  };\n\n  render() {\n    const { media, open, externalRefOpen } = this.state;\n    const {\n      mediaType,\n      mimeType,\n      maxSize,\n      minWidth,\n      minHeight,\n      maxWidth,\n      maxHeight\n    } = this.props;\n\n    return (\n      <StyledUploadZone\n        multiple={false}\n        css={inputClass}\n        activeClass={ACTIVE_CLASS}\n        onUpload={this.onUpload}\n        mediaType={mediaType}\n        mediaFilter={{\n          mimeType,\n          maxSize,\n          minWidth,\n          minHeight,\n          maxWidth,\n          maxHeight\n        }}\n        render={({ progress, complete, onFiles }: any) => (\n          <Root {...testable(\"upload-zone\")}>\n            {progress && !complete ? (\n              <ProgressCircle size={150} percentage={progress} />\n            ) : media ? (\n              <MediaImage media={media} onDelete={this.onDelete} />\n            ) : (\n              <EmptyTile />\n            )}\n            <Chooser>\n              Drag an image here\n              <Buttons>\n                <UploadButton light>\n                  <UploadField onFiles={onFiles}>Browse computer</UploadField>\n                </UploadButton>\n                <Button light onClick={this.openGallery}>\n                  Open gallery\n                </Button>\n                {this.props.withExternal && (\n                  <Button light onClick={this.externalRefDialog}>\n                    External Reference\n                  </Button>\n                )}\n              </Buttons>\n            </Chooser>\n            {open && (\n              <ModalDialog\n                onClose={this.closeGallery}\n                title=\"Gallery\"\n                style={modalDialogStyle}\n              >\n                <Media\n                  openFromInput\n                  onSelect={this.chooseMedia}\n                  mediaType={mediaType}\n                  mediaFilter={{\n                    mimeType,\n                    maxSize,\n                    minWidth,\n                    minHeight,\n                    maxWidth,\n                    maxHeight\n                  }}\n                />\n              </ModalDialog>\n            )}\n            {externalRefOpen && (\n              <ModalDialog\n                onClose={this.closeExternalRefDialog}\n                title=\"External Media Reference\"\n                style={modalDialogStyle}\n              >\n                <Input\n                  value={this.state.externalRefVal || \"\"}\n                  onChange={this.setExternalRef}\n                />\n                <Buttons>\n                  <Button light onClick={this.closeExternalRefDialog}>\n                    Cancel\n                  </Button>\n                  <Button onClick={this.closeAndSaveExternalRefDialog}>\n                    OK\n                  </Button>\n                </Buttons>\n              </ModalDialog>\n            )}\n          </Root>\n        )}\n      />\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport styled from \"styled-components/macro\";\nimport api from \"../../api\";\nimport Image from \"../../Media/Image\";\nimport * as Cotype from \"../../../../typings\";\n\nconst Root = styled(\"div\")`\n  display: flex;\n  flex: 1;\n  align-items: center;\n`;\n\ntype Props = {\n  value: any;\n};\n\ntype ExternalImage = {\n  id: string;\n  originalname: string;\n  width: \"auto\";\n  height: \"auto\";\n};\n\ntype State = {\n  media?: Cotype.Media | ExternalImage;\n};\n\nexport default class MediaOutput extends Component<Props, State> {\n  static getSummaryImage(props: Props) {\n    return <MediaOutput {...props} />;\n  }\n  state: State = {};\n\n  componentDidMount() {\n    this.fetchMedia();\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    const id = this.props.value;\n    if (id !== prevProps.value) this.fetchMedia();\n  }\n\n  fetchMedia() {\n    const id: string = this.props.value;\n    if (!id) {\n      this.setState({ media: undefined });\n    } else if (id.includes(\"://\")) {\n      this.setState({\n        media: {\n          id,\n          originalname: id.replace(/.+\\//, \"\"),\n          width: \"auto\",\n          height: \"auto\"\n        }\n      });\n    } else {\n      api.loadMedia(id).then(media => this.setState({ media }));\n    }\n  }\n\n  render() {\n    const { media } = this.state;\n    return (\n      <div>\n        <Root>{media && <Image {...media} />}</Root>\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport { FieldProps } from \"formik\";\nimport ToggleSwitch from \"../../common/ToggleSwitch\";\n\ntype Props = FieldProps<any> & {\n  input?: \"checkbox\" | \"toggle\";\n  defaultValue?: boolean;\n};\n\nexport default class BooleanInput extends Component<Props> {\n  static getDefaultValue({ defaultValue = false }: Props) {\n    return defaultValue;\n  }\n\n  static validate() {\n    /* noop */\n  }\n\n  render() {\n    const { field, form, input } = this.props;\n    const { name, value } = field;\n    if (input === \"checkbox\") {\n      return (\n        <input\n          type=\"checkbox\"\n          checked={value}\n          onChange={e => form.setFieldValue(name, e.target.checked)}\n        />\n      );\n    }\n    return (\n      <ToggleSwitch\n        on={value}\n        onClick={() => form.setFieldValue(name, !value)}\n      />\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport ToggleSwitch from \"../../common/ToggleSwitch\";\n\ntype Props = {\n  value: any;\n  input?: \"checkbox\" | \"toggle\";\n};\nexport default class BooleanOutput extends Component<Props> {\n  render() {\n    const { value, input } = this.props;\n    if (input === \"checkbox\") {\n      return (\n        <input\n          type=\"checkbox\"\n          checked={value}\n        />\n      );\n    }\n    return (\n      <ToggleSwitch\n        on={value}\n        disabled\n      />\n    );\n  }\n}\n\n","import React, { Component } from \"react\";\nimport styled, { css } from \"styled-components/macro\";\nimport { FieldProps } from \"formik\";\nimport orderSearchResults from \"../../utils/orderSearchResults\";\nimport { stringify } from \"qs\";\nimport { inputClass, Input } from \"../../common/styles\";\nimport Autocomplete from \"../../common/Autocomplete\";\nimport api from \"../../api\";\nimport { required } from \"./validation\";\nimport { ReferenceType, SearchResultItem } from \"../../../../typings\";\nimport { BasicResultItem } from \"../../common/ResultItem\";\nimport { ControllerStateAndHelpers } from \"downshift\";\n\nconst validationRegex = /W*(http:\\/\\/|https:\\/\\/|mailto:|tel:)W*|^\\/.*$/gm;\n\nconst Root = styled(\"div\")`\n  ${inputClass};\n  padding: 0;\n  min-width: 0;\n`;\n\nexport const borderlessCss = css`\n  border: none;\n  box-sizing: border-box;\n  padding: 4px 10px 4px 0;\n  flex: 1;\n  font-size: inherit;\n  height: 40px;\n  outline: none;\n  :focus,\n  :active {\n    border-color: none;\n    box-shadow: none;\n  }\n`;\n\nconst Select = styled(\"select\")`\n  flex-shrink: 0;\n  display: flex;\n  flex-direction: row;\n  & > div:not(:last-child) {\n    border-left: grey;\n  }\n  ${inputClass};\n  width: auto;\n  margin-right: 0.6em;\n  min-height: 44px;\n`;\n\ntype Option = {\n  active?: boolean;\n};\nconst Option = styled(\"option\")`\n  background: ${({ active }: Option) => (active ? \"blue\" : \"transparent\")};\n`;\n\ntype Props = FieldProps<ReferenceType> & {\n  type: string;\n  models?: string[];\n  required?: boolean;\n  placeholder?: string;\n  allowAbsoluteRefs?: boolean;\n};\n\ntype Ref = { id: string; model: string } | null;\n\ntype State = {\n  items: SearchResultItem[];\n  value: Ref;\n  searchTerm: string;\n  internalRef: boolean;\n  prevValue: Ref;\n};\n\nexport default class ReferenceInput extends Component<Props, State> {\n  static validate(value, props) {\n    const isRequired = required(value ? value.id : null, props);\n    if (isRequired) return isRequired;\n    if (!value || value.model || !value.id) return;\n    const check = value.id.toString().match(validationRegex);\n    if (!check) {\n      return 'This url is not valid. Links to the same domain need to start with \"/\", to other domains with a valid protocol (http/https) or with a valid contact protocol (mailto/tel).';\n    }\n  }\n\n  state: State = {\n    items: [],\n    value: null,\n    searchTerm: \"\",\n    internalRef: true,\n    prevValue: null\n  };\n\n  autocomplete: any;\n\n  componentDidMount() {\n    const id = this.props.field.value;\n    if (id) this.fetchItem(id);\n    this.fetchItems({});\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    const ref = this.props.field.value;\n\n    if (prevProps.field.value !== ref) {\n      if (ref) {\n        this.fetchItem(ref);\n      } else {\n        this.setState({ value: null, prevValue: null, internalRef: true });\n      }\n    }\n  }\n\n  onInputValueChange = (\n    inputValue,\n    { isOpen }: ControllerStateAndHelpers<any>\n  ) => {\n    if (inputValue) {\n      this.fetchItems({ q: inputValue });\n      this.setState({ searchTerm: isOpen ? inputValue : \"\" });\n    } else this.fetchItems({});\n  };\n\n  onChange = value => {\n    this.setState({ value });\n    this.props.form.setFieldValue(\n      this.props.field.name,\n      value ? { id: value.id, model: value.model } : null\n    );\n    if (!value) this.fetchItems({});\n    else this.fetchItems({});\n  };\n\n  fetchItems = opts => {\n    const { type, models } = this.props;\n    const queryString = stringify({\n      ...opts,\n      linkable: models && models.length === 0,\n      models: models && models.length ? models : undefined\n    });\n\n    const isExternal = \"externalDataSource\" in this.props;\n\n    return api\n      .get(`/${isExternal ? \"externalDataSource\" : type}?${queryString}`)\n      .then(({ items }) => {\n        this.setState({\n          items: orderSearchResults(items, this.state.searchTerm)\n        });\n      });\n  };\n\n  fetchItem = refObj => {\n    const { type } = this.props;\n    if (!(refObj || {}).model) {\n      return this.setState({ internalRef: false, value: refObj });\n    }\n\n    return api\n      .get(`/${type}/${refObj.model}/${refObj.id}/item`)\n      .then(value => {\n        this.setState({\n          value: this.props.field.value ? value : null,\n          internalRef: value.model ? true : false\n        });\n      })\n      .catch(() => {\n        this.props.form.setFieldValue(this.props.field.name, null);\n      });\n  };\n\n  itemToString = i => (i ? i.title : \"\");\n\n  renderItem = (i, term: string) => {\n    return <BasicResultItem item={i} term={term}></BasicResultItem>;\n  };\n\n  onInputTypeChange = (e: React.FormEvent<HTMLSelectElement>) => {\n    const internalRef = e.currentTarget.value === \"intern\";\n    this.setState(prev => ({\n      internalRef,\n      value: prev.prevValue ? prev.prevValue : null,\n      prevValue: prev.value\n    }));\n  };\n\n  render() {\n    const { value, items, internalRef } = this.state;\n    const { placeholder, allowAbsoluteRefs } = this.props;\n\n    return (\n      <div style={{ display: \"flex\" }}>\n        {allowAbsoluteRefs && (\n          <Select\n            value={internalRef ? \"intern\" : \"extern\"}\n            onChange={this.onInputTypeChange}\n          >\n            <Option>intern</Option>\n            <Option>extern</Option>\n          </Select>\n        )}\n        {internalRef || !allowAbsoluteRefs ? (\n          <Root>\n            <Autocomplete\n              toggleButton\n              inputElementCss={borderlessCss}\n              selectedItem={value ? value : null}\n              onInputValueChange={this.onInputValueChange}\n              onChange={this.onChange}\n              items={items}\n              name={this.props.field.name}\n              itemToString={this.itemToString}\n              renderItem={item => this.renderItem(item, this.state.searchTerm)}\n              placeholder={placeholder ? placeholder : undefined}\n              style={{ paddingLeft: \"10px\" }}\n            />\n          </Root>\n        ) : (\n          <Input\n            css={css`\n              min-height: 44px;\n            `}\n            value={value ? value.id : \"\"}\n            placeholder=\"/path/to/page or https://site.de/path/to/page\"\n            onChange={e => {\n              this.onChange({ id: e.currentTarget.value, model: undefined });\n            }}\n          />\n        )}\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport styled from \"styled-components/macro\";\nimport api from \"../../api\";\nimport ImageCircle from \"../../common/ImageCircle\";\n\nconst ImageItem = styled(\"div\")`\n  display: flex;\n  align-items: center;\n`;\n\ntype Props = {\n  type: string;\n  model: string;\n  value: {\n    id: string;\n    model: string;\n  };\n};\ntype State = {\n  value?: any;\n};\nexport default class ReferenceOutput extends Component<Props, State> {\n  static getSummaryText(props: Props) {\n    if (!props.value) return null;\n    return <ReferenceOutput {...props} />;\n  }\n\n  state: State = {};\n\n  componentDidMount() {\n    this.fetchData();\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    const { type, model, value } = this.props;\n    if (\n      type !== prevProps.type ||\n      model !== prevProps.model ||\n      value !== prevProps.value\n    ) {\n      if (value) {\n        this.fetchData();\n      } else {\n        this.setState({ value: null });\n      }\n    }\n  }\n\n  fetchData() {\n    const { type, value } = this.props;\n    if (!(value || {}).model) return;\n    api\n      .get(`/${type}/${value.model}/${value.id}/item`)\n      .then(v => this.setState({ value: v }));\n  }\n\n  render() {\n    const { value } = this.state;\n    if (!value) return null;\n    if (\"image\" in value) {\n      const src =\n        value.image &&\n        (value.image.includes(\"://\")\n          ? value.image\n          : `/thumbs/square/${value.image}`);\n      return (\n        <ImageItem>\n          <ImageCircle src={src} alt={value.title} size={12} />\n          {value.title}\n        </ImageItem>\n      );\n    }\n    return value.title;\n  }\n}\n","import React, { Component } from \"react\";\nimport styled from \"styled-components/macro\";\nimport { FieldProps } from \"formik\";\nimport { inputClass } from \"../../common/styles\";\nimport Autocomplete from \"../../common/Autocomplete\";\nimport ImageCircle from \"../../common/ImageCircle\";\nimport api from \"../../api\";\nimport { required } from \"./validation\";\nimport { stringify } from \"qs\";\nimport { borderlessCss } from \"./ReferenceInput\";\n\nconst Root = styled(\"div\")`\n  ${inputClass} padding: 0;\n  padding-left: 10px;\n`;\n\nconst ImageItem = styled(\"div\")`\n  display: flex;\n  align-items: center;\n`;\n\ntype Props = FieldProps<any> & {\n  type: string;\n  models: [string];\n  required?: boolean;\n  placeholder?: string;\n};\n\ntype State = {\n  items: any[];\n  value: string | null;\n  clearSelection: (() => void) | null;\n};\n\nexport default class SingleReferenceInput extends Component<Props, State> {\n  static validate(value, props) {\n    const isRequired = required(value, props);\n    if (isRequired) return isRequired;\n  }\n\n  state: State = {\n    items: [],\n    value: null,\n    clearSelection: null\n  };\n\n  autocomplete: any;\n\n  componentDidMount() {\n    const id = this.props.field.value;\n    if (id) this.fetchItem(id);\n    this.fetchItems({});\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    const id = this.props.field.value;\n\n    if (prevProps.field.value !== id) {\n      // const { clearSelection } = this.state;\n      if (id) this.fetchItem(id);\n      // if (id === null && clearSelection) clearSelection();\n    }\n  }\n\n  onInputValueChange = (inputValue, downshift) => {\n    if (inputValue) this.fetchItems({ q: inputValue });\n    else this.fetchItems({});\n  };\n\n  onChange = (value, stateAndHelpers: { clearSelection: () => void }) => {\n    this.setState({ value, clearSelection: stateAndHelpers.clearSelection });\n    this.props.form.setFieldValue(\n      this.props.field.name,\n      value ? value.id : null\n    );\n  };\n\n  fetchItems = opts => {\n    const { type, models } = this.props;\n\n    const queryString = stringify(opts);\n\n    return api\n      .get(`/${type}/${models[0]}${queryString ? \"?\" + queryString : \"\"}`)\n      .then(({ items }) => this.setState({ items }));\n  };\n\n  fetchItem = id => {\n    const { type, models } = this.props;\n    return api\n      .get(`/${type}/${models[0]}/${id}/item`)\n      .then(value =>\n        this.setState({ value: this.props.field.value ? value : null })\n      )\n      .catch(() => {\n        this.props.form.setFieldValue(this.props.field.name, null);\n      });\n  };\n\n  itemToString = i => (i ? i.title : \"\");\n\n  renderItem = i => {\n    if (\"image\" in i) {\n      const src =\n        i.image &&\n        (i.image.includes(\"://\") ? i.image : `/thumbs/square/${i.image}`);\n      return (\n        <ImageItem>\n          <ImageCircle src={src} alt={i.title} size={12} />\n          {i.title}\n        </ImageItem>\n      );\n    }\n    return i.title;\n  };\n\n  render() {\n    const { value, items } = this.state;\n    const { placeholder } = this.props;\n    return (\n      <Root>\n        <Autocomplete\n          toggleButton\n          inputElementCss={borderlessCss}\n          selectedItem={value ? value : null}\n          onInputValueChange={this.onInputValueChange}\n          onChange={this.onChange}\n          name={this.props.field.name}\n          items={items}\n          itemToString={this.itemToString}\n          renderItem={this.renderItem}\n          placeholder={placeholder ? placeholder : undefined}\n        />\n      </Root>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport styled from \"styled-components/macro\";\nimport api from \"../../api\";\nimport ImageCircle from \"../../common/ImageCircle\";\n\nconst ImageItem = styled(\"div\")`\n  display: flex;\n  align-items: center;\n`;\n\ntype Props = {\n  type: string;\n  model: string;\n  value: string;\n};\ntype State = {\n  value?: any;\n};\nexport default class SingleReferenceOutput extends Component<Props, State> {\n  static getSummaryText(props: Props) {\n    if (!props.value) return null;\n    return <SingleReferenceOutput {...props} />;\n  }\n\n  state: State = {};\n\n  componentDidMount() {\n    this.fetchData();\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    const { type, model, value } = this.props;\n    if (\n      type !== prevProps.type ||\n      model !== prevProps.model ||\n      value !== prevProps.value\n    ) {\n      if (value) {\n        this.fetchData();\n      } else {\n        this.setState({ value: null });\n      }\n    }\n  }\n\n  fetchData() {\n    const { type, model, value } = this.props;\n    api\n      .get(`/${type}/${model}/${value}/item`)\n      .then(v => this.setState({ value: v }));\n  }\n\n  render() {\n    const { value } = this.state;\n    if (!value) return null;\n    if (\"image\" in value) {\n      const src =\n        value.image &&\n        (value.image.includes(\"://\")\n          ? value.image\n          : `/thumbs/square/${value.image}`);\n      return (\n        <ImageItem>\n          <ImageCircle src={src} alt={value.title} size={12} />\n          {value.title}\n        </ImageItem>\n      );\n    }\n    return value.title;\n  }\n}\n","import React, { Component } from \"react\";\nimport moment from \"moment\";\nimport { FieldProps } from \"formik\";\nimport \"moment/locale/de\";\nimport dateJS from \"date.js\";\nimport DatePicker from \"../../common/DatePicker\";\nimport { required } from \"./validation\";\nimport { DateString } from \"../../../../typings\";\n\ntype Props = FieldProps<any> & DateString;\nexport default class DateInput extends Component<Props> {\n  static getDefaultValue(props: Props) {\n    const { defaultValue } = props;\n    return defaultValue ? dateJS(defaultValue) : \"\";\n  }\n\n  static validate(value: string, props) {\n    const isRequired = required(value, props);\n    if (isRequired) return isRequired;\n\n    if (value === undefined || value === \"\") return;\n    const date = moment(value).isValid();\n    if (!date) {\n      return \"Invalid date\";\n    }\n  }\n\n  handleChange = (value: string) => {\n    const { field, form } = this.props;\n    form.setFieldValue(field.name, value);\n  };\n\n  render() {\n    const { field, placeholder } = this.props;\n    return (\n      <DatePicker\n        {...field}\n        onChange={this.handleChange}\n        placeholder={placeholder}\n      />\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport { outputClass } from \"../../common/styles\";\nimport moment from \"moment\";\nimport \"moment/locale/de\";\nimport styled from \"styled-components/macro\";\n\nconst FORMAT = \"L\";\n\ntype Props = {\n  value?: any;\n};\n\nconst Container = styled(\"div\")`\n  ${outputClass}\n`;\nexport default class DateOutput extends Component<Props> {\n  formatDate = (date: string) => {\n    return date ? moment(date).format(FORMAT) : \"\";\n  };\n  render() {\n    const { value = \"\" } = this.props;\n    return <Container>{this.formatDate(value)}</Container>;\n  }\n}\n","import React from \"react\";\n\nimport inputs from \"./inputs\";\nimport outputs from \"./outputs\";\n\nexport default function ImmutableInput({ field, form, type, child, ...rest }) {\n  if (form.initialValues[field.name] == null) {\n    const Input = inputs.get(child);\n    return <Input {...rest} {...child} field={field} form={form} />;\n  }\n\n  const Output = outputs.get(child);\n\n  return (\n    <Output data-name={field.name} {...rest} {...child} value={field.value} />\n  );\n}\n\nImmutableInput.validate = (value, { child, ...rest }) => {\n  const Input = inputs.get(child);\n\n  return Input.validate(value, { ...rest, ...child });\n};\n","import mudder from \"mudder\";\n\nexport const firstMudderCharacter = \"0\";\nexport const lastMudderCharacter = \"z\";\nconst lastDigit = mudder.base62.stringToNumber(lastMudderCharacter);\n\nexport default (\n  prevString: string = firstMudderCharacter,\n  nextString?: string\n): string => {\n  if (nextString) {\n    return mudder.base62.mudder(prevString, nextString)[0];\n  } else {\n    const digits = mudder.base62.stringToDigits(prevString);\n    let increased = false;\n    const newDigits: number[] = digits.reduce<number[]>((acc, digit) => {\n      if (!increased) {\n        if (digit < lastDigit) {\n          increased = true;\n          digit++;\n        }\n        acc.push(digit);\n      }\n      return acc;\n    }, []);\n    if (!increased) {\n      newDigits.push(0);\n    }\n\n    return mudder.base62.digitsToString(newDigits);\n  }\n};\n","import React, { Component } from \"react\";\nimport { AutoSizer } from \"react-virtualized/dist/es/AutoSizer\";\nimport { List, ListProps, ListRowProps } from \"react-virtualized/dist/es/List\";\nimport {\n  CellMeasurer,\n  CellMeasurerCache\n} from \"react-virtualized/dist/es/CellMeasurer\";\n\nconst defaultHeight = 80;\n\ntype Size = { width: number; height: number };\n\nexport type RenderInfo = {\n  overscanStartIndex: number;\n  overscanStopIndex: number;\n  startIndex: number;\n  stopIndex: number;\n};\n\nexport type Props = Partial<ListProps> & {\n  rowCount: number;\n  renderRow: (foo: any) => React.ReactNode;\n  visibleRows?: number;\n  size?: Size;\n  className?: string;\n  extraPadding?: number;\n};\ntype State = {\n  rowHeight: number;\n};\nexport default class ScrollList extends Component<Props, State> {\n  state: State = {\n    rowHeight: defaultHeight\n  };\n\n  list: List | undefined;\n\n  cache = new CellMeasurerCache({\n    defaultHeight,\n    fixedWidth: true,\n    keyMapper: () => 1\n  });\n\n  setList = (list: List) => {\n    this.list = list;\n  };\n\n  rowRenderer = ({ key, parent, ...props }: ListRowProps) => (\n    <CellMeasurer\n      cache={this.cache}\n      columnIndex={0}\n      key={key}\n      parent={parent}\n      rowIndex={props.index}\n    >\n      {this.props.renderRow(props)}\n    </CellMeasurer>\n  );\n\n  onRowsRendered = (info: RenderInfo) => {\n    if (this.props.visibleRows && this.state.rowHeight === defaultHeight) {\n      const rowHeight = this.cache.rowHeight({ index: 0 });\n      if (rowHeight !== defaultHeight) this.setState({ rowHeight });\n    }\n    const { onRowsRendered } = this.props;\n    if (onRowsRendered) onRowsRendered(info);\n  };\n\n  renderList(size: Size, className?: string) {\n    const { rowCount, ...props } = this.props;\n    return (\n      <List\n        {...props}\n        ref={this.setList}\n        width={size.width}\n        height={size.height}\n        deferredMeasurementCache={this.cache}\n        rowHeight={this.cache.rowHeight}\n        overscanRowCount={10}\n        rowCount={rowCount}\n        rowRenderer={this.rowRenderer}\n        onRowsRendered={this.onRowsRendered}\n        className={className}\n      />\n    );\n  }\n\n  render() {\n    const {\n      rowCount = 0,\n      visibleRows,\n      size,\n      className,\n      extraPadding = 0\n    } = this.props;\n    if (size) {\n      // Size passed as prop (possibly from another AutoSizer)\n      return this.renderList(size, className);\n    }\n    if (visibleRows) {\n      // Let height be a multiple of the row height\n      const { rowHeight = defaultHeight } = this.state;\n      const rows = Math.min(rowCount, visibleRows);\n      return (\n        <AutoSizer disableHeight>\n          {({ width }) =>\n            this.renderList(\n              {\n                width,\n                height: rows * rowHeight + extraPadding\n              },\n              className\n            )\n          }\n        </AutoSizer>\n      );\n    }\n    return <AutoSizer>{size2 => this.renderList(size2, className)}</AutoSizer>;\n  }\n}\n","import React, { Component } from \"react\";\nimport { NavLink } from \"react-router-dom\";\nimport styled, { css } from \"styled-components/macro\";\nimport ImageCircle from \"../common/ImageCircle\";\nimport { testable } from \"../utils/helper\";\n\nconst activeClass = css`\n  background-color: var(--accent-color) !important;\n  color: #fff;\n`;\n\nconst StyledNavLink = styled(NavLink)`\n  display: flex;\n  width: 100%;\n  position: relative;\n  background: #fff;\n  text-decoration: none;\n  color: inherit;\n  border-bottom: 1px solid #f5f5f5;\n  padding: 10px 15px 10px 23px;\n  box-sizing: border-box;\n  align-items: center;\n  :hover {\n    background-color: var(--primary-color);\n    color: #fff;\n  }\n  &.active {\n    width: 100%;\n    ${activeClass}\n  }\n`;\n\nconst Title = styled(\"span\")`\n  display: block;\n  display: -webkit-box;\n  -webkit-line-clamp: 3;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n  text-overflow: ellipsis;\n`;\n\nexport type ItemProps = {\n  index: number;\n  id: string;\n  title: string;\n  image?: string | null | undefined;\n  style?: object;\n  className?: string;\n  small?: boolean;\n  baseUrl: string;\n};\n\nexport default class Item extends Component<ItemProps> {\n  render() {\n    const { id, title, image, style, baseUrl, className, small } = this.props;\n    const src =\n      image && (image.includes(\"://\") ? image : `/thumbs/square/${image}`);\n    return (\n      <StyledNavLink\n        to={`${baseUrl}/edit/${id}`}\n        {...testable(\"list-item\")}\n        style={style}\n        className={className}\n      >\n        <ImageCircle\n          src={src ? src : null}\n          alt={title}\n          size={small ? 12 : 24}\n        />\n        <Title>{title}</Title>\n      </StyledNavLink>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport Button from \"../common/Button\";\nimport ModalDialog from \"../common/ModalDialog\";\nimport { paths } from \"../common/icons\";\nimport middleString from \"../utils/middleString\";\nimport * as Cotype from \"../../../typings\";\nimport api from \"../api\";\nimport ScrollList, { RenderInfo } from \"../common/ScrollList\";\nimport Item from \"../List/Item\";\nimport styled, { css } from \"styled-components/macro\";\n\nexport const errorClass = \"error-field-label\";\n\ntype Props = {\n  onSave: (positionString: string) => void;\n  onClose: () => void;\n  model: Cotype.Model;\n  id?: string;\n};\ntype State = {\n  lastRequestedIndex: number;\n  items: Cotype.Item[];\n  total: number;\n};\n\nconst modalDialogStyle = {\n  width: \"80vw\",\n  background: \"#f5f5f5\",\n  maxWidth: 800\n};\nconst StyledItem = styled(Item)`\n  pointer-events: none;\n  padding-right: 50px;\n  padding-left: 50px;\n`;\nconst Field = styled(\"div\")`\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  position: relative;\n  background: #fff;\n  box-sizing: border-box;\n  align-items: center;\n  &:first-of-type {\n    > a {\n      border-top: 1px solid #f5f5f5;\n    }\n  }\n`;\nconst StyledButton = styled(Button)`\n  opacity: 0.2;\n  transition: opacity 0.3s ease-in-out;\n  pointer-events: none;\n`;\nconst ButtonBar = styled(\"div\")<{ bottom?: boolean }>`\n  position: absolute;\n  width: 100%;\n  z-index: 9;\n  display: flex;\n  justify-content: space-between;\n  cursor: pointer;\n  ${p =>\n    p.bottom\n      ? css`\n          bottom: 0;\n          transform: translateY(+50%);\n        `\n      : css`\n          top: 0;\n          transform: translateY(-50%);\n        `}\n  &:hover {\n    > button {\n      opacity: 1;\n    }\n  }\n`;\nconst StyledList = styled(ScrollList)<{ bottom?: boolean }>`\n  background-color: #fff;\n  outline: none;\n  > div {\n    overflow: visible !important;\n  }\n  padding-top: 12px;\n  padding-bottom: 12px;\n`;\nclass PositionModal extends Component<Props, State> {\n  state: State = {\n    lastRequestedIndex: 0,\n    items: [],\n    total: 0\n  };\n  startIndex = 0;\n  componentDidMount() {\n    this.fetchNextData();\n  }\n\n  refresh() {\n    this.fetchData(this.startIndex, 50);\n  }\n\n  fetchNextData = () => {\n    this.fetchData(this.state.lastRequestedIndex, 50);\n  };\n\n  fetchData = (offset: number, limit = 50) => {\n    const { model } = this.props;\n    const { items } = this.state;\n    this.setState({ lastRequestedIndex: offset + limit });\n    api.list(model, { offset, limit }).then(res => {\n      this.setState({\n        items: items.slice(0, offset).concat(res.items),\n        total: res.total\n      });\n    });\n  };\n  onRowsRendered = ({ startIndex, overscanStopIndex }: RenderInfo) => {\n    this.startIndex = startIndex;\n    // Lazy-load next batch of items\n    if (overscanStopIndex >= this.state.lastRequestedIndex)\n      this.fetchNextData();\n  };\n  setPosition = (prev, post) => {\n    if (this.props.model.order !== \"asc\") {\n      [prev, post] = [post, prev];\n    }\n\n    this.props.onSave(middleString(prev, prev !== post ? post : undefined));\n  };\n  render() {\n    let { items } = this.state;\n    const { total } = this.state;\n    const actions = [\n      <Button icon={paths.Clear} onClick={this.props.onClose} light>\n        Abbrechen\n      </Button>\n    ];\n    // const sortOrder = this.props.model.order || \"desc\";\n    if (this.props.id) {\n      items = items.filter(el => String(el.id) !== this.props.id);\n    }\n\n    return (\n      <ModalDialog\n        onClose={this.props.onClose}\n        title=\"set position\"\n        actionButtons={actions}\n        icon={paths.Sort}\n        style={modalDialogStyle}\n      >\n        <StyledList\n          rowCount={total - 1}\n          items={items}\n          onRowsRendered={this.onRowsRendered}\n          visibleRows={7}\n          extraPadding={24}\n          renderRow={({ key, index, style }) => {\n            const item = items[index];\n            if (!item) return <div style={style} />;\n            return (\n              <Field style={style}>\n                {index === 0 && (\n                  <ButtonBar\n                    onClick={() => this.setPosition(undefined, item.orderValue)}\n                  >\n                    <StyledButton icon={paths.ArrowRight} light />\n                    <StyledButton icon={paths.ArrowLeft} light />\n                  </ButtonBar>\n                )}\n                <StyledItem\n                  baseUrl={\"/\"}\n                  {...item}\n                  key={`${key}-${item.id}`}\n                  index={index}\n                  small\n                />\n                <ButtonBar\n                  bottom\n                  onClick={() =>\n                    this.setPosition(\n                      item.orderValue,\n                      items[index + 1] && items[index + 1].orderValue\n                    )\n                  }\n                >\n                  <StyledButton icon={paths.ArrowRight} light />\n                  <StyledButton icon={paths.ArrowLeft} light />\n                </ButtonBar>\n              </Field>\n            );\n          }}\n        />\n      </ModalDialog>\n    );\n  }\n}\n\nexport default PositionModal;\n","import React, { Component } from \"react\";\nimport { FieldProps } from \"formik\";\nimport Button from \"../../common/Button\";\nimport PositionModal from \"../PositionModal\";\nimport * as Cotype from \"../../../../typings\";\nimport { paths } from \"../../common/icons\";\n\ntype Props = FieldProps<any> & {\n  model: Cotype.Model;\n  id: string;\n};\nexport default class PositionInput extends Component<Props, { show: boolean }> {\n  static validate(value: any, props: Props) {\n    return false;\n  }\n  static getDefaultValue(props: Props) {\n    return \"\";\n  }\n\n  state = {\n    show: false\n  };\n  showModal = () => {\n    this.setState({ show: true });\n  };\n  hideModal = () => {\n    this.setState({ show: false });\n  };\n  onSave = (postitionString: string) => {\n    const { field, form } = this.props;\n    form.setFieldValue(field.name, postitionString);\n    this.hideModal();\n  };\n  render() {\n    const { field, form, model, id, ...props } = this.props;\n    const { show } = this.state;\n\n    const { value, ...fieldProps } = field;\n    return (\n      <>\n        <Button icon={paths.Sort} type=\"button\" onClick={this.showModal}>\n          set position\n        </Button>\n        {show && (\n          <PositionModal\n            onClose={this.hideModal}\n            onSave={this.onSave}\n            model={model}\n            id={id}\n          />\n        )}\n        <input value={value || \"\"} {...fieldProps} {...props} type=\"hidden\" />\n      </>\n    );\n  }\n}\n","import SlugInput from \"./SlugInput\";\n\nimport TextInput from \"./TextInput\";\nimport TextOutput from \"./TextOutput\";\n\nimport TextAreaInput from \"./TextAreaInput\";\n\nimport NumberInput from \"./NumberInput\";\n\nimport RichTextInput from \"./RichTextInput\";\nimport RichTextOutput from \"./RichTextOutput\";\n\nimport ListInput from \"./lists/Input\";\nimport ListOutput from \"./lists/Output\";\n\nimport UnionInput from \"./UnionInput\";\nimport UnionOutput from \"./UnionOutput\";\n\nimport ObjectInput from \"./ObjectInput\";\nimport ObjectOutput from \"./ObjectOutput\";\n\nimport OptionsInput from \"./OptionsInput\";\nimport OptionsOutput from \"./OptionsOutput\";\n\nimport MapInput from \"./MapInput\";\n\nimport MediaInput from \"./MediaInput\";\nimport MediaOutput from \"./MediaOutput\";\n\nimport BooleanInput from \"./BooleanInput\";\nimport BooleanOutput from \"./BooleanOutput\";\n\nimport ReferenceInput from \"./ReferenceInput\";\nimport ReferenceOutput from \"./ReferenceOutput\";\n\nimport SingleReferenceInput from \"./SingleReferenceInput\";\nimport SingleReferenceOutput from \"./SingleReferenceOutput\";\n\nimport DateInput from \"./DateInput\";\nimport DateOutput from \"./DateOutput\";\n\nimport ImmutableInput from \"./ImmutableInput\";\nimport ImmutableOutput from \"./ImmutableOutput\";\n\nimport inputs from \"./inputs\";\nimport outputs from \"./outputs\";\nimport PositionInput from \"./PositionInput\";\n\nconst Empty: React.FC = () => null;\n\ninputs.register({\n  boolean: BooleanInput,\n  content: ReferenceInput,\n  external: ReferenceInput,\n  list: ListInput,\n  map: MapInput,\n  media: MediaInput,\n  object: ObjectInput,\n  richtext: RichTextInput,\n  select: OptionsInput,\n  settings: SingleReferenceInput,\n  slug: SlugInput,\n  string: TextInput,\n  union: UnionInput,\n  number: NumberInput,\n  date: DateInput,\n  textarea: TextAreaInput,\n  immutable: ImmutableInput,\n  position: PositionInput,\n  virtual: Empty\n});\n\noutputs.register({\n  boolean: BooleanOutput,\n  content: ReferenceOutput,\n  external: ReferenceOutput,\n  list: ListOutput,\n  media: MediaOutput,\n  object: ObjectOutput,\n  richtext: RichTextOutput,\n  select: OptionsOutput,\n  settings: SingleReferenceOutput,\n  string: TextOutput,\n  number: TextOutput,\n  union: UnionOutput,\n  date: DateOutput,\n  textarea: TextOutput,\n  immutable: ImmutableOutput,\n  position: TextOutput,\n  virtual: Empty\n});\n\nexport const Input = ObjectInput;\nexport const Output = ObjectOutput;\n","import React from \"react\";\n\nimport outputs from \"./outputs\";\n\nexport default function ImmutableOutput({ type, child, ...rest }) {\n  const Output = outputs.get(child);\n\n  return <Output {...child} {...rest} />;\n}\n","import * as Cotype from \"../../../../typings\";\nimport React, { Component } from \"react\";\n\nimport api from \"../../api\";\nimport { Page, Title, Cols, Content, Outset } from \"../../common/page\";\nimport { Output } from \"../elements\";\n\ntype Props = {\n  id: string;\n  rev?: string | number;\n  model: Cotype.Model;\n  versions?: (Cotype.VersionItem & { published: boolean })[];\n  onReceiveData?: (data: any) => void;\n};\n\ntype State = {\n  data?: any;\n  compareTo?: any;\n};\n\nexport default class History extends Component<Props, State> {\n  state: State = {};\n\n  componentDidMount() {\n    this.fetchData();\n  }\n\n  componentDidUpdate(prev: Props) {\n    const { id, rev } = this.props;\n    if (id !== prev.id || rev !== prev.rev) this.fetchData();\n  }\n\n  fetchData = () => {\n    const { model, id, versions, rev, onReceiveData } = this.props;\n\n    if (id !== undefined && rev !== undefined) {\n      api.loadVersion(model, id, Number(rev)).then(version => {\n        this.setState(version);\n        if (onReceiveData) onReceiveData(version);\n      });\n      if (versions && versions.length) {\n        api\n          .loadVersion(model, id, versions[0].rev)\n          .then(version => this.setState({ compareTo: version.data }));\n      }\n    } else if (id !== undefined) {\n      api.load(model, id).then(version => {\n        this.setState(version);\n        if (onReceiveData) onReceiveData(version);\n      });\n    }\n  };\n\n  render() {\n    const { model, rev } = this.props;\n    const { data, compareTo } = this.state;\n\n    if (!data) return null;\n    return (\n      <Page>\n        {rev && <Title>{`Version ${rev}`}</Title>}\n        <Cols>\n          <Content style={{ background: \"none\" }}>\n            <Outset>\n              <Output\n                fields={model.fields}\n                value={data}\n                compareTo={compareTo}\n              />\n            </Outset>\n          </Content>\n        </Cols>\n      </Page>\n    );\n  }\n}\n","import styled from \"styled-components/macro\";\n\nconst colors = {\n  grey: \"#aaa\",\n  yellow: \"#dfda00\",\n  green: \"#51c633\",\n  red: \"#f96054\"\n};\n\ntype P = {\n  color: keyof typeof colors;\n};\n\nconst StatusLight = styled(\"div\")`\n  width: 10px;\n  height: 10px;\n  flex-shrink: 0;\n  border-radius: 5px;\n  margin: 0 5px;\n  display: inline-block;\n  vertical-align: middle;\n  background-color: ${(p: P) => colors[p.color || \"grey\"]};\n`;\n\nexport default StatusLight;\n","import * as Cotype from \"../../../typings\";\nimport React from \"react\";\nimport TimeAgo from \"react-time-ago\";\nimport styled, { css, CSSProp } from \"styled-components/macro\";\nimport StatusLight from \"../common/StatusLight\";\nimport MoreButton from \"../common/MoreButton\";\nimport { withUser } from \"../auth/UserContext\";\nimport { isAllowed, Permission } from \"../auth/acl\";\nconst { publish } = Permission;\n\nconst Root = styled(\"div\")`\n  background: var(--dark-grey);\n  height: 100%;\n  border-left: 1px solid #f5f5f5;\n`;\nconst Author = styled(\"div\")`\n  color: #848484;\n  font-size: 0.75em;\n`;\n\nconst Status = styled(\"div\")`\n  position: absolute;\n  top: 50%;\n  right: 10px;\n  transform: translateY(-50%);\n  font-size: 0.75em;\n  color: #848484;\n  text-transform: uppercase;\n  display: flex;\n  align-items: center;\n`;\n\nconst Version = styled.div<{ css: CSSProp }>`\n  display: flex;\n  width: 100%;\n  position: relative;\n  color: #fff;\n  text-decoration: none;\n  color: inherit;\n  border-bottom: 1px solid #f5f5f5;\n  padding: 10px 15px;\n  box-sizing: border-box;\n  align-items: center;\n  background: #fff;\n  cursor: pointer;\n  display: block;\n  position: relative;\n  text-decoration: none;\n  color: inherit;\n`;\n\nconst activeClass = css`\n  background: var(--accent-color);\n  color: #fff;\n  & > div {\n    color: #fff;\n  }\n`;\n\nconst dateClass = css`\n  a > &:hover {\n    text-decoration: underline;\n  }\n`;\n\ntype VersionList = {\n  model: Cotype.Model;\n  versions: (Cotype.VersionItem & { published: boolean })[];\n  activeVersion?: number | string;\n  onSelectVersion: (v: Cotype.VersionItem) => void;\n  onUnpublish: () => void;\n  user: Cotype.Principal & Cotype.User;\n};\nfunction VersionList({\n  model,\n  versions,\n  activeVersion,\n  onSelectVersion,\n  onUnpublish,\n  user\n}: VersionList) {\n  if (!versions) return null;\n  const canPublish = isAllowed(user, model, publish);\n\n  const isSingleton = model.collection === \"singleton\";\n  return (\n    <Root>\n      {versions.map(v => (\n        <Version\n          key={v.rev}\n          css={activeVersion === v.rev ? activeClass : \"\"}\n          onClick={() => onSelectVersion(v)}\n        >\n          <TimeAgo className={dateClass} date={new Date(new Date(v.date))} />\n          {v.published && (\n            <Status>\n              <StatusLight color=\"green\" /> Published\n              {canPublish && !isSingleton && (\n                <MoreButton\n                  buttonStyle={{ paddingTop: 0, marginLeft: 6 }}\n                  actions={[\n                    {\n                      label: \"Unpublish\",\n                      onClick: () => onUnpublish()\n                    }\n                  ]}\n                />\n              )}\n            </Status>\n          )}\n          <Author>{v.author_name}</Author>\n        </Version>\n      ))}\n    </Root>\n  );\n}\n\nexport default withUser(VersionList);\n","import * as Cotype from \"../../../../typings\";\nimport React, { Component } from \"react\";\nimport History from \"./History\";\nimport SplitPane from \"../../common/SplitPane\";\nimport VersionList from \"../VersionList\";\n\ntype Props = {\n  id: string;\n  model: Cotype.Model;\n  versions: (Cotype.VersionItem & { published: boolean })[];\n  onSelect?: (rev: string) => void;\n  onUnpublish: () => void;\n};\n\ntype State = {\n  activeVersion?: string | number;\n};\nexport default class HistoryChooser extends Component<Props, State> {\n  state: State = {};\n\n  constructor(props) {\n    super(props);\n    const { versions } = this.props;\n    this.state = {\n      activeVersion:\n        versions && versions[0] ? String(versions[0].latest_rev - 1) : undefined\n    };\n  }\n\n  onSelectVersion = ({ rev }: Cotype.VersionItem) => {\n    this.setState({ activeVersion: rev });\n    if (this.props.onSelect) {\n      this.props.onSelect(String(rev));\n    }\n  };\n\n  render() {\n    const { model, versions, id, onUnpublish } = this.props;\n    const { activeVersion } = this.state;\n\n    if (!activeVersion) return null;\n\n    return (\n      <SplitPane width={300} primary=\"right\">\n        <VersionList\n          model={model}\n          versions={versions}\n          activeVersion={activeVersion}\n          onSelectVersion={this.onSelectVersion}\n          onUnpublish={onUnpublish}\n        />\n        <History\n          id={id}\n          rev={activeVersion}\n          model={model}\n          versions={versions}\n        />\n      </SplitPane>\n    );\n  }\n}\n","import * as Cotype from \"../../../../typings\";\nimport React, { Component } from \"react\";\nimport HistoryChooser from \"./HistoryChooser\";\nimport ModalDialog from \"../../common/ModalDialog\";\nimport Button from \"../../common/Button\";\nimport { paths } from \"../../common/icons\";\n\nconst historyStyle = {\n  width: \"80vw\",\n  height: \"90vh\",\n  background: \"#f5f5f5\",\n  maxWidth: 1600\n};\n\ntype Props = {\n  id: string;\n  rev?: string;\n  model: Cotype.Model;\n  versions?: (Cotype.VersionItem & { published: boolean })[];\n  onClose: () => void;\n  onUnpublish: () => void;\n  onRestore: (rev: string) => void;\n};\n\ntype State = {\n  rev: string | null;\n};\n\nexport default class HistoryModal extends Component<Props, State> {\n  onSelect = (rev: string) => {\n    this.setState({ rev });\n  };\n\n  onRestore = () => {\n    const { rev } = this.state;\n    if (rev) this.props.onRestore(rev);\n    else this.props.onClose();\n  };\n\n  render() {\n    const { model, id, versions, onClose, onUnpublish } = this.props;\n\n    if (!id || !versions || versions.length < 2) return null;\n\n    const actionButtons = [\n      <Button icon={paths.History} onClick={this.onRestore}>\n        Restore\n      </Button>\n    ];\n\n    return (\n      <ModalDialog\n        title={\"History\"}\n        onClose={onClose}\n        style={historyStyle}\n        bodyStyle={{ padding: 0 }}\n        actionButtons={actionButtons}\n      >\n        <HistoryChooser\n          id={id}\n          model={model}\n          versions={versions}\n          onSelect={this.onSelect}\n          onUnpublish={onUnpublish}\n        />\n      </ModalDialog>\n    );\n  }\n}\n","import * as Cotype from \"../../../typings\";\nimport React, { Component, Fragment } from \"react\";\nimport { Formik, FormikActions, FormikProps } from \"formik\";\nimport { Prompt, RouteComponentProps } from \"react-router-dom\";\nimport { withModelPaths } from \"../ModelPathsContext\";\nimport api from \"../api\";\nimport { Page, Cols, Content } from \"../common/page\";\nimport Sidebar from \"./ActionBar\";\nimport History from \"./History\";\nimport Schedule from \"../common/Schedule\";\nimport { Input } from \"./elements\";\nimport {titleCase} from \"title-case\";\nimport { getPreviewUrl } from \"../utils/helper\";\nimport styled from \"styled-components/macro\";\n\n\nexport const errorClass = \"error-field-label\";\n\nconst NewTag = styled(\"div\")`\n  color: var(--accent-color);\n  font-size: 1.4em;\n  text-transform: uppercase;\n  font-style: italic;\n  margin-top: -1.4em;\n  padding-left: 24px;\n`;\n\ntype Props = RouteComponentProps & {\n  clone?: string;\n  id?: string;\n  model: Cotype.Model;\n  versions?: (Cotype.VersionItem & { published: boolean })[];\n  onSave?: (record: { id: string; isUpdate: boolean; data: any }) => void;\n  onDelete?: (id: string) => void;\n  onDuplicate?: (id: string) => void;\n  onPublish?: () => void;\n  onUnpublish: () => void;\n  modelPaths: Cotype.ModelPaths;\n  baseUrls: Cotype.BaseUrls;\n};\n\ntype State = {\n  initialData?: any;\n  schedule?: any;\n  modal: null | \"history\" | \"schedule\";\n};\n\nclass Form extends Component<Props, State> {\n  state: State = {\n    modal: null\n  };\n  componentDidMount() {\n    this.initForm();\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (this.props.id !== prevProps.id) {\n      this.initForm();\n    }\n  }\n\n  initForm = () => {\n    const { clone, id, model, history } = this.props;\n    const contentId = clone || id;\n    if (id && history.location.state) {\n      // Hack to show tokens that have been generated by the server\n      // The state is set in List.onSave() when changing the url to /edit/{id}\n      this.setState({ initialData: history.location.state });\n      history.replace(history.location.pathname, null);\n    } else if (contentId) {\n      this.fetchData(contentId);\n    } else {\n      this.setState({\n        initialData: Input.getDefaultValue(model)\n      });\n    }\n  };\n\n  fetchData = (id: string) => {\n    const { model } = this.props;\n    if (id) {\n      api.load(model, id).then(res => {\n        const { data, visibleFrom, visibleUntil } = res;\n        this.setState({\n          initialData: data,\n          schedule: { visibleFrom, visibleUntil }\n        });\n      });\n    }\n  };\n\n  restore = (rev: string, setValues: (values: any) => void) => {\n    const { model, id } = this.props;\n    if (id && rev) {\n      api.loadVersion(model, id, rev).then(({ data }) => {\n        setValues(data);\n      });\n    }\n    this.setState({ modal: null });\n  };\n\n  onPreview = (form: FormikProps<any>, modelPreviewUrl: string) => {\n    const { baseUrls } = this.props;\n    const previewUrl = getPreviewUrl(\n      form.values,\n      `${baseUrls.preview ? baseUrls.preview : \"\"}${modelPreviewUrl}`\n    );\n    if (previewUrl) window.open(previewUrl);\n  };\n\n  submit = (form: any) => {\n    form.validateForm().then((errors: object) => {\n      const fields = Object.keys(errors);\n      const fieldCount = fields.length;\n      if (fieldCount) {\n        const { model } = this.props;\n        const fieldNames = Object.keys(errors).map((e, idx) => {\n          const { label } = model.fields[e];\n          const separator = idx < fieldCount - 1 ? `,` : `!`;\n          return `${label || titleCase(e)}${separator}`;\n        });\n\n        const error = `Please fix errors in the following field${\n          fieldCount === 1 ? \"\" : \"s\"\n        }: ${fieldNames}`;\n\n        const errorElement: HTMLElement | null = document.querySelector(\n          `.${errorClass}`\n        );\n\n        if (errorElement) {\n          errorElement.scrollIntoView({\n            behavior: \"smooth\",\n            inline: \"center\"\n          });\n        }\n        setTimeout(() => {\n          alert(error);\n        }, 400);\n      } else {\n        form.submitForm();\n      }\n    });\n  };\n\n  onSubmit = (\n    values: object,\n    { setSubmitting, setFieldError }: FormikActions<any>\n  ) => {\n    const { model, id, onSave } = this.props;\n    api\n      .save(model, id, values)\n      .then(res => {\n        const {\n          id: savedId,\n          data,\n          visibleFrom = null,\n          visibleUntil = null\n        } = res;\n\n        setSubmitting(false);\n        this.setState({\n          initialData: data,\n          schedule: { visibleFrom, visibleUntil }\n        });\n        if (onSave) onSave({ id: savedId, data, isUpdate: !!id });\n      })\n      .catch(err => {\n        const { status } = err;\n        if (status === 409) {\n          setSubmitting(false);\n          const { uniqueErrors, message }: any = err.body;\n          if (message) {\n            alert(message);\n          } else if (uniqueErrors) {\n            uniqueErrors.forEach(e =>\n              setFieldError(\n                e.field,\n                `This field value needs to be unique, but exists already on another ${model.singular}!`\n              )\n            );\n          }\n        } else {\n          setSubmitting(false);\n          alert(\"Something went wrong while submitting the form\");\n        }\n      });\n  };\n\n  get isNew() {\n    const { id, clone } = this.props;\n    return !id || clone;\n  }\n\n  get hasSchedule() {\n    const { schedule } = this.state;\n    return schedule && (schedule.visibleFrom || schedule.visibleUntil);\n  }\n\n  render() {\n    const {\n      model,\n      id,\n      clone,\n      versions,\n      onDuplicate,\n      onDelete,\n      onPublish,\n      onUnpublish\n    } = this.props;\n\n    const { modal, initialData } = this.state;\n\n    if (!initialData) {\n      return null;\n    }\n    return (\n      <Formik\n        initialValues={initialData}\n        validateOnChange={false}\n        validateOnBlur={false}\n        enableReinitialize\n        onSubmit={this.onSubmit}\n        render={(form: FormikProps<any>) => {\n          const {\n            dirty,\n            handleSubmit,\n            isSubmitting,\n            isValid,\n            errors,\n            setValues\n          } = form;\n\n          return (\n            <Fragment>\n              {id && modal === \"history\" && (\n                <History\n                  model={model}\n                  id={id}\n                  versions={versions}\n                  onUnpublish={onUnpublish}\n                  onRestore={rev => this.restore(rev, setValues)}\n                  onClose={() => this.setState({ modal: null })}\n                />\n              )}\n              {id && modal === \"schedule\" && (\n                <Schedule\n                  schedule={this.state.schedule}\n                  onClose={() => this.setState({ modal: null })}\n                  onSchedule={schedule => {\n                    return api.schedule(model, id, schedule).then(() => {\n                      this.setState({ modal: null, schedule });\n                    });\n                  }}\n                />\n              )}\n              <Sidebar\n                isNew={!id}\n                isDirty={dirty || !!clone}\n                isSubmitting={isSubmitting}\n                hasSchedule={this.hasSchedule}\n                model={model}\n                versions={versions}\n                onDuplicate={onDuplicate}\n                onDelete={onDelete}\n                onPublishChange={onPublish}\n                onUnpublish={onUnpublish}\n                onPreview={() => {\n                  if (model.urlPath) {\n                    this.onPreview(form, model.urlPath);\n                  }\n                }}\n                onHistory={() => {\n                  this.setState({ modal: \"history\" });\n                }}\n                onSchedule={() => {\n                  this.setState({ modal: \"schedule\" });\n                }}\n                submitForm={() => {\n                  this.submit(form);\n                }}\n                hasErrors={!isValid}\n                errors={errors as any}\n              />\n              <Page id=\"edit-form\">\n                <form onSubmit={handleSubmit}>\n                  <Prompt\n                    when={dirty}\n                    message=\"There are changes that have not been saved. Is it ok to leave the page?\"\n                  />\n                  <Cols>\n                    <Content style={{ padding: 0, width: \"100%\" }}>\n                      {this.isNew && <NewTag>new</NewTag>}\n                      <Input\n                        key={id || \"new\"}\n                        fields={model.fields}\n                        form={form}\n                        model={model}\n                        id={id}\n                      />\n                    </Content>\n                  </Cols>\n                </form>\n              </Page>\n            </Fragment>\n          );\n        }}\n      />\n    );\n  }\n}\n\nexport default withModelPaths(Form);\n","import * as Cotype from \"../../../../typings\";\nimport React, { Component } from \"react\";\nimport Sidebar from \"../ActionBar\";\nimport History from \"./History\";\nimport HistoryChooser from \"./HistoryChooser\";\nimport ModalDialog from \"../../common/ModalDialog\";\nimport { getPreviewUrl } from \"../../utils/helper\";\nimport { withModelPaths } from \"../../ModelPathsContext\";\n\nconst historyStyle = {\n  width: \"80vw\",\n  height: \"90vh\",\n  background: \"#f5f5f5\",\n  maxWidth: 1600\n};\n\ntype Props = {\n  id: string;\n  model: Cotype.Model;\n  versions?: (Cotype.VersionItem & { published: boolean })[];\n  onPublish?: () => void;\n  onUnpublish: () => void;\n  modelPaths: Cotype.ModelPaths;\n  baseUrls: Cotype.BaseUrls;\n};\n\ntype State = {\n  historyOpen: boolean;\n  formData: any;\n};\nclass ReadOnly extends Component<Props> {\n  state: State = {\n    historyOpen: false,\n    formData: null\n  };\n\n  onPreview = (modelPreviewUrl?: string) => {\n    const { formData } = this.state;\n    const { baseUrls } = this.props;\n    if (!formData || !modelPreviewUrl) return;\n\n    const previewUrl = getPreviewUrl(\n      formData.data,\n      `${baseUrls.preview ? baseUrls.preview : \"\"}${modelPreviewUrl}`\n    );\n    if (previewUrl) window.open(previewUrl);\n  };\n\n  get renderHistory() {\n    const { historyOpen } = this.state;\n    const { model, id, versions, onUnpublish } = this.props;\n\n    if (!historyOpen || !id || !versions || versions.length < 2) return null;\n\n    return (\n      <ModalDialog\n        title={\"History\"}\n        onClose={() => {\n          this.setState({ historyOpen: false });\n        }}\n        style={historyStyle}\n        bodyStyle={{ padding: 0 }}\n      >\n        <HistoryChooser\n          versions={versions}\n          id={id}\n          model={model}\n          onUnpublish={onUnpublish}\n        />\n      </ModalDialog>\n    );\n  }\n\n  render() {\n    const { id, model, versions, onPublish } = this.props;\n    return (\n      <div>\n        {this.renderHistory}\n        <Sidebar\n          model={model}\n          versions={versions}\n          onHistory={() => {\n            this.setState({ historyOpen: true });\n          }}\n          hasSchedule={false}\n          onPublishChange={onPublish}\n          onPreview={() => this.onPreview(model.urlPath)}\n        />\n        <History\n          onReceiveData={data => this.setState({ formData: data })}\n          versions={versions}\n          id={id}\n          rev={versions ? versions[0].rev : undefined}\n          model={model}\n        />\n      </div>\n    );\n  }\n}\n\nexport default withModelPaths(ReadOnly);\n","import * as Cotype from \"../../../typings\";\nimport React, { Component, Fragment } from \"react\";\nimport { match, Redirect, RouteComponentProps } from \"react-router-dom\";\n\nimport api from \"../api\";\nimport Form from \"./Form\";\nimport ReadOnlyHistory from \"./History/ReadOnly\";\nimport { withUser } from \"../auth/UserContext\";\nimport { isAllowed, Permission } from \"../auth/acl\";\nimport ConflictDialog from \"../common/ConflictDialog\";\nimport { VersionItem } from \"../../../typings\";\nimport basePath from \"../basePath\";\nimport { withModelPaths } from \"../ModelPathsContext\";\n\ntype Props = RouteComponentProps & {\n  user: Cotype.Principal & Cotype.User;\n  id: string;\n  model: Cotype.Model;\n  match: match<any>;\n  onDelete: (id) => Promise<Cotype.ErrorResponseBody | void>;\n  onSave?: (record: { id: any; data: any }) => void;\n  modelPaths: Cotype.ModelPaths;\n  baseUrls: Cotype.BaseUrls;\n};\nexport type conflictTypes = \"publish\" | \"unpublish\" | \"delete\" | \"media\";\ntype State = {\n  versions?: Cotype.VersionItem[];\n  itemNotFoundError: boolean;\n  conflictingRefs: VersionItem[] | null;\n  conflictType: conflictTypes;\n};\nclass Edit extends Component<Props, State> {\n  state: State = {\n    itemNotFoundError: false,\n    conflictingRefs: null,\n    conflictType: \"delete\"\n  };\n\n  componentDidMount() {\n    this.fetchVersions();\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    const { id } = this.props;\n    if (id !== prevProps.id) {\n      this.fetchVersions();\n    }\n  }\n\n  onSave = (record: any) => {\n    const { onSave } = this.props;\n    this.fetchVersions();\n    if (onSave) onSave(record);\n  };\n\n  onDelete = (record: any) => {\n    const { onDelete } = this.props;\n    onDelete(record).then(res => {\n      if (res && res.conflictingRefs) {\n        this.onConflict(res.conflictingRefs, \"delete\");\n      }\n    });\n  };\n\n  onConflict = (refs: VersionItem[], type: conflictTypes) => {\n    this.setState({\n      conflictingRefs: refs,\n      conflictType: type\n    });\n  };\n\n  fetchVersions = () => {\n    const { id, model } = this.props;\n    if (!model.versioned || !id) return;\n    api\n      .getVersions(model, id)\n      .then(versions => {\n        return this.setState({ versions });\n      })\n      .catch(err => {\n        if (err.status === 404) {\n          this.setState({ itemNotFoundError: true });\n        }\n      });\n  };\n\n  onUnpublish = () => {\n    const { model, id } = this.props;\n    if (id) {\n      api\n        .unpublish(model, id)\n        .then(() => {\n          this.fetchVersions();\n        })\n        .catch(err => {\n          if (err.status === 400) {\n            const { body } = err;\n            if (body && body.conflictingRefs) {\n              this.onConflict(body.conflictingRefs, \"unpublish\");\n            }\n          }\n        });\n    }\n  };\n\n  renderErrors = () => {\n    const { conflictingRefs, conflictType } = this.state;\n    if (!conflictingRefs || !conflictType) return null;\n    return (\n      <ConflictDialog\n        onClose={() => this.setState({ conflictingRefs: null })}\n        items={conflictingRefs!}\n        type={conflictType}\n      />\n    );\n  };\n\n  render() {\n    const { model, user, id, modelPaths } = this.props;\n    const { versions, itemNotFoundError } = this.state;\n    const canEdit = isAllowed(user, model, Permission.edit);\n\n    if (itemNotFoundError)\n      return (\n        <Redirect to={`${basePath}${modelPaths[model.type][model.name]}`} />\n      );\n\n    if (canEdit && model.writable) {\n      return (\n        <Fragment>\n          {this.renderErrors()}\n          <Form\n            versions={versions}\n            {...this.props}\n            onSave={this.onSave}\n            onPublish={this.fetchVersions}\n            onUnpublish={this.onUnpublish}\n            onDelete={this.onDelete}\n          />\n        </Fragment>\n      );\n    }\n\n    if (model.versioned && (!versions || !versions.length)) return null;\n    return (\n      <ReadOnlyHistory\n        versions={versions}\n        id={id}\n        model={model}\n        onPublish={this.fetchVersions}\n        onUnpublish={this.onUnpublish}\n      />\n    );\n  }\n}\n\nexport default withModelPaths(withUser(Edit));\n","import React from \"react\";\nimport styled from \"styled-components/macro\";\n\nconst Root = styled(\"div\")`\n  height: 100%;\n  position: relative;\n`;\n\nconst Text = styled(\"div\")`\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  width: 80%;\n  text-align: center;\n  overflow: hidden;\n  color: #848484;\n`;\n\nconst Heading = styled(\"div\")`\n  font-size: 1.8em;\n  margin-bottom: 0.5em;\n`;\n\nexport default function EmptyList() {\n  return (\n    <Root>\n      <Text>\n        <svg width=\"197\" height=\"170\">\n          <g fill=\"#848484\">\n            <path d=\"M140.33 131v35h-27.66v-21h-6.92C94.29 145 85 135.6 85 124v-21c0-3.87 3.1-7 6.92-7a6.96 6.96 0 0 1 6.91 7v21c0 3.92 3.12 7 6.92 7h6.92V61c0-7.73 6.19-14 13.83-14s13.83 6.27 13.83 14v56h6.92a6.96 6.96 0 0 0 6.92-7V96c0-3.87 3.1-7 6.91-7a6.96 6.96 0 0 1 6.92 7v14c0 11.6-9.29 21-20.75 21h-6.92zM22.9 31.33a3.9 3.9 0 0 1-3.9-3.91 3.9 3.9 0 0 1 3.9-3.92h31.15c4.3 0 7.8-3.5 7.8-7.83a7.81 7.81 0 0 0-7.8-7.84 7.6 7.6 0 0 0-5.49 2.31 3.78 3.78 0 0 1-5.53 0 3.96 3.96 0 0 1 0-5.56A15.63 15.63 0 0 1 54.05 0c8.6 0 15.58 7.01 15.58 15.67 0 8.65-6.97 15.66-15.58 15.66H22.9z\" />\n            <path d=\"M81.32 39.17a3.9 3.9 0 0 0 3.9-3.92 3.9 3.9 0 0 0-6.67-2.78 3.86 3.86 0 0 1-5.5 0 3.99 3.99 0 0 1 0-5.52 11.62 11.62 0 0 1 8.27-3.45C87.77 23.5 93 28.76 93 35.25S87.77 47 81.32 47H26.79a3.9 3.9 0 0 1-3.9-3.92 3.9 3.9 0 0 1 3.9-3.91h54.53zM4 170c-2.2 0-4-1.71-4-3.83a3.92 3.92 0 0 1 4-3.85l189-.32c2.2 0 4 1.71 4 3.83a3.92 3.92 0 0 1-4 3.85L4 170z\" />\n          </g>\n        </svg>\n        <Heading>No content yet</Heading>\n        Start filling the vast\n      </Text>\n    </Root>\n  );\n}\n","import React, { Component } from \"react\";\nimport { Formik, FormikActions, FormikProps } from \"formik\";\nimport { Cols, Content } from \"../common/page\";\nimport { Input } from \"../Edit/elements\";\nimport Button from \"../common/Button\";\nimport { paths } from \"../common/icons\";\nimport ModalDialog from \"../common/ModalDialog\";\nimport { Filter } from \"../utils/extractFilter\";\n\nexport const errorClass = \"error-field-label\";\nexport type FilterValue =\n  | string\n  | boolean\n  | number\n  | { id: number; model: string };\ntype Props = {\n  onSave: (values: {\n    field: string;\n    operation: string;\n    value: FilterValue;\n  }) => void;\n  onClose: () => void;\n  filter: Filter;\n  initial: { field: string; operation: string; value: FilterValue };\n};\ntype State = {\n  values: {\n    field: string;\n    operation: string;\n    value: FilterValue;\n  };\n};\n\nconst modalDialogStyle = {\n  width: \"80vw\",\n  background: \"#f5f5f5\",\n  maxWidth: 800\n};\nclass FilterModal extends Component<Props, State> {\n  state: State = {\n    values: {\n      field: \"none\",\n      operation: \"none\",\n      value: \"\"\n    }\n  };\n  constructor(props) {\n    super(props);\n    this.state.values = props.initial;\n    if (this.state.values.field !== \"none\") {\n      const filter = this.props.filter[this.state.values.field];\n      if (\n        filter.type === \"content\" &&\n        typeof this.state.values.value === \"number\"\n      ) {\n        this.state.values.value = {\n          id: this.state.values.value,\n          model: \"contentPages\"\n        };\n      }\n    }\n  }\n  onSubmit = (\n    values: {\n      field: string;\n      operation: string;\n      value: FilterValue;\n    },\n    { setSubmitting, setFieldError }: FormikActions<any>\n  ) => {\n    let val: FilterValue = \"\";\n    if (values.field === \"none\") {\n      setFieldError(\"field\", \"Please select a field\");\n      return;\n    }\n    if (values.operation === \"none\") {\n      setFieldError(\"operation\", \"Please select a comparison\");\n      return;\n    }\n    if (values.value === null) {\n      values.value = \"\";\n    }\n    if (typeof values.value === \"boolean\") {\n      val = !!values.value;\n    } else if (typeof values.value === \"object\") {\n      val = values.value;\n    } else if (typeof values.value === \"string\") {\n      val = values.value.trim();\n    } else {\n      val = values.value;\n    }\n    if (val === \"\") {\n      setFieldError(\"value\", \"Please fill out a value\");\n      return;\n    }\n    this.props.onSave({\n      ...values,\n      value: val\n    });\n  };\n  onDeleteFilter = () => {\n    this.props.onSave({\n      field: \"none\",\n      operation: \"none\",\n      value: \"\"\n    });\n  };\n\n  render() {\n    let filterModel: any = {\n      field: {\n        type: \"string\",\n        input: \"select\",\n        label: \"Field:\",\n        values: [\n          { label: \"please choose\", value: \"none\", disabled: true },\n          ...Object.entries(this.props.filter).map(([key, val]: any) => ({\n            label: val.label || key.charAt(0).toUpperCase() + key.slice(1),\n            value: key\n          }))\n        ]\n      }\n    };\n    const { values } = this.state;\n    if (values.field !== \"none\") {\n      filterModel = {\n        ...filterModel,\n        operation: {\n          type: \"string\",\n          input: \"select\",\n          label: \"Comparison operator:\",\n          values: [\"=\", \"contains\"]\n        },\n        value: {\n          type: \"string\",\n          label: \"Value\"\n        }\n      };\n      const filter = this.props.filter[values.field];\n      if (filter.input === \"date\" || filter.type === \"date\") {\n        filterModel.operation.values = [\">\", \">=\", \"=\", \"<=\", \"<\"];\n        filterModel.value.input = \"date\";\n      }\n      if (filter.input === \"number\" || filter.type === \"number\") {\n        filterModel.operation.values = [\">\", \">=\", \"=\", \"<=\", \"<\"];\n        filterModel.value.input = \"number\";\n      }\n      if (filter.type === \"list\") {\n        filterModel.operation.values = [\"=\", \"contains\"];\n        filterModel.value.label = \"value of list entry\";\n      }\n      if (filter.type === \"content\") {\n        filterModel.operation.values = [\"=\"];\n        filterModel.value.label = \"referenced document\";\n        filterModel.value.type = \"content\";\n        filterModel.value.models = filter.models || [];\n      }\n      if (filter.type === \"boolean\") {\n        filterModel.operation.values = [\"=\"];\n        filterModel.value.type = \"boolean\";\n      }\n      filterModel.operation.values.unshift({\n        label: \"please choose\",\n        value: \"none\"\n      });\n    }\n\n    return (\n      <Formik\n        key={values.field}\n        initialValues={values}\n        validate={vals => this.setState({ values: vals })}\n        onSubmit={this.onSubmit}\n        render={(form: FormikProps<any>) => {\n          const { handleSubmit } = form;\n          const actions = [\n            <Button icon={paths.Trash} onClick={this.onDeleteFilter} light>\n              Clear\n            </Button>,\n            <Button icon={paths.Filter} onClick={handleSubmit as any}>\n              Apply\n            </Button>\n          ];\n          return (\n            <ModalDialog\n              onClose={this.props.onClose}\n              title=\"Filter\"\n              style={modalDialogStyle}\n              actionButtons={actions}\n            >\n              <form onSubmit={handleSubmit}>\n                <Cols>\n                  <Content style={{ padding: 0 }}>\n                    <Input\n                      key={\"filterModal\"}\n                      fields={filterModel}\n                      form={form}\n                    />\n                  </Content>\n                </Cols>\n              </form>\n            </ModalDialog>\n          );\n        }}\n      />\n    );\n  }\n}\n\nexport default FilterModal;\n","import * as Cotype from \"../../../typings\";\n/**\n * Visitor to recursively walk through a content object.\n */\nimport _ from \"lodash\";\n\ntype Visitor = {\n  [key: string]: (\n    value: any,\n    field: any,\n    deleteFunc: () => void,\n    stringPath: string\n  ) => void;\n};\n\nexport default function visit(obj: any, model: Cotype.Model, visitor: Visitor) {\n  if (!obj) return;\n  const walk = (\n    m: Cotype.Type,\n    value: any,\n    key?: string,\n    parent?: object,\n    stringPath: string = \"\"\n  ) => {\n    if (!m) return;\n    if (m.type === \"object\") {\n      Object.keys(m.fields).forEach(fieldKey =>\n        walk(\n          m.fields[fieldKey],\n          (value || {})[fieldKey],\n          fieldKey,\n          value,\n          stringPath + key + \".\"\n        )\n      );\n    }\n    if (m.type === \"list\") {\n      if (Array.isArray(value))\n        value.forEach((item, i: number) =>\n          walk(m.item, item.value, String(i), value, stringPath + key + \".\")\n        );\n    }\n    if (m.type === \"union\") {\n      if (value) {\n        const { _type } = value;\n        walk(\n          m.types[_type],\n          value,\n          undefined,\n          undefined,\n          stringPath + key + \".\"\n        );\n      }\n    }\n    if (m.type === \"immutable\") {\n      walk(m.child, value, key, parent, stringPath);\n    }\n    if (m.type in visitor) {\n      const ret = visitor[m.type](\n        value,\n        m,\n        () => {\n          if (parent && key) {\n            _.set(parent, key, undefined);\n          }\n        },\n        stringPath + key\n      );\n      if (typeof ret !== \"undefined\") {\n        if (parent && key) _.set(parent, key, ret);\n      }\n    }\n  };\n  Object.keys(model.fields).forEach(key =>\n    walk(model.fields[key], obj[key] || (obj.data && obj.data[key]), key, obj)\n  );\n}\n","import visit from \"./visit\";\nimport { Model } from \"../../../typings\";\n\nconst getAlwaysUniqueFields = (model: Model): string[] => {\n  const uniqueFields: string[] = [...(model.uniqueFields || [])];\n  visit({}, model, {\n    position(s: string, f, d, stringPath) {\n      if (stringPath) uniqueFields.push(stringPath);\n    }\n  });\n  return uniqueFields;\n};\n\nexport default getAlwaysUniqueFields\n\n","import * as Cotype from \"../../../typings\";\nimport visit from \"./visit\";\nimport getAlwaysUniqueFields from \"./getAlwaysUniqueFields\";\n\nexport type Filter = {\n  [s: string]: {\n    input?: string;\n    label?: string;\n    type: string;\n    models?: string[];\n  };\n};\n\nconst scalars = [\"string\", \"number\", \"boolean\"];\nconst extractFilter = (model: Cotype.Model): Filter => {\n  const filter: Filter = {};\n  if (model.type !== \"content\" || model.external) {\n    return filter;\n  }\n  const uniqueFields = [...getAlwaysUniqueFields(model), model.title];\n  const setField = (\n    field: Cotype.Field,\n    path: string,\n    forceIndex?: boolean\n  ) => {\n    if (!(\"index\" in field) && !uniqueFields.includes(path) && !forceIndex) {\n      return;\n    }\n    const models = [\n      ...(\"models\" in field && field.models ? field.models : []),\n      ...(\"model\" in field && field.model ? [field.model] : [])\n    ];\n    filter[path] = {\n      type: field.type,\n      label: field.label\n    };\n    if (\"input\" in field) {\n      filter[path].input = field.input;\n    }\n    if (models.length > 0) {\n      filter[path].models = models;\n    }\n  };\n  visit({}, model, {\n    string(s, field, d, stringPath) {\n      setField(field, stringPath);\n    },\n    number(s, field, d, stringPath) {\n      setField(field, stringPath);\n    },\n    boolean(s, field, d, stringPath) {\n      setField(field, stringPath);\n    },\n    list(s, field, d, stringPath) {\n      if (scalars.includes(field.item.type)) {\n        setField(field, stringPath, field.item.index);\n      }\n    },\n    content(s, field, d, stringPath) {\n      setField(field, stringPath);\n    }\n  });\n  return filter;\n};\n\nexport default extractFilter;\n","import * as Cotype from \"../../../typings\";\nimport React, { Component } from \"react\";\nimport api from \"../api\";\nimport EmptyList from \"./EmptyList\";\nimport { RenderInfo } from \"../common/ScrollList\";\nimport { Link, match as Match } from \"react-router-dom\";\nimport ScrollList from \"../common/ScrollList\";\nimport Item from \"./Item\";\nimport FilterModal, { FilterValue } from \"./FilterModal\";\nimport styled, { css } from \"styled-components/macro\";\nimport { paths } from \"../common/icons\";\nimport Icon from \"../common/Icon\";\nimport Button from \"../common/Button\";\nimport extractFilter from \"../utils/extractFilter\";\nimport { testable } from \"../utils/helper\";\n\ntype State = {\n  lastRequestedIndex: number;\n  items: Cotype.Item[];\n  total?: number;\n  selected?: string;\n  filterOpen: boolean;\n  showFunc: (item: Cotype.Item) => boolean;\n  filterValues: {\n    field: string;\n    operation: string;\n    value: FilterValue;\n  };\n  searchTerm: string;\n};\n\ntype Props = {\n  edit: boolean;\n  model: Cotype.Model;\n  match: Match<any>;\n};\n\nconst FilterBar = styled(\"div\")`\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12);\n  box-sizing: border-box;\n  position: sticky;\n  top: 0;\n  width: 100%;\n  background: #fff;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  z-index: 2;\n  padding: 0.65em 1em;\n  > form {\n    display: flex;\n    width: 100%;\n    justify-content: space-between;\n    align-items: center;\n  }\n`;\nconst InvisibleInput = styled(\"input\")<{ hasValue: boolean }>`\n  border: none;\n  color: var(--primary-color);\n  text-align: right;\n  width: 100%;\n  height: 2em;\n  outline: none;\n  border-bottom: 1px solid transparent;\n  &:focus {\n    border-bottom: 1px solid var(--primary-color);\n  }\n  ${p =>\n    p.hasValue &&\n    css`\n      border-bottom: 1px solid var(--primary-color);\n    `}\n`;\n\nconst modelActionButtons = css`\n  background: none;\n  padding-right: 0;\n  & > svg {\n    color: var(--primary-color);\n  }\n  :hover {\n    background: none;\n    & > svg {\n      color: var(--accent-color);\n    }\n  }\n`;\n\nconst StyledLink = styled(Link)`\n  display: inline-flex;\n  align-items: center;\n  padding: 0.7em 1em;\n  margin-right: 1em;\n  border-radius: 3px;\n  text-decoration: none;\n  text-transform: uppercase;\n  white-space: nowrap;\n  font-weight: 500;\n  font-size: 0.8em;\n  background: var(--primary-color);\n  :hover {\n    background: var(--accent-color);\n  }\n  color: #fff;\n  & svg {\n    margin: 0 2px 0 -6px;\n  }\n`;\n\nexport default class ListWithItems extends Component<Props, State> {\n  state: State = {\n    lastRequestedIndex: 0,\n    items: [],\n    filterOpen: false,\n    showFunc: () => true,\n    filterValues: {\n      field: \"none\",\n      operation: \"none\",\n      value: \"\"\n    },\n    searchTerm: \"\"\n  };\n\n  startIndex = 0;\n  searchRef = React.createRef<HTMLInputElement>();\n  componentDidMount() {\n    this.fetchNextData();\n  }\n\n  refresh(searchTerm: string = this.state.searchTerm) {\n    this.fetchData(this.startIndex, 50, searchTerm);\n  }\n\n  delete = (id: string) => {\n    const items = this.state.items.slice();\n    const total = this.state.total || 0;\n    const item = items.find(i => Number(i.id) === Number(id));\n    if (item && total > 0) {\n      items.splice(items.indexOf(item), 1);\n      this.setState({ items, total: total - 1 });\n    }\n  };\n\n  fetchNextData = () => {\n    this.fetchData(this.state.lastRequestedIndex, 50);\n  };\n\n  fetchData = (\n    offset: number,\n    limit = 50,\n    searchTerm: string = this.state.searchTerm\n  ) => {\n    searchTerm = searchTerm.trim();\n    const { model } = this.props;\n    const { items } = this.state;\n    this.setState({ lastRequestedIndex: offset + limit });\n    api\n      .list(\n        model,\n        { offset, limit, search: { term: searchTerm, scope: \"title\" } },\n        this.createFilterCriterita()\n      )\n      .then(res => {\n        this.setState({\n          searchTerm,\n          total: res.total,\n          items: items.slice(0, offset).concat(res.items)\n        });\n      });\n  };\n\n  onRowsRendered = ({ startIndex, overscanStopIndex }: RenderInfo) => {\n    this.startIndex = startIndex;\n    // Lazy-load next batch of items\n    if (overscanStopIndex >= this.state.lastRequestedIndex)\n      this.fetchNextData();\n  };\n\n  closeFilter = () =>\n    this.setState(\n      {\n        filterOpen: false,\n        showFunc: () => true,\n        filterValues: {\n          field: \"none\",\n          operation: \"none\",\n          value: \"\"\n        }\n      },\n      () => this.refresh()\n    );\n  openFilter = () => this.setState({ filterOpen: true });\n  setFilter = values => {\n    if (values.field === \"none\" || values.operation === \"none\") {\n      return this.closeFilter();\n    }\n    this.setState(\n      {\n        filterOpen: false,\n        filterValues: values\n      },\n      () => this.refresh()\n    );\n  };\n  createFilterCriterita = () => {\n    const { filterValues } = this.state;\n    if (filterValues.field === \"none\" || filterValues.operation === \"none\") {\n      return {};\n    }\n\n    let operation = \"eq\";\n    let value =\n      typeof filterValues.value === \"object\"\n        ? filterValues.value.id\n        : filterValues.value;\n    if (filterValues.operation === \">\") {\n      operation = \"gt\";\n    }\n    if (filterValues.operation === \"<\") {\n      operation = \"lt\";\n    }\n    if (filterValues.operation === \">=\") {\n      operation = \"gte\";\n    }\n    if (filterValues.operation === \"<=\") {\n      operation = \"lte\";\n    }\n    if (filterValues.operation === \"contains\") {\n      operation = \"like\";\n      value = `%${value}%`;\n    }\n    return {\n      [`data.${filterValues.field}`]: {\n        [operation]: value\n      }\n    };\n  };\n  parseFilterValue = (fieldData, value) => {\n    if (fieldData.input === \"date\" || fieldData.type === \"date\") {\n      return new Date(value).toLocaleDateString();\n    }\n    if (fieldData.type === \"boolean\") {\n      return value.toString();\n    }\n    return value;\n  };\n\n  onSearch = (e: any) => {\n    e.preventDefault();\n    const { searchTerm } = this.state;\n    const term = e.target.elements.namedItem(\"searchTerm\").value;\n    if (!term && !searchTerm) {\n      if (this.searchRef.current) {\n        this.searchRef.current.focus();\n      }\n      return;\n    }\n    this.refresh(term);\n  };\n\n  render() {\n    const { edit, match } = this.props;\n    const { total, filterOpen, filterValues, searchTerm, items } = this.state;\n\n    const filter = extractFilter(this.props.model);\n    return (\n      <>\n        <FilterBar>\n          {edit && (\n            <StyledLink {...testable(\"add-button\")} to={`${match.url}/edit`}>\n              <Icon path={paths.BigPlus} />\n              Add\n            </StyledLink>\n          )}\n          <form onSubmit={this.onSearch}>\n            <InvisibleInput\n              type=\"text\"\n              name=\"searchTerm\"\n              ref={this.searchRef}\n              autoComplete=\"off\"\n              defaultValue={searchTerm}\n              hasValue={!!searchTerm.trim()}\n            />\n            <Button\n              css={modelActionButtons}\n              icon={paths.Search}\n              type=\"submit\"\n            />\n          </form>\n          {Object.keys(filter).length > 0 && (\n            <Button\n              css={modelActionButtons}\n              icon={\n                filterValues.field === \"none\"\n                  ? paths.Filter\n                  : paths.FilterRemove\n              }\n              type=\"button\"\n              onClick={this.openFilter}\n            />\n          )}\n        </FilterBar>\n        {filterOpen && (\n          <FilterModal\n            onClose={this.closeFilter}\n            filter={filter}\n            onSave={this.setFilter}\n            initial={filterValues}\n          />\n        )}\n        <div style={{ height: \"100%\", overflow: \"auto\" }}>\n          {searchTerm || (total && total > 0) || filterValues.value ? (\n            <ScrollList\n              key={searchTerm}\n              rowCount={total || 0}\n              items={items}\n              onRowsRendered={this.onRowsRendered}\n              renderRow={({ key, index, style }) => {\n                const item = items[index];\n                if (!item) return <div style={style} />;\n                return (\n                  <Item\n                    baseUrl={this.props.match.url}\n                    {...item}\n                    key={`${key}-${item.id}`}\n                    index={index}\n                    style={style}\n                  />\n                );\n              }}\n            />\n          ) : (\n            <EmptyList />\n          )}\n        </div>\n      </>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport styled from \"styled-components/macro\";\nimport Button from \"./common/Button\";\nimport { paths } from \"./common/icons\";\nimport { HEIGHT as HEADER_HEIGHT } from \"./Header\";\n\nconst Container = styled(\"div\")`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  height: calc(100% - ${HEADER_HEIGHT});\n  margin: 1em;\n`;\n\nconst StyledButton = styled(Button)`\n  margin-top: 13rem;\n`;\n\ntype State = {\n  hasError: boolean;\n};\nexport default class ErrorBoundary extends Component<{}, State> {\n  static getDerivedStateFromError(error) {\n    // Update state so the next render will show the fallback UI.\n    return { hasError: true };\n  }\n\n  constructor(props) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  componentDidCatch(error, info) {\n    console.error(error);\n  }\n\n  render() {\n    if (this.state.hasError) {\n      return (\n        <Container>\n          <h2>Ups, something went wrong.</h2>\n          <p>\n            If you encounter this problem more then once, please let the IT guy\n            know!\n          </p>\n          <StyledButton\n            icon={paths.Reload}\n            onClick={() => window.location.reload()}\n          >\n            Reload\n          </StyledButton>\n        </Container>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n","import { ModelOpts } from \"../../../typings\";\nimport styled from \"styled-components\";\nimport React, { useEffect, useState } from \"react\";\nconst getCookie = (name: string): string | null => {\n  const nameEQ = name + \"=\";\n  const ca = document.cookie.split(\";\");\n  // tslint:disable-next-line:prefer-for-of\n  for (let i = 0; i < ca.length; i++) {\n    let c = ca[i];\n    while (c.charAt(0) === \" \") c = c.substring(1, c.length);\n    if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);\n  }\n  return null;\n};\nconst IFrame = styled.iframe`\n  width: 100%;\n  height: 100%;\n`;\nexport const IFrameView: React.FC<ModelOpts[\"iframeOptions\"]> = props => {\n  const [session, setSession] = useState<string>(\"\");\n\n  useEffect(() => {\n    const cookie = getCookie(\"session\");\n    if (cookie) {\n      setSession(cookie);\n    }\n  }, [setSession]);\n  return (\n    <IFrame\n      src={`${props.url.replace(\"{sessionID}\", session)}`}\n      frameBorder={0}\n    />\n  );\n};\n","import { Model, Principal, User, Item, Data } from \"../../../typings\";\nimport React, { Component, Fragment } from \"react\";\nimport { Route, Switch, match as matchType, Redirect } from \"react-router-dom\";\nimport { History } from \"history\";\nimport SplitPane from \"../common/SplitPane\";\nimport { Background } from \"../common/page\";\nimport Edit from \"../Edit\";\nimport View from \"./List\";\nimport api from \"../api\";\nimport { isAllowed, Permission } from \"../auth/acl\";\nimport { withUser } from \"../auth/UserContext\";\nimport ErrorBoundary from \"../ErrorBoundary\";\nimport { IFrameView } from \"./IFrameView\";\n\nenum Collection {\n  IFrame = \"iframe\",\n  Singleton = \"singleton\",\n  None = \"none\"\n}\n\ntype Props = {\n  user: (Principal & User) | null;\n  model: Model;\n  match: matchType<any>;\n  history: History;\n  onChange?: (model: Model, id: string, data: Data) => void;\n};\n\ntype State = {\n  singletonData: Item | null;\n};\nclass List extends Component<Props, State> {\n  listView: any = React.createRef();\n\n  state: State = {\n    singletonData: null\n  };\n\n  constructor(props) {\n    super(props);\n\n    if (props.model.collection === Collection.Singleton) {\n      this.fetchSingleton();\n    }\n  }\n\n  fetchSingleton = () => {\n    const { model } = this.props;\n    api.list(model, { limit: 1 }).then(({ items }) => {\n      if (items.length) {\n        const [item] = items;\n        this.setState({ singletonData: item });\n      }\n    });\n  };\n\n  onSave = ({ id, isUpdate, data }: any) => {\n    const { match, history, model, onChange } = this.props;\n    if (!isUpdate) {\n      history.replace(`${match.url}/edit/${id}`, data);\n    }\n    if (onChange) onChange(model, id, data);\n    this.listView.current!.refresh();\n  };\n\n  duplicate = (id: string) => {\n    const { match, history } = this.props;\n    history.replace(`${match.url}/clone/${id}`);\n  };\n\n  delete = (id: number) => {\n    const { match, model, history } = this.props;\n    return api\n      .del(`/${model.type}/${model.name}/${id}`)\n      .then(() => {\n        this.listView.current!.delete(id);\n        history.replace(match.url);\n      })\n      .catch(err => {\n        if (err.status === 409) {\n          const { message } = err.body;\n          alert(message);\n        }\n        if (err.status === 400) {\n          return err.body;\n        }\n      });\n  };\n\n  getEditProps = (routeProps: any) => {\n    const { id, clone } = routeProps.match.params;\n    if (clone) {\n      return {\n        clone\n      };\n    }\n    return {\n      id,\n      onDuplicate: () => this.duplicate(id),\n      onDelete: () => this.delete(Number(id))\n    };\n  };\n\n  renderEdit = (props: any) => {\n    return (\n      <Edit\n        {...props}\n        model={this.props.model}\n        onSave={this.onSave}\n        {...this.getEditProps(props)}\n      />\n    );\n  };\n\n  renderSingletonEdit = (props: any) => {\n    const { singletonData } = this.state;\n\n    return (\n      <Edit\n        {...props}\n        model={this.props.model}\n        id={singletonData ? singletonData.id : undefined}\n        onSave={() => {\n          this.fetchSingleton();\n        }}\n      />\n    );\n  };\n\n  render() {\n    const { model, match, user } = this.props;\n    if (model.collection === Collection.None) {\n      return null;\n    }\n    if (!user) return null;\n    const edit = isAllowed(user, model, Permission.edit);\n\n    if (model.collection === Collection.IFrame && model.iframeOptions) {\n      return <IFrameView {...model.iframeOptions} />;\n    }\n    if (model.collection === Collection.Singleton) {\n      return (\n        <ErrorBoundary>\n          <Switch>\n            <Route exact path={match.url} render={this.renderSingletonEdit} />\n            <Redirect to={match.url} />\n          </Switch>\n        </ErrorBoundary>\n      );\n    }\n\n    return (\n      <ErrorBoundary>\n        <SplitPane width={320}>\n          <Background>\n            <View edit={edit} model={model} match={match} ref={this.listView} />\n          </Background>\n          <Fragment>\n            <ErrorBoundary>\n              <Switch>\n                <Route\n                  path={`${match.url}/edit/:id?`}\n                  render={this.renderEdit}\n                />\n                <Route\n                  path={`${match.url}/clone/:clone`}\n                  render={this.renderEdit}\n                />\n              </Switch>\n            </ErrorBoundary>\n          </Fragment>\n        </SplitPane>\n      </ErrorBoundary>\n    );\n  }\n}\n\nexport default withUser(List);\n","import styled from \"styled-components/macro\";\n\nconst Sidebar = styled(\"div\")`\n  height: 100%;\n  box-sizing: border-box;\n  background-color: #444950;\n  padding-top: 20px;\n`;\n\nexport default Sidebar;\n","import React, { Component } from \"react\";\nimport styled, { css } from \"styled-components/macro\";\nimport Icon from \"../common/icons\";\nimport { testable } from \"../utils/helper\";\n\nconst active = css`\n  background-color: hsla(0, 0%, 100%, 0.1);\n  cursor: pointer;\n`;\n\nconst GroupHeader = styled(\"div\")`\n  display: block;\n  color: #e8e8e8;\n  text-decoration: none;\n  padding: 12px 18px;\n  display: flex;\n  align-items: center;\n  padding-left: ${(p: P) => `${p.level * 20}px`};\n  :hover {\n    ${active};\n  }\n`;\n\ntype Icon = {\n  expanded: boolean;\n};\nconst ChevronRightIcon = styled(Icon.ChevronRight)<Icon>`\n  margin-left: -10px;\n  margin-right: 2px;\n  transform: ${p => (p.expanded ? \"rotate(90deg)\" : \"none\")};\n`;\n\ntype P = {\n  level: number;\n};\n\nconst GroupChildren = styled(\"div\")`\n  & > div > a {\n    padding-left: ${(p: P) => `${p.level * 20}px`};\n  }\n`;\n\ntype Props = {\n  children: any;\n  level: number;\n  initialOpen?: boolean;\n};\ntype State = {\n  open: boolean;\n};\nexport default class SidebarGroup extends Component<Props, State> {\n  state: State = {\n    open: false\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      open: props.initialOpen\n    };\n  }\n\n  toggleOpen = () => {\n    this.setState(state => ({ open: !state.open }));\n  };\n\n  render() {\n    const { level } = this.props;\n    const [group, children] = this.props.children;\n    const { open } = this.state;\n    return (\n      <div>\n        <GroupHeader\n          {...testable(\"sidebar-group\")}\n          onClick={this.toggleOpen}\n          level={level}\n        >\n          <ChevronRightIcon expanded={open} />\n          {group}\n        </GroupHeader>\n        {open && <GroupChildren level={level + 1}>{children}</GroupChildren>}\n      </div>\n    );\n  }\n}\n","import React from \"react\";\nimport { NavLink, NavLinkProps } from \"react-router-dom\";\nimport styled, { css } from \"styled-components/macro\";\n\nconst active = css`\n  background-color: hsla(0, 0%, 100%, 0.1);\n`;\n\nconst StyledNavLink = styled(NavLink)<NavLinkProps>`\n  display: block;\n  color: #e8e8e8;\n  text-decoration: none;\n  padding: 12px 18px;\n  :hover {\n    ${active};\n  }\n  &.active {\n    ${active};\n  }\n`;\n\nexport default function SidebarLink(props: NavLinkProps) {\n  return <StyledNavLink {...props} />;\n}\n","import { Model, NavigationItem } from \"../../typings\";\nimport React, { Component } from \"react\";\nimport basePath from \"./basePath\";\nimport Sidebar from \"./common/Sidebar\";\nimport SidebarGroup from \"./common/SidebarGroup\";\nimport SidebarLink from \"./common/SidebarLink\";\nimport { testable } from \"./utils/helper\";\n\ntype Props = {\n  models: Model[];\n  navigation: NavigationItem[];\n  match: { params: { type: string } };\n};\n\ntype State = {\n  openGroup: string | null;\n};\nexport default class ModelsSidebar extends Component<Props, State> {\n  state: State = {\n    openGroup: null\n  };\n\n  toggleGroup = (group: string) => {\n    this.setState(state => ({\n      openGroup: state.openGroup === group ? null : group\n    }));\n  };\n\n  containsModel = (sidebar: NavigationItem[], model: string) => {\n    return sidebar.some(s => {\n      if (s.type === \"model\" && s.model === model) return true;\n      if (s.type === \"group\") return this.containsModel(s.items, model);\n      return false\n    });\n  };\n\n  renderSidebar = (s: NavigationItem, level?: number) => {\n    const { match } = this.props;\n    const { type } = match.params;\n    let selected = false;\n    if (s.type === \"model\") {\n      return (\n        <div key={s.model}>\n          <SidebarLink to={`${basePath}${s.path!}`}>{s.name}</SidebarLink>\n        </div>\n      );\n    }\n    if (s.items) {\n      if (type) selected = this.containsModel(s.items, type);\n      level = level ? level : 0;\n      level++;\n      return (\n        <SidebarGroup key={s.name} level={level} initialOpen={selected}>\n          {s.name}\n          {s.items.map(n => this.renderSidebar(n, level))}\n        </SidebarGroup>\n      );\n    }\n  };\n\n  render() {\n    const { navigation } = this.props;\n\n    if (!navigation.length) {\n      return null;\n    }\n\n    return (\n      <Sidebar {...testable(\"models-sidebar\")} style={{ overflowY: \"scroll\" }}>\n        {navigation.map(n => this.renderSidebar(n))}\n      </Sidebar>\n    );\n  }\n}\n","import { Model } from \"../../typings\";\nimport React from \"react\";\nconst ModelsContext = React.createContext<Model[]>([]);\nexport default ModelsContext;\n\nexport function withModels(Component) {\n  return props => (\n    <ModelsContext.Consumer>\n      {models => <Component {...props} models={models} />}\n    </ModelsContext.Consumer>\n  );\n}\n","import { Model, NavigationItem, Data } from \"../../typings\";\nimport React from \"react\";\nimport { Switch, Route, match as matchType, Redirect } from \"react-router-dom\";\nimport SplitPane from \"./common/SplitPane\";\nimport Empty from \"./Empty\";\nimport List from \"./List/index\";\nimport ModelsSidebar from \"./ModelsSidebar\";\nimport ModelsContext from \"./ModelsContext\";\n\ntype Props = {\n  match: matchType<any>;\n  models: Model[];\n  navigation: NavigationItem[];\n  onChange?: (model: Model, id: string, data: Data) => void;\n};\nexport default function Models({ match, models, navigation, onChange }: Props) {\n  return (\n    <ModelsContext.Provider value={models}>\n      <SplitPane width={200}>\n        <Route\n          path={`${match.path}/:type?`}\n          render={p => (\n            <ModelsSidebar\n              models={models}\n              navigation={navigation}\n              match={p.match}\n            />\n          )}\n        />\n\n        <Switch>\n          <Route\n            path={`${match.path}/:type`}\n            render={props => {\n              const { type } = props.match.params;\n              const model = models.find(m => m.name === type);\n              if (!model) {\n                console.error(\"Unknown model: \" + type);\n                console.error(\"Redirect to: \" + match.path);\n                return <Redirect to={`${match.path}`} />;\n              }\n              return (\n                <List key={type} model={model} onChange={onChange} {...props} />\n              );\n            }}\n          />\n          <Route path={match.path} component={Empty} />\n        </Switch>\n      </SplitPane>\n    </ModelsContext.Provider>\n  );\n}\n","import React, { Component } from \"react\";\nimport { Formik, FormikActions, FormikProps } from \"formik\";\nimport styled from \"styled-components/macro\";\n\nimport api from \"../api\";\nimport { Field, Label, Input, Error, Button } from \"../common/styles\";\n\nconst Lock = () => (\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width=\"24\"\n    height=\"24\"\n    viewBox=\"0 0 24 24\"\n  >\n    <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n    <path\n      d=\"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z\"\n      fill=\"#fff\"\n    />\n  </svg>\n);\n\nconst Circle = styled(\"div\")`\n  width: 42px;\n  height: 42px;\n  background: var(--accent-color);\n  border-radius: 50%;\n  margin: auto;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n`;\n\nconst Root = styled(\"div\")`\n  display: flex;\n  height: 100%;\n  align-items: center;\n  justify-content: center;\n  background-size: cover;\n  background-image: ${process.env.REACT_APP_TEST_ENV\n    ? \"none\"\n    : `url(https://source.unsplash.com/collection/2339015/${\n        window.innerWidth\n      }x${window.innerHeight})`};\n`;\n\nconst Form = styled(\"form\")`\n  border-radius: 3px;\n  background: #fff;\n  padding: 30px;\n  display: flex;\n  flex-direction: column;\n  flex-basis: 350px;\n  box-shadow: 0 0 20px rgba(0, 0, 0, 0.25);\n`;\n\ntype Values = {\n  email: string;\n  password: string;\n};\n\ntype Props = {\n  onSuccess: (arg: any) => void;\n};\n\nexport default class Login extends Component<Props> {\n  onSubmit = (values: Values, { setSubmitting }: FormikActions<Values>) => {\n    api.post(\"/login\", values).then(\n      user => {\n        setSubmitting(false);\n        this.props.onSuccess(user);\n      },\n      errors => {\n        setSubmitting(false);\n        // Maybe transform your API's errors into the same shape as Formik's\n        // setErrors(transformMyApiErrors(errors));\n        console.error(\"error\", errors);\n      }\n    );\n  };\n\n  render() {\n    return (\n      <Root>\n        <Formik\n          initialValues={{\n            email: \"\",\n            password: \"\"\n          }}\n          validate={(values: Values) => {\n            // same as above, but feel free to move this into a class method now.\n            const errors: any = {};\n            if (!values.email) {\n              errors.email = \"Required\";\n            } else if (\n              !/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,4}$/i.test(values.email)\n            ) {\n              errors.email = \"Invalid email address\";\n            }\n            return errors;\n          }}\n          onSubmit={this.onSubmit}\n          render={({\n            values,\n            errors,\n            touched,\n            handleChange,\n            handleBlur,\n            handleSubmit,\n            isSubmitting\n          }: FormikProps<Values>) => (\n            <Form onSubmit={handleSubmit}>\n              <Circle>\n                <Lock />\n              </Circle>\n              <Field>\n                <Label>Email</Label>\n                <Input\n                  type=\"email\"\n                  name=\"email\"\n                  onChange={handleChange}\n                  onBlur={handleBlur}\n                  value={values.email}\n                />\n                {touched.email && errors.email && <Error>{errors.email}</Error>}\n              </Field>\n              <Field>\n                <Label>Password</Label>\n                <Input\n                  type=\"password\"\n                  name=\"password\"\n                  onChange={handleChange}\n                  onBlur={handleBlur}\n                  value={values.password}\n                />\n                {touched.password &&\n                  errors.password && <Error>{errors.password}</Error>}\n              </Field>\n              <Button type=\"submit\" disabled={isSubmitting}>\n                Login\n              </Button>\n            </Form>\n          )}\n        />\n      </Root>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport styled from \"styled-components/macro\";\nimport api from \"./api\";\nimport Icon from \"./common/Icon\";\nimport { Page } from \"./common/page\";\n\nconst Figure = styled(\"figure\")`\n  display: inline-block;\n  margin: 5px;\n  position: relative;\n  & > figcaption {\n    display: none;\n    position: absolute;\n    z-index: 1;\n    padding: 5px;\n    background: #fff;\n    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.2);\n    white-space: nowrap;\n  }\n  :hover {\n    color: var(--primary-color);\n  }\n  :hover > figcaption {\n    display: block;\n  }\n`;\n\ntype State = {\n  icons?: any;\n  filter?: string;\n};\n\nexport default class IconGallery extends Component {\n  state: State = {};\n\n  componentDidMount() {\n    api.get(\"/icons\").then(icons => {\n      icons.forEach(i => {\n        i.search = [i.name, ...i.tags, ...i.aliases].join().toLowerCase();\n      });\n      this.setState({ icons });\n    });\n  }\n\n  filter = ev => {\n    this.setState({ filter: ev.target.value.toLowerCase() });\n  };\n\n  match = icon => {\n    const { filter } = this.state;\n    return !filter || icon.search.includes(filter);\n  };\n\n  render() {\n    const { icons } = this.state;\n    if (!icons) return null;\n    return (\n      <Page>\n        <p>\n          <input type=\"search\" placeholder=\"Search …\" onKeyUp={this.filter} />\n        </p>\n        <div>\n          {icons.filter(this.match).map(i => (\n            <Figure key={i.id}>\n              <Icon path={i.path} />\n              <figcaption>{i.name}</figcaption>\n            </Figure>\n          ))}\n        </div>\n      </Page>\n    );\n  }\n}\n","import styled from \"styled-components/macro\";\n\nconst Header = styled(\"div\")`\n  background: white;\n  color: var(--dark-color);\n  width: 100%;\n  padding: 12px 16px;\n  margin: 0;\n  box-sizing: border-box;\n  font-weight: 500;\n  display: flex;\n  justify-content: space-between;\n  box-shadow: 0px 2px 10px -3px rgba(0, 0, 0, 0.1);\n  margin-bottom: 4px;\n`;\nexport default Header;\n","import styled from \"styled-components/macro\";\n\nconst Item = styled(\"div\")`\n  cursor: pointer;\n  padding: 12px 16px;\n  box-sizing: border-box;\n  border-bottom: 1px solid #f5f5f5;\n  :hover {\n    background-color: var(--light-color);\n  }\n`;\n\nexport default Item;\n","import React from \"react\";\nimport styled from \"styled-components/macro\";\n\nconst Container = styled(\"div\")`\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  width: 100%;\n  text-align: center;\n`;\ntype Props = {\n  text: string;\n};\nexport default function NothingFound({ text }: Props) {\n  return (\n    <Container>\n      <span>{text}</span>\n    </Container>\n  );\n}\n","import React, { useEffect, useState } from \"react\";\nimport Item from \"./Item\";\nimport ScrollList, { RenderInfo } from \"../common/ScrollList\";\nimport ResultItem from \"../common/ResultItem\";\nimport { SearchResultItem } from \"../../../typings\";\nimport NothingFound from \"./NothingFound\";\n\nconst LIMIT = 50;\n\ntype Result = {\n  total: number;\n  items: SearchResultItem[];\n};\n\ntype Props = {\n  fetchItems: (offset: number, limit: number) => Promise<Result>;\n  noResultText?: string;\n};\nexport default function ItemList({ fetchItems, noResultText }: Props) {\n  const [offset, setOffset] = useState(0);\n  const [items, setItems] = useState<null | Result>(null);\n\n  useEffect(() => {\n    let canceled = false;\n    const fetchData = async () => {\n      const fetchedItems = await fetchItems(offset, LIMIT);\n      const { items: i, total: t } = fetchedItems;\n      if (!canceled) {\n        setItems({ total: t, items: items ? items.items.concat(i) : i });\n      }\n    };\n    fetchData();\n\n    return () => {\n      canceled = true;\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [offset]);\n\n  const onRowsRendered = ({ overscanStopIndex }: RenderInfo) => {\n    // Lazy-load next batch of items\n    if (overscanStopIndex >= offset + LIMIT) setOffset(offset + LIMIT);\n  };\n\n  if (!items) return null;\n\n  const { total, items: entries } = items;\n  return total > 0 ? (\n    <ScrollList\n      rowCount={total || 0}\n      items={entries}\n      visibleRows={8}\n      onRowsRendered={onRowsRendered}\n      renderRow={({ key, index, style }) => {\n        const item = entries[index];\n        if (!item) return <div style={style} />;\n        return (\n          <Item style={style}>\n            <ResultItem key={`${key}-${item.id}`} item={item} />\n          </Item>\n        );\n      }}\n    />\n  ) : (\n    <NothingFound text={noResultText || \"\"}></NothingFound>\n  );\n}\n","import React from \"react\";\nimport Header from \"./Header\";\nimport ItemList from \"./ItemList\";\nimport api from \"../api\";\n\nexport default function UnpublishedContent() {\n  return (\n    <>\n      <Header>Unpublished changes</Header>\n      <ItemList\n        fetchItems={(offset, limit) =>\n          api.get(`/dashboard/unpublished?limit=${limit}&offset=${offset}`)\n        }\n        noResultText=\"There are no unpublished changes\"\n      ></ItemList>\n    </>\n  );\n}\n","import React, { useState } from \"react\";\nimport styled from \"styled-components/macro\";\nimport Header from \"./Header\";\nimport api from \"../api\";\nimport ItemList from \"./ItemList\";\nimport ToggleSwitch from \"../common/ToggleSwitch\";\n\nconst Filter = styled(\"div\")`\n  display: inline-flex;\n  justify-content: center;\n  & > span {\n    margin-right: 4px;\n  }\n`;\n\nexport default function UpdatedContent() {\n  const [byUser, setByUser] = useState(false);\n\n  return (\n    <>\n      <Header>\n        <span>Recently updated</span>\n        <Filter>\n          <span>By me</span>\n          <ToggleSwitch on={byUser} onClick={() => setByUser(!byUser)} />\n        </Filter>\n      </Header>\n      <ItemList\n        key={byUser ? 0 : 1}\n        fetchItems={(offset, limit) =>\n          api.get(\n            `/dashboard/${\n              byUser ? \"updated-by-user\" : \"updated\"\n            }?limit=${limit}&offset=${offset}`\n          )\n        }\n        noResultText=\"There is no updated content\"\n      />\n    </>\n  );\n}\n","import React, { useState, useEffect } from \"react\";\nimport styled from \"styled-components/macro\";\nimport UnpublishedContent from \"./UnpublishedContent\";\nimport UpdatedContent from \"./UpdatedContent\";\nimport api from \"../api\";\n\nconst Container = styled(\"div\")`\n  padding: 36px;\n  width: 100%;\n`;\nconst Flex = styled(\"div\")`\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  & > div:not(:last-child) {\n    margin-right: 48px;\n  }\n  @media screen and (max-width: 786px) {\n    flex-direction: column;\n    & > div:not(:last-child) {\n      margin-right: 0;\n      margin-bottom: 48px;\n    }\n  }\n`;\n\nconst Title = styled(\"h1\")`\n  text-align: center;\n  margin-top: 0;\n  margin-bottom: 36px;\n  font-weight: 200;\n`;\nconst Column = styled(\"div\")`\n  flex: 1;\n  background: white;\n  border-radius: 3px;\n  overflow: hidden;\n  max-width: 450px;\n  box-shadow: 0px 2px 10px -3px rgba(0, 0, 0, 0.1);\n  min-height: 515px;\n  position: relative;\n  @media screen and (max-width: 786px) {\n    max-width: 100%;\n  }\n`;\n\nexport default function Dashboard() {\n  const [totalCount, setTotalCount] = useState<null | {\n    totalByUser: number;\n    total: number;\n  }>(null);\n\n  useEffect(() => {\n    let canceled = false;\n    const fetchData = async () => {\n      const [{ total }, { total: totalByUser }] = await Promise.all([\n        api.get(\"/dashboard/updated?limit=0\"),\n        api.get(\"/dashboard/updated-by-user?limit=0\")\n      ]);\n      if (!canceled) setTotalCount({ total, totalByUser });\n    };\n    fetchData();\n\n    return () => {\n      canceled = true;\n    };\n  }, []);\n  return (\n    <Container>\n      {totalCount && (\n        <Title>\n          There are already <b>{totalCount.total.toLocaleString()}</b> items and\n          you worked on <b>{totalCount.totalByUser.toLocaleString()}</b> of\n          them.\n        </Title>\n      )}\n      <Flex>\n        <Column>\n          <UnpublishedContent />\n        </Column>\n        <Column>\n          <UpdatedContent />\n        </Column>\n      </Flex>\n    </Container>\n  );\n}\n","import React, { useState } from \"react\";\nimport { Model, NavigationItem } from \"../../../typings\";\nimport { Redirect, RouteComponentProps } from \"react-router-dom\";\nimport { parse } from \"qs\";\nimport pathMatch from \"path-match\";\nimport basePath from \"../basePath\";\nimport useAsyncEffect from \"use-async-effect\";\nimport api from \"../api\";\nconst createRoute = pathMatch({\n  sensitive: false,\n  strict: false,\n  end: false\n});\n\nexport type Props = RouteComponentProps & {\n  contentModels: Model[];\n  navigation?: NavigationItem[];\n};\n\nconst findPathInNavigation =\n  (model: Model) =>\n  (found: string, navigationItem: NavigationItem): string => {\n    if (found) {\n      return found;\n    }\n    if (\"items\" in navigationItem) {\n      return navigationItem.items.reduce(findPathInNavigation(model), \"\");\n    }\n    if (navigationItem.model === model.name) {\n      return navigationItem.path;\n    }\n    return \"\";\n  };\n\nconst EditURLRedirect: React.FC<Props> = ({\n  contentModels,\n  navigation,\n  ...props\n}) => {\n  const [redirect, setRedirect] = useState<string | false | undefined>(\n    undefined\n  );\n  useAsyncEffect(async () => {\n    const query = props.location.search.replace(\"?\", \"\");\n    const parsed = parse(query) as { q: string };\n    if (parsed.q && navigation) {\n      let foundModels = contentModels.filter(model => {\n        if (model.urlPath && model.urlPath === parsed.q) {\n          return true;\n        }\n        if (model.urlPath && model.urlPath.includes(\":\")) {\n          const matcher = createRoute(model.urlPath);\n          const match = matcher(parsed.q);\n          if (match) {\n            return true;\n          }\n        }\n        return false;\n      });\n      if (foundModels.length > 0) {\n        foundModels = foundModels.sort((a, b) => {\n          if (!a.urlPath) {\n            return 1;\n          }\n          if (!b.urlPath) {\n            return -1;\n          }\n          const deepnesA = (a.urlPath.match(/\\//g) || []).length;\n          const deepnesB = (b.urlPath.match(/\\//g) || []).length;\n          if (deepnesA < deepnesB) return 1;\n          if (deepnesA > deepnesB) return -1;\n          return 0;\n        });\n        let path = navigation.reduce<string>(\n          findPathInNavigation(foundModels[0]),\n          \"\"\n        );\n        if (\n          path &&\n          foundModels[0].urlPath &&\n          foundModels[0].urlPath.includes(\":\")\n        ) {\n          const matcher = createRoute(foundModels[0].urlPath);\n          const match = matcher(parsed.q);\n          const fetchQuery = Object.entries(match).reduce(\n            (acc, [key, value]) => ({ ...acc, [\"data.\" + key]: { eq: value } }),\n            {}\n          );\n          const fetchedId = await api.list(\n            foundModels[0],\n            {\n              offset: 0,\n              limit: 1\n            },\n            fetchQuery\n          );\n          if (fetchedId.items.length > 0) {\n            path = path + \"/edit/\" + fetchedId.items[0].id;\n          }\n        }\n        if (path) {\n          return setRedirect(path);\n        }\n      }\n    }\n    return setRedirect(false);\n  }, [props.location.search]);\n\n  if (redirect === false) {\n    return <>Model not found</>;\n  }\n  if (redirect) {\n    return <Redirect to={basePath + redirect} />;\n  }\n\n  return <>Loading</>;\n};\nexport default EditURLRedirect;\n","import {\n  Model,\n  NavigationItem,\n  User,\n  Principal,\n  Data,\n  ModelPaths,\n  BaseUrls\n} from \"../../typings\";\nimport * as React from \"react\";\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n  Redirect\n} from \"react-router-dom\";\nimport styled from \"styled-components/macro\";\nimport { UploadProvider, createXhrClient } from \"react-use-upload\";\nimport basePath from \"./basePath\";\nimport api from \"./api\";\nimport Header, { HEIGHT } from \"./Header\";\nimport Models from \"./Models\";\nimport ModelPathsContext from \"./ModelPathsContext\";\nimport Media from \"./Media\";\nimport Login from \"./auth/Login\";\nimport UserContext from \"./auth/UserContext\";\nimport IconGallery from \"./IconGallery\";\nimport List from \"./List\";\nimport Dashboard from \"./Dashboard\";\nimport SplitPane from \"./common/SplitPane\";\nimport ErrorBoundary from \"./ErrorBoundary\";\nimport EditURLRedirect from \"./common/EditURLRedirect\";\n\nconst Root = styled(\"div\")`\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n`;\n\nconst Main = styled(\"div\")`\n  position: relative;\n  flex: 1;\n  display: flex;\n  max-height: calc(100vh - ${HEIGHT});\n`;\n\ntype State = {\n  models?: {\n    settings: Model[];\n    content: Model[];\n    media: Model[];\n  };\n  user?: User & Principal;\n  navigation?: NavigationItem[];\n  modelPaths?: ModelPaths;\n  baseUrls?: BaseUrls;\n};\nclass App extends React.Component<{}, State> {\n  state: State = {};\n\n  fetchInfo = () => {\n    api\n      .get(\"/info\")\n      .then(info => this.setState(info))\n      .catch(err => {\n        this.setState({ user: undefined });\n      });\n  };\n\n  componentDidMount() {\n    this.fetchInfo();\n  }\n\n  settingsChanged = (model: Model, id: string, data: Data) => {\n    if (model.name === \"User\") {\n      this.fetchInfo();\n    }\n  };\n\n  render() {\n    const {\n      models,\n      user,\n      navigation = [],\n      modelPaths = null,\n      baseUrls = null\n    } = this.state;\n\n    if (!user) {\n      return <Login onSuccess={this.fetchInfo} />;\n    }\n    if (!models) return null;\n\n    return (\n      <ErrorBoundary>\n        <UploadProvider client={createXhrClient({ baseUrl: api.baseURI })}>\n          <UserContext.Provider value={user}>\n            <ModelPathsContext.Provider value={{ modelPaths, baseUrls }}>\n              <Router>\n                <Root>\n                  <Header navigation={navigation} />\n                  <ErrorBoundary>\n                    <Main>\n                      <Switch>\n                        <Route\n                          path={`${basePath}/dashboard`}\n                          render={props => <Dashboard />}\n                        />\n                        {navigation.map(item => (\n                          <Route\n                            key={item.path}\n                            path={`${basePath}${item.path}`}\n                            render={routeProps => {\n                              switch (item.type) {\n                                case \"model\":\n                                  return (\n                                    <SplitPane>\n                                      <List\n                                        {...routeProps}\n                                        model={\n                                          models.content.find(\n                                            ({ name }) => name === item.model\n                                          ) as Model\n                                        }\n                                      />\n                                    </SplitPane>\n                                  );\n                                default:\n                                  return (\n                                    <Models\n                                      {...routeProps}\n                                      models={models.content}\n                                      navigation={item.items}\n                                    />\n                                  );\n                              }\n                            }}\n                          />\n                        ))}\n                        <Route\n                          path={`${basePath}/media`}\n                          render={props => (\n                            <Media {...props} model={models.media} />\n                          )}\n                        />\n                        <Route\n                          path={`${basePath}/settings`}\n                          render={props => (\n                            <Models\n                              {...props}\n                              models={models.settings}\n                              navigation={models.settings.map(\n                                ({ name, plural }) =>\n                                  ({\n                                    type: \"model\",\n                                    model: name,\n                                    path: `/settings/${name}`,\n                                    name: plural\n                                  } as NavigationItem)\n                              )}\n                              onChange={this.settingsChanged}\n                            />\n                          )}\n                        />\n                        <Route\n                          path={`${basePath}/icons`}\n                          component={IconGallery}\n                        />\n                        <Route\n                          path={`${basePath}/editURL`}\n                          render={(props) => (\n                            <EditURLRedirect\n                              {...props}\n                              contentModels={models.content}\n                              navigation={navigation}\n                            />\n                          )}\n                        />\n                        <Route exact path={basePath}>\n                          <Redirect to={`${basePath}/dashboard`} />\n                        </Route>\n                      </Switch>\n                    </Main>\n                  </ErrorBoundary>\n                </Root>\n              </Router>\n            </ModelPathsContext.Provider>\n          </UserContext.Provider>\n        </UploadProvider>\n      </ErrorBoundary>\n    );\n  }\n}\n\nexport default App;\n","import 'react-app-polyfill/ie11';\nimport * as React from \"react\";\nimport * as ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport JavascriptTimeAgo from \"javascript-time-ago\";\nimport en from \"javascript-time-ago/locale/en\";\n\nJavascriptTimeAgo.locale(en);\nReactDOM.render(<App />, document.getElementById(\"root\") as HTMLElement);\n"],"sourceRoot":""}